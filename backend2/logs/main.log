2025-08-02 11:15:31 - 2fa_service - WARNING - Generated new TOTP encryption key: tOt3uoWcrvYUlAtmWmqVj8lea90KSH4dmijZAl67z7E=
2025-08-02 11:15:31 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-02 11:17:59 - 2fa_service - ERROR - Error in atomic_increment_failed_attempts for user 9ca14dcd-a5dc-4435-ad66-6158417edde1: Textual SQL expression '\n                UPDATE u...' should be explicitly declared as text('\n                UPDATE u...')
2025-08-02 11:17:59 - 2fa_service - ERROR - Error in atomic_increment_failed_attempts for user 9ca14dcd-a5dc-4435-ad66-6158417edde1: Textual SQL expression '\n                UPDATE u...' should be explicitly declared as text('\n                UPDATE u...')
2025-08-02 11:17:59 - 2fa_service - ERROR - Error in atomic_increment_failed_attempts for user 9ca14dcd-a5dc-4435-ad66-6158417edde1: Textual SQL expression '\n                UPDATE u...' should be explicitly declared as text('\n                UPDATE u...')
2025-08-02 11:17:59 - 2fa_service - ERROR - Error in atomic_increment_failed_attempts for user 9ca14dcd-a5dc-4435-ad66-6158417edde1: Textual SQL expression '\n                UPDATE u...' should be explicitly declared as text('\n                UPDATE u...')
2025-08-02 11:17:59 - 2fa_service - ERROR - Error in atomic_increment_failed_attempts for user 9ca14dcd-a5dc-4435-ad66-6158417edde1: Textual SQL expression '\n                UPDATE u...' should be explicitly declared as text('\n                UPDATE u...')
2025-08-02 11:19:53 - 2fa_service - INFO - Backup code used for user 513e728e-48ea-4b80-a5f9-355b05e0cdbd. Remaining codes: 1
2025-08-02 11:19:53 - 2fa_service - WARNING - Backup code not found or already used for user 513e728e-48ea-4b80-a5f9-355b05e0cdbd
2025-08-02 11:19:53 - 2fa_service - WARNING - Backup code not found or already used for user 513e728e-48ea-4b80-a5f9-355b05e0cdbd
2025-08-02 11:29:56 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:29:59 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:30:36 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:30:36 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:30:36 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:30:36 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVVuvqkwS_StffD7uDY2onGSScasIKiBy58VA00AjN7nDl_Pfv2afaybzMA_zYmJV91q1VhVdfy8eJaoyL0d5s_jaVC36smhrVC2-_r3wIER1_WiKJ8oXXxejB7g3j9ppjLCWp0opT0O7lF4pDAGAD--2nwpOV-XJsyUm9CAnxaNPs8-JiRXuYeWM2EXMeo_Si8ZSYbUbDsyIbxLnhnJt8nvhnOyX7Yme2MMkfPi3dSLjixQBSV4LhaAJN0lZC95FUamAS7Z4c7vx2GF0nmFHMW-vossmt1HUmFccWlrsWpdV7-0j57KDkba7ixqvCicbSLgIRnxavRRhCeP2QplRqVheT9GbzeLLAg0lrlD98IgX9IZd0WBDMfTvOCY-MCy3_bLAwS9f0HiO_RPECj5rxiTSMhZrMWtKdy-uxez-lHWpl3Sxl09uIlkqcPSPp5zEiTxFk6NLtAMk1pmOvZOItKvzmXw64uv-TCF7N2NeTFrFofpGaErISHOoCIR7D6eiuwI-cQBH-_l9umZB54OgdjU28QE1Q8QonyHEQToYk6JHvZQcJ_kgra72jvJyF8iHoJJA0DiMmbhziRlFe7azckBMSaegh1ZMXzO-h4LUuoDrXDCkgS2nMJM7wpn6udoS_kbEPXZs8ykmBZb0HS1Nz5V0ILyTOil7mkgvQZCojDfJuW_JRLIxSge3ka0UKCe5CA4fORT4ItDYGAofv7XY5uTaZ6KHpVyLpa4zr0bszQkGJvYmR8Jx7OUkomXdYRX9OSgHkSV6aWk_t8FsHCut57qIptTPXFI7PwZ6vHMBHXtW_6t-15r_D2GQmaNnuaVrqVjJ72NgGQSHp2wQxxBEs_-qcmRVZIrU1U4FA8AeWaYIATdoiczMWH7GEVxj9n50Jrcg2LxucMTje-0KxXi3Sun-OSZs7FvzuXPincxWPP2o71PjR-kwdxpmxn_0fCikkc19wOX-yaQhMEeioQ3I_WD_2fvO0bgPFcCVD2TJsbhKZ2TXpAZNw_RLTc68Y7A3DXBH68gnemY0pnlOfUMc4Ik-mpRbSxlPPq1UR88jB6cnuFrSPE-5Z7upnxJtFp3-8vRTh0t0pDUyf-dc4qNjn-nZD8_iKRIb5MmgyKcwz-BI8FIkkPlMjoysq4OUwF6aztxbE9xUd83vBzdPPdjKUdtiahjtyS7j_YN11rXlXmVh-YjMcxyPjFI-bpK45SOuMJ4GTKrJLKYQD0mljmPMifdjB-_-WignOmdZXAhKF0Kflsxu86CLm4Bymal1kHmcbBye3cPxQ-2pylm7t5nucSs2V7WBNmPtwnxr7Wpj3-eirEWrh6e8tk3jbKhWR87wpKK60ht9u-oyJSxPR-10kKnrZS3vkAFfE2udnucqPcjJDm-Allw9A9xrf0j2OkSX7FUVXWfXp2G4WDFWrmgjt49ab5J7057vH4n5ctUzqPfM_WArOWCeLag0rKz73St0njGTpOpR4qfD6Ui1e8N3lRcsi-5cZa91Jrd4R163GhYlIg8W-c1x8FfcNGX99f297_u3qCiiFHklrt9gkb17bRO_z2sA52HxVlZFiFP0v19AmYdTQvj5Qj6a8ZP1A3kV2Svf18t87HPFNI_Yq2OSvm3l23hfLceTFlEjEuridWZ6ctxrA5KmKZbhthSgmRWzXZarpOtWmycTZbCFCFDrjMXdFsYNFZWvuH3zyrL-UeNMB4u8IQtuLnVGnMr_M-J3wV8XkLy4Iaq8qt3-O5pjf-YfHdEdYhT83LNkq_yxZsCXRehlOB0fuZfNhn0HIrcj3BEbf0RnChLDv1cUqZ_cxXVNsj9bRFZ30ebNz4p_lPEHxF-_0PMih3MUwHWMsqOkQLRKgwkckytP0iWGTVuhP7DTmPnvRrx777t9tC3g1SueSu1Y1_t5mXyAoycrl-Jg76CMlsYdZR90mR0sPgVef3W0afevmlsv4TyhrT93hmZoar1l2TXHcfQWcBTLUotv376PzgPP88Cs1wEVcqslhUJ_udogaulxaLVEm40P1yzLIIZbfPsHaBj6YA.aI3MrA.wZ11sfIz193AoiBG6Zv0eEbXb4s'}
2025-08-02 11:30:36 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:30:36 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:30:36 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x064FF1B0>
2025-08-02 11:30:36 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:36 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:36 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:30:36 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:36 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:30:36 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:30:36 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:30:36 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:30:36 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:30:36 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:30:36 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:30:36 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:30:36 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:30:36 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:30:36 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:30:36 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:30:36 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:36 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:30:36 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:30:36 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:30:36 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:30:37 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:37 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:30:37 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Request completed in 0.17s with status 200
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 6.437301635742188e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:30:36.629181'}, 'success': True}
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 6.29425048828125e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:30:36.750331'}, 'success': True}
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:30:37 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-02 11:30:37 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012638568878173828,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:30:36.898491"
  },
  "success": false
}

2025-08-02 11:30:37 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012638568878173828,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:30:36.898491"
  },
  "success": false
}

2025-08-02 11:30:37 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012638568878173828,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:30:36.898491"
  },
  "success": false
}

2025-08-02 11:30:37 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:30:37 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:30:38 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:38 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:30:38 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:30:38 - managers.commands_server - DEBUG - Request completed in 1.75s with status 500
2025-08-02 11:30:38 - managers.commands_server - ERROR - Commands server returned 500: {
  "data": null,
  "error": {
    "code": "INFRASTRUCTURE_SETUP_FAILED",
    "details": null,
    "message": "Infrastructure setup failed: Infrastructure setup failed: 'NoneType' object has no attribute 'strip'"
  },
  "metadata": {
    "executionTime": 1.5657103061676025,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:30:38.382225"
  },
  "success": false
}

2025-08-02 11:30:38 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 500: {
  "data": null,
  "error": {
    "code": "INFRASTRUCTURE_SETUP_FAILED",
    "details": null,
    "message": "Infrastructure setup failed: Infrastructure setup failed: 'NoneType' object has no attribute 'strip'"
  },
  "metadata": {
    "executionTime": 1.5657103061676025,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:30:38.382225"
  },
  "success": false
}

2025-08-02 11:30:38 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 500: {
  "data": null,
  "error": {
    "code": "INFRASTRUCTURE_SETUP_FAILED",
    "details": null,
    "message": "Infrastructure setup failed: Infrastructure setup failed: 'NoneType' object has no attribute 'strip'"
  },
  "metadata": {
    "executionTime": 1.5657103061676025,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:30:38.382225"
  },
  "success": false
}

2025-08-02 11:30:38 - services.commands_server_operations.session_execute - ERROR - Session start failed for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: Commands server returned 500: {
  "data": null,
  "error": {
    "code": "INFRASTRUCTURE_SETUP_FAILED",
    "details": null,
    "message": "Infrastructure setup failed: Infrastructure setup failed: 'NoneType' object has no attribute 'strip'"
  },
  "metadata": {
    "executionTime": 1.5657103061676025,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:30:38.382225"
  },
  "success": false
}

2025-08-02 11:30:38 - services.base - ERROR - Service operation failed: start_session - Commands server returned 500: {
  "data": null,
  "error": {
    "code": "INFRASTRUCTURE_SETUP_FAILED",
    "details": null,
    "message": "Infrastructure setup failed: Infrastructure setup failed: 'NoneType' object has no attribute 'strip'"
  },
  "metadata": {
    "executionTime": 1.5657103061676025,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:30:38.382225"
  },
  "success": false
}

2025-08-02 11:30:39 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:30:39 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:30:39 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:30:39 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVVuvqkwS_StffD7uDY2onGSScasIKiBy58VA00AjN7nDl_Pfv2afaybzMA_zYmJV91q1VhVdfy8eJaoyL0d5s_jaVC36smhrVC2-_r3wIER1_WiKJ8oXXxejB7g3j9ppjLCWp0opT0O7lF4pDAGAD--2nwpOV-XJsyUm9CAnxaNPs8-JiRXuYeWM2EXMeo_Si8ZSYbUbDsyIbxLnhnJt8nvhnOyX7Yme2MMkfPi3dSLjixQBSV4LhaAJN0lZC95FUamAS7Z4c7vx2GF0nmFHMW-vossmt1HUmFccWlrsWpdV7-0j57KDkba7ixqvCicbSLgIRnxavRRhCeP2QplRqVheT9GbzeLLAg0lrlD98IgX9IZd0WBDMfTvOCY-MCy3_bLAwS9f0HiO_RPECj5rxiTSMhZrMWtKdy-uxez-lHWpl3Sxl09uIlkqcPSPp5zEiTxFk6NLtAMk1pmOvZOItKvzmXw64uv-TCF7N2NeTFrFofpGaErISHOoCIR7D6eiuwI-cQBH-_l9umZB54OgdjU28QE1Q8QonyHEQToYk6JHvZQcJ_kgra72jvJyF8iHoJJA0DiMmbhziRlFe7azckBMSaegh1ZMXzO-h4LUuoDrXDCkgS2nMJM7wpn6udoS_kbEPXZs8ykmBZb0HS1Nz5V0ILyTOil7mkgvQZCojDfJuW_JRLIxSge3ka0UKCe5CA4fORT4ItDYGAofv7XY5uTaZ6KHpVyLpa4zr0bszQkGJvYmR8Jx7OUkomXdYRX9OSgHkSV6aWk_t8FsHCut57qIptTPXFI7PwZ6vHMBHXtW_6t-15r_D2GQmaNnuaVrqVjJ72NgGQSHp2wQxxBEs_-qcmRVZIrU1U4FA8AeWaYIATdoiczMWH7GEVxj9n50Jrcg2LxucMTje-0KxXi3Sun-OSZs7FvzuXPincxWPP2o71PjR-kwdxpmxn_0fCikkc19wOX-yaQhMEeioQ3I_WD_2fvO0bgPFcCVD2TJsbhKZ2TXpAZNw_RLTc68Y7A3DXBH68gnemY0pnlOfUMc4Ik-mpRbSxlPPq1UR88jB6cnuFrSPE-5Z7upnxJtFp3-8vRTh0t0pDUyf-dc4qNjn-nZD8_iKRIb5MmgyKcwz-BI8FIkkPlMjoysq4OUwF6aztxbE9xUd83vBzdPPdjKUdtiahjtyS7j_YN11rXlXmVh-YjMcxyPjFI-bpK45SOuMJ4GTKrJLKYQD0mljmPMifdjB-_-WignOmdZXAhKF0Kflsxu86CLm4Bymal1kHmcbBye3cPxQ-2pylm7t5nucSs2V7WBNmPtwnxr7Wpj3-eirEWrh6e8tk3jbKhWR87wpKK60ht9u-oyJSxPR-10kKnrZS3vkAFfE2udnucqPcjJDm-Allw9A9xrf0j2OkSX7FUVXWfXp2G4WDFWrmgjt49ab5J7057vH4n5ctUzqPfM_WArOWCeLag0rKz73St0njGTpOpR4qfD6Ui1e8N3lRcsi-5cZa91Jrd4R163GhYlIg8W-c1x8FfcNGX99f297_u3qCiiFHklrt9gkb17bRO_z2sA52HxVlZFiFP0v19AmYdTQvj5Qj6a8ZP1A3kV2Svf18t87HPFNI_Yq2OSvm3l23hfLceTFlEjEuridWZ6ctxrA5KmKZbhthSgmRWzXZarpOtWmycTZbCFCFDrjMXdFsYNFZWvuH3zyrL-UeNMB4u8IQtuLnVGnMr_M-J3wV8XkLy4Iaq8qt3-O5pjf-YfHdEdYhT83LNkq_yxZsCXRehlOB0fuZfNhn0HIrcj3BEbf0RnChLDv1cUqZ_cxXVNsj9bRFZ30ebNz4p_lPEHxF-_0PMih3MUwHWMsqOkQLRKgwkckytP0iWGTVuhP7DTmPnvRrx777t9tC3g1SueSu1Y1_t5mXyAoycrl-Jg76CMlsYdZR90mR0sPgVef3W0afevmlsv4TyhrT93hmZoar1l2TXHcfQWcBTLUotv376PzgPP88Cs1wEVcqslhUJ_udogaulxaLVEm40P1yzLIIZbfPsHaBj6YA.aI3Mrg.OAWv7fgIkmtcE8v3YhiAs1X2rMo'}
2025-08-02 11:30:39 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:30:39 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:30:39 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x0650AE40>
2025-08-02 11:30:39 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:39 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:39 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:30:39 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:30:39 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:30:39 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:30:39 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:30:39 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:30:39 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:30:39 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:30:39 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:30:39 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:30:39 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:30:39 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:30:39 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:30:39 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:30:40 - managers.commands_server - DEBUG - Request completed in 2.01s with status 200
2025-08-02 11:30:40 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'Unknown', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.870469570159912, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:30:39.770036'}, 'success': True}
2025-08-02 11:30:40 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:30:40 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:30:40 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:30:40 - services.db_operations.network_db - DEBUG - Created new device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:30:40 - services.db_operations.network_db - DEBUG - Created new device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:30:40 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 2, updated 0 devices
2025-08-02 11:30:40 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:33:40 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:33:48 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:33:57 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:34:13 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:34:30 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:35:19 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:35:19 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:35:19 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:35:19 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmyqsoS_ZUbjo97U4WA7IgbcRVBURqRnokBBdJIp3TCifPvt9injRdv8AZvYgSZVSvXWplWfl1c6-hZ-GVUtouP9tlFXxZdEz0XH18XPkJR01zb6h6Vi4_F6EP2zSc2OnmglUnsAOqW4AbXbud2SqYlFSnA66YK0Dk_EKToSF6R8JbGXMsiJurOGfjKJtcuMbYOUDOljccrzal5mIymS_SHFTlsxYs2PnJDLNahovKevzfNUHnp69dL3PunlpE0bqLua5IWJDOfuJUGhXUuX1h2-wgjV10WMZcz9LI80PQ9iX0udk8bZ6NvLqIuaIe9A-U0K5-S-lQYsytu1ySnUomjTzEBGGbxZRG96vQZNVcfewEYagUgQ4LV73iKfSApdv1lkYa_fInGYxLsUaqmR92cRKCkYiMWbe1xIi0Wl7tiyINsiIOy9zLZ1qBrbO9KlmTKFE-uIQMXypQ78YObicAzhELZ85jUkYiczYx5soCW3rQ3XKZGpDyHqvBwGdBU9RIUMheyICgvk1SEfQDDxtOpLIDEDJFE5QwhvuSdOalGPMgZPyk7eSU5G8IvPajswqcMw9YlrcybKRYE8B135cKEkPfhgOwESIUwoIPceZDtPfjKQ0fJUaH0uGYelFqH67diOqSuY93FrEplYwPk6b6Sd7jupE0qB7D0GoaZRvqTUga2giWbo7zzWsXOobpXqnC3LdFBqEKdStBh-1uLY02ec8R6KMKzKUKa6-rY3hJjpNjejMc1-EHJYqAYLqUa95e6EymsF8jc3Aarde28mXlhTXlQeJi7MIZGsvEgSHx7-MXfs-fv1y0srNG3vdqztVQtL2NomxhHIByYJAjGs_8mmizOJJP8IghPyxBE-aC0Ns9Txj2_zFhBwWJccz57tB2eUsoLFQh5GvCX08VuppDMU3_WUVBJYH-ey_y91Yn7H_w-NW5rl7wAVJj_0fNXJY9UGUC2DPYWQNAasYYuxPdD7rP3vauzWw2iVQAV2bXZp0EqnkW8dD0FDy07Cq5JnXXI8jYvZEZhtpZ1zANTfKE94C3Ca-RCIA0hN6I7z6LpDiVbnuep9B0vD3KszQb5L08_x93DOvImsn7nPOyj6xzB7IdvCwSOvZTJJPBfYVImHmC8PDrg-cx4UjG0l5yhSTYs9q0-kssHqWoemaibSuzqrDOFB9Oc7hTQG6E5H0MoMU2i7wbQG9KyF_hy1563IQCedCnO6VbmUqXwLJRlS1agKIMOdvzO2YfK7aGfPZHUWS0SLcM2fM8gOckPTI5q-q5gYNooVhGp_FRjpbeWkRnjcNJ6ehxPnr6KXmGp1-UUc8ZJSeCwUWvSF8w7UEnplK_Pyv1ZHh7wee01niPE7erZoevmBdZjYHDG2eoEv2FfftOfJ4uQ6IC7nMeIo7y0Cmj0ODJqyjmGnEAacdNgnrMT2Czd9fmgkufQ4aZTbzyt-LhMz_KqRyeiR05hg7VwZoO45JePZukg4tgcdGaVk7oYZqunn-0kqGbrQsOvW4OqOsIPFv4t0_CvpG3r5uP9fRiGt7iq4jzy67R5Q1Xx7ndt8j6vgbS8VW_1s7qlefS_X4gKP81xwc8X8tqOn1W3kf_Ee-X7epmPfa6Y9pr4TYLTRkNt9Ve00-4mOBBN4WxYRZxZ-12I04CgSHZNQECuyPWyXmV9v2LuZFygDkWQoAsq7dcoaYm4fiTdm1_XzQ-OczlUlS1ecDPVGXGq_8-I3wV_LBB-cW_R039263_iOfZn_tpj3bc0Cn_uWbxV_lgz1JfFzS_SfLyWfjEb9h0I347THtv4IzqXwLH094oimflu2jQ4-7NFeHVXXdn-ZPyDxh8Qf_1CL6sSzVHRfbB0O-ZukO-O_J0cxiDF6TpFbfeM_sDOE_K_G_Huv2-4eF0hya_uauPa0uW4zLaQ9xX1VO2cDVKipXmJii2oi50t5NAfJFefNn83LL1E84R2wdwZQAKCXlMUzbIsWEOWoChi8e3b99G5pvM8kDQdEjd2tSSiW7BcMRGx9NlotYwYJkA0RZERyS6-_QuSs_Oq.aI3Nxg.zghdZQFovPKJN2-SzObNq_TjTq4'}
2025-08-02 11:35:19 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:35:19 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:35:19 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x060EDB40>
2025-08-02 11:35:19 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:35:19 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:35:19 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:35:19 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:35:19 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:35:19 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:35:19 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:35:19 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:35:19 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:35:19 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:35:19 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:35:19 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:35:19 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:35:19 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:35:19 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:35:19 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:35:20 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:35:20 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:35:20 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:35:20 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:35:20 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:35:20 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 6.723403930664062e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:35:19.714950'}, 'success': True}
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Request completed in 0.15s with status 200
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.314018249511719e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:35:19.763037'}, 'success': True}
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:35:20 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.001108407974243164,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:35:19.864167"
  },
  "success": false
}

2025-08-02 11:35:20 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.001108407974243164,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:35:19.864167"
  },
  "success": false
}

2025-08-02 11:35:20 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.001108407974243164,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:35:19.864167"
  },
  "success": false
}

2025-08-02 11:35:20 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:35:20 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:35:20 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:35:20 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010890960693359375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:35:19.916557"
  },
  "success": false
}

2025-08-02 11:35:20 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010890960693359375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:35:19.916557"
  },
  "success": false
}

2025-08-02 11:35:20 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010890960693359375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:35:19.916557"
  },
  "success": false
}

2025-08-02 11:35:20 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:35:20 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:35:21 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:35:21 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:35:21 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:35:23 - managers.commands_server - DEBUG - Request completed in 1.92s with status 200
2025-08-02 11:35:23 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'Unknown', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7693257331848145, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:35:22.640040'}, 'success': True}
2025-08-02 11:35:23 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:35:23 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:35:23 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:35:23 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:35:23 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:35:23 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:35:23 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:35:29 - twofa_endpoints - INFO - 2FA setup started for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:39:22 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:39:40 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:40:50 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:40:50 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:40:50 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:40:50 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmyqsoS_ZUbjo97U4WA7IgbcRVBURqRnokBBdJIp3TCifPvt9injRdv8AZvYgSZVSvXWplWfl1c6-hZ-GVUtouP9tlFXxZdEz0XH18XPkJR01zb6h6Vi4_F6EP2zSc2OnmglUnsAOqW4AbXbud2SqYlFSnA66YK0Dk_EKToSF6R8JbGXMsiJurOGfjKJtcuMbYOUDOljccrzal5mIymS_SHFTlsxYs2PnJDLNahovKevzfNUHnp69dL3PunlpE0bqLua5IWJDOfuJUGhXUuX1h2-wgjV10WMZcz9LI80PQ9iX0udk8bZ6NvLqIuaIe9A-U0K5-S-lQYsytu1ySnUomjTzEBGGbxZRG96vQZNVcfewEYagUgQ4LV73iKfSApdv1lkYa_fInGYxLsUaqmR92cRKCkYiMWbe1xIi0Wl7tiyINsiIOy9zLZ1qBrbO9KlmTKFE-uIQMXypQ78YObicAzhELZ85jUkYiczYx5soCW3rQ3XKZGpDyHqvBwGdBU9RIUMheyICgvk1SEfQDDxtOpLIDEDJFE5QwhvuSdOalGPMgZPyk7eSU5G8IvPajswqcMw9YlrcybKRYE8B135cKEkPfhgOwESIUwoIPceZDtPfjKQ0fJUaH0uGYelFqH67diOqSuY93FrEplYwPk6b6Sd7jupE0qB7D0GoaZRvqTUga2giWbo7zzWsXOobpXqnC3LdFBqEKdStBh-1uLY02ec8R6KMKzKUKa6-rY3hJjpNjejMc1-EHJYqAYLqUa95e6EymsF8jc3Aarde28mXlhTXlQeJi7MIZGsvEgSHx7-MXfs-fv1y0srNG3vdqztVQtL2NomxhHIByYJAjGs_8mmizOJJP8IghPyxBE-aC0Ns9Txj2_zFhBwWJccz57tB2eUsoLFQh5GvCX08VuppDMU3_WUVBJYH-ey_y91Yn7H_w-NW5rl7wAVJj_0fNXJY9UGUC2DPYWQNAasYYuxPdD7rP3vauzWw2iVQAV2bXZp0EqnkW8dD0FDy07Cq5JnXXI8jYvZEZhtpZ1zANTfKE94C3Ca-RCIA0hN6I7z6LpDiVbnuep9B0vD3KszQb5L08_x93DOvImsn7nPOyj6xzB7IdvCwSOvZTJJPBfYVImHmC8PDrg-cx4UjG0l5yhSTYs9q0-kssHqWoemaibSuzqrDOFB9Oc7hTQG6E5H0MoMU2i7wbQG9KyF_hy1563IQCedCnO6VbmUqXwLJRlS1agKIMOdvzO2YfK7aGfPZHUWS0SLcM2fM8gOckPTI5q-q5gYNooVhGp_FRjpbeWkRnjcNJ6ehxPnr6KXmGp1-UUc8ZJSeCwUWvSF8w7UEnplK_Pyv1ZHh7wee01niPE7erZoevmBdZjYHDG2eoEv2FfftOfJ4uQ6IC7nMeIo7y0Cmj0ODJqyjmGnEAacdNgnrMT2Czd9fmgkufQ4aZTbzyt-LhMz_KqRyeiR05hg7VwZoO45JePZukg4tgcdGaVk7oYZqunn-0kqGbrQsOvW4OqOsIPFv4t0_CvpG3r5uP9fRiGt7iq4jzy67R5Q1Xx7ndt8j6vgbS8VW_1s7qlefS_X4gKP81xwc8X8tqOn1W3kf_Ee-X7epmPfa6Y9pr4TYLTRkNt9Ve00-4mOBBN4WxYRZxZ-12I04CgSHZNQECuyPWyXmV9v2LuZFygDkWQoAsq7dcoaYm4fiTdm1_XzQ-OczlUlS1ecDPVGXGq_8-I3wV_LBB-cW_R039263_iOfZn_tpj3bc0Cn_uWbxV_lgz1JfFzS_SfLyWfjEb9h0I347THtv4IzqXwLH094oimflu2jQ4-7NFeHVXXdn-ZPyDxh8Qf_1CL6sSzVHRfbB0O-ZukO-O_J0cxiDF6TpFbfeM_sDOE_K_G_Huv2-4eF0hya_uauPa0uW4zLaQ9xX1VO2cDVKipXmJii2oi50t5NAfJFefNn83LL1E84R2wdwZQAKCXlMUzbIsWEOWoChi8e3b99G5pvM8kDQdEjd2tSSiW7BcMRGx9NlotYwYJkA0RZERyS6-_QuSs_Oq.aI3PEg.37m6lr1sJwKXXLMIbwMh0oGb_Ww'}
2025-08-02 11:40:50 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:40:50 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:40:50 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x015CE8D0>
2025-08-02 11:40:50 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:40:50 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:40:50 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:40:50 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:40:50 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:40:50 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:40:50 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:40:50 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:40:50 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:40:50 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:40:50 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:40:50 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:40:50 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:40:50 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:40:50 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:40:50 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:40:50 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:40:50 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:40:50 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:40:50 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmyqsoS_ZUbjo97U4WA7IgbcRVBURqRnokBBdJIp3TCifPvt9injRdv8AZvYgSZVSvXWplWfl1c6-hZ-GVUtouP9tlFXxZdEz0XH18XPkJR01zb6h6Vi4_F6EP2zSc2OnmglUnsAOqW4AbXbud2SqYlFSnA66YK0Dk_EKToSF6R8JbGXMsiJurOGfjKJtcuMbYOUDOljccrzal5mIymS_SHFTlsxYs2PnJDLNahovKevzfNUHnp69dL3PunlpE0bqLua5IWJDOfuJUGhXUuX1h2-wgjV10WMZcz9LI80PQ9iX0udk8bZ6NvLqIuaIe9A-U0K5-S-lQYsytu1ySnUomjTzEBGGbxZRG96vQZNVcfewEYagUgQ4LV73iKfSApdv1lkYa_fInGYxLsUaqmR92cRKCkYiMWbe1xIi0Wl7tiyINsiIOy9zLZ1qBrbO9KlmTKFE-uIQMXypQ78YObicAzhELZ85jUkYiczYx5soCW3rQ3XKZGpDyHqvBwGdBU9RIUMheyICgvk1SEfQDDxtOpLIDEDJFE5QwhvuSdOalGPMgZPyk7eSU5G8IvPajswqcMw9YlrcybKRYE8B135cKEkPfhgOwESIUwoIPceZDtPfjKQ0fJUaH0uGYelFqH67diOqSuY93FrEplYwPk6b6Sd7jupE0qB7D0GoaZRvqTUga2giWbo7zzWsXOobpXqnC3LdFBqEKdStBh-1uLY02ec8R6KMKzKUKa6-rY3hJjpNjejMc1-EHJYqAYLqUa95e6EymsF8jc3Aarde28mXlhTXlQeJi7MIZGsvEgSHx7-MXfs-fv1y0srNG3vdqztVQtL2NomxhHIByYJAjGs_8mmizOJJP8IghPyxBE-aC0Ns9Txj2_zFhBwWJccz57tB2eUsoLFQh5GvCX08VuppDMU3_WUVBJYH-ey_y91Yn7H_w-NW5rl7wAVJj_0fNXJY9UGUC2DPYWQNAasYYuxPdD7rP3vauzWw2iVQAV2bXZp0EqnkW8dD0FDy07Cq5JnXXI8jYvZEZhtpZ1zANTfKE94C3Ca-RCIA0hN6I7z6LpDiVbnuep9B0vD3KszQb5L08_x93DOvImsn7nPOyj6xzB7IdvCwSOvZTJJPBfYVImHmC8PDrg-cx4UjG0l5yhSTYs9q0-kssHqWoemaibSuzqrDOFB9Oc7hTQG6E5H0MoMU2i7wbQG9KyF_hy1563IQCedCnO6VbmUqXwLJRlS1agKIMOdvzO2YfK7aGfPZHUWS0SLcM2fM8gOckPTI5q-q5gYNooVhGp_FRjpbeWkRnjcNJ6ehxPnr6KXmGp1-UUc8ZJSeCwUWvSF8w7UEnplK_Pyv1ZHh7wee01niPE7erZoevmBdZjYHDG2eoEv2FfftOfJ4uQ6IC7nMeIo7y0Cmj0ODJqyjmGnEAacdNgnrMT2Czd9fmgkufQ4aZTbzyt-LhMz_KqRyeiR05hg7VwZoO45JePZukg4tgcdGaVk7oYZqunn-0kqGbrQsOvW4OqOsIPFv4t0_CvpG3r5uP9fRiGt7iq4jzy67R5Q1Xx7ndt8j6vgbS8VW_1s7qlefS_X4gKP81xwc8X8tqOn1W3kf_Ee-X7epmPfa6Y9pr4TYLTRkNt9Ve00-4mOBBN4WxYRZxZ-12I04CgSHZNQECuyPWyXmV9v2LuZFygDkWQoAsq7dcoaYm4fiTdm1_XzQ-OczlUlS1ecDPVGXGq_8-I3wV_LBB-cW_R039263_iOfZn_tpj3bc0Cn_uWbxV_lgz1JfFzS_SfLyWfjEb9h0I347THtv4IzqXwLH094oimflu2jQ4-7NFeHVXXdn-ZPyDxh8Qf_1CL6sSzVHRfbB0O-ZukO-O_J0cxiDF6TpFbfeM_sDOE_K_G_Huv2-4eF0hya_uauPa0uW4zLaQ9xX1VO2cDVKipXmJii2oi50t5NAfJFefNn83LL1E84R2wdwZQAKCXlMUzbIsWEOWoChi8e3b99G5pvM8kDQdEjd2tSSiW7BcMRGx9NlotYwYJkA0RZERyS6-_QuSs_Oq.aI3PEg.37m6lr1sJwKXXLMIbwMh0oGb_Ww'}
2025-08-02 11:40:50 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:40:50 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:40:50 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x015CEA50>
2025-08-02 11:40:50 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:40:50 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:40:50 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:40:50 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:40:50 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:40:50 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:40:50 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:40:51 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:40:51 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:40:51 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:40:51 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:40:51 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:40:51 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:40:51 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:40:51 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:40:51 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:40:51 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:40:51 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:40:51 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:40:51 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:40:51 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:40:51 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-02 11:40:51 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.9087066650390625e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:40:51.000844'}, 'success': True}
2025-08-02 11:40:51 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:40:51 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:40:51 - managers.commands_server - DEBUG - Request completed in 0.15s with status 400
2025-08-02 11:40:51 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010170936584472656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:40:51.152209"
  },
  "success": false
}

2025-08-02 11:40:51 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010170936584472656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:40:51.152209"
  },
  "success": false
}

2025-08-02 11:40:51 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010170936584472656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:40:51.152209"
  },
  "success": false
}

2025-08-02 11:40:51 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:40:51 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:40:52 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:40:52 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:40:52 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:40:54 - managers.commands_server - DEBUG - Request completed in 2.37s with status 200
2025-08-02 11:40:54 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 2.2309234142303467, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:40:54.397563'}, 'success': True}
2025-08-02 11:40:54 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:40:54 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:40:54 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:40:55 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:40:55 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:40:55 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:40:55 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:41:08 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:41:08 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:41:08 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:41:08 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmym0oS_RWH1ta9UIAkHNERDWIQkkAXMbNRMFPMYhDDC__7K679bEdHL3rRS7KqzslzMsn8a_Noorb0qqjqN9_6doi-boYuajff_tp4QRB13aOv86jafNvMHqDfPIzRiNNOmdtrCVQ9vw1Obse-QoqmHRFOP3aOk70M9xU09wNvh50atj5Zs9n8FOcwH3ccwyaxXMgwFtuZvd-u5uKfaP0-Uhf6EVbXE3jSRw10QnsA1tCaTsKL-eVQclIjK5MEn2COAKP09-zWsgPbx8_uEo7JzZn5yoNxVfpkKAZc12iqd0ycC6MnGnOXNEE9iTaQoZ8-5bBgs6bIWL1lDqT2MtQEw_f7zddNNDWwjbqHh7zA9xSJg_1uR_yOQ-QDQdH7rxsY_vIlms-pLwbwBs-asUi4AqVOKvvGPUo7qbznii6Psi6NiuhmsqUCR2dzJUszZUkWR5dxB8iUs_Cjk0m4qwulIvLwejxjkc2smBcTV2GsviGaJiDkNVSHp_sYLPXrCoTMATTuV_flWoYvH4Sdq1GZD7AVIo2qFUKaZM5Ybnoyyhm_KJxMXm0G8yoXKFzYyiDsHcLM3DXFEsM92yEdkGKyGI6BleLXUhiDkzy4gH65YCpCWymCUnkhzsKv1AHx9xIcoWObuZTVUNYZXF5yUuYQ76IutyOOpDcgzFTCW5TKtxQk2Zhlzu0VqwA3UalDjq2Ck1CHGpUGJ_a3FttcXPuM9FCYa1HYdeXVkL0VwoDI3oxHHPyoZAmu6A510_PpxkkU0ovLx7UMZu9YRbfmhTQVfumi3IU51FPGBXjqWeOv_F1r_Z7isDRnz3Ib11LhrbrPoWUgHAGzQZoGIFn9pyyhUeUSG6MiJC1d4DWT7rXMVDUjvK9YfkkjXGO9q6tV6MlmAw0-IVDdLKukLr7Rn73P_KjUtz7vZZ5oDpL4M79PjWzjEHc8KI3_qPlUyzNV-YCufNHEA2DOSMMQovfh8bP2L0ejWRUEpA8U2bHoVicU18QmTYP4U83OgmNQHxqgeYsXMr00etM8F74hTYGI8ybmdnIpELpQ6FHO08GSg6slr_1UebZb-AXSZuHFL08_291FOoouMn-fuchHxz7jqx-eJWAoNimLgaFfAZM5ByC8Ijqh_sx4QtHVSc4CoGQu_cZIMMEC62aacedkbvDRtbLFiNelqE9EoB1pNF7MProP5V2Z6NSkrW5XMotyIGgZw8zUE2UukOznDZZCcqooI5bOuB67SqnpHIvPnM4uj0nXF3Jv10Fbn0aSmeJFKfZqK-cfZ_66B1Nm2K3Piq9CffL9WTxDB5emSKbT5uUctnw1O9w4ZnPuhoERxzOAXpXc9jdVo_lse9E5zrvSz_M1uTQM-RBTWnJ4Z1sCUD8veU0f8JnCNPZii-NRW3r5WfbRMuVlXgvktnVmTuDu3VkmcoHt7Gw7m8WDtaRhHFXD3Z7YnQ-d_ZZmhC3Rp80ebp9FmQwegEMvXT_agmxu3It5iTuPCSRtN0zewKDp1gV1E6GBlfZ90317fx_H8S2p66SIvAZ2b0FdvntDn76v8x9Wcf0WlR4svvzP15u2jmERfUEsFQwR4eeEfPTzJysbeS3aKz_Wy3r_c8X0j9Tr0nW72O4HKLHFmhyckx7lmfqQRBVd94YQHeMYRdAHDOAESRy2DZm9XuQ-J5IyGIIIYLuSgq9DkPZY0jzT4c1rmu5nsitdUFc9WnBrzivi0vyfET-NQpgBmrhx1HrtcPh3ssb-PH-8kO4YRuE_exZtlT_WzO7rJvZKWMyPyitXw34AodcJfCEbf0ZXChSDv1cUia1vYdf9UVq0uuuh6v_J-Gcaf0B8-YVe1VWwRjV2dHHX_zjt-950q3N5kVJ03MCgH9o_26ZIif9uxLv3zhyTQx1cvTq_dY51vZ-3GQt4T7ldas5mAiXaGveoZPGm5CyhAN54dbSF-VdH77bB2qGDv1YGJ3Bsd6CoHU3T-AHQGEVhm-_ff7TOA679QOx2IRbT5BaLYn9L7iNs69ERuY32ez_YURQREfTm-9_JEvoP.aI3PJA.ow6GTmoqSIo5fAXAau4Ze4yHloc'}
2025-08-02 11:41:08 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:41:09 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:41:09 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x015F9FF0>
2025-08-02 11:41:09 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:09 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:09 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:41:09 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:09 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:41:09 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:41:09 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:41:09 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:41:09 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:41:09 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:41:09 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:41:09 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:41:09 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:41:09 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:41:09 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:41:09 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:41:09 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:09 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:41:09 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:41:10 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:10 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:41:10 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:41:10 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-02 11:41:10 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009531974792480469,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:09.574203"
  },
  "success": false
}

2025-08-02 11:41:10 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009531974792480469,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:09.574203"
  },
  "success": false
}

2025-08-02 11:41:10 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009531974792480469,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:09.574203"
  },
  "success": false
}

2025-08-02 11:41:10 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:41:10 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:41:10 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:41:10 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.001407623291015625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:09.700858"
  },
  "success": false
}

2025-08-02 11:41:10 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.001407623291015625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:09.700858"
  },
  "success": false
}

2025-08-02 11:41:10 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.001407623291015625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:09.700858"
  },
  "success": false
}

2025-08-02 11:41:10 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:41:10 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:41:10 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:10 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:41:10 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:41:11 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:41:11 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:41:11 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:41:11 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmym0oS_RWH1ta9UIAkHNERDWIQkkAXMbNRMFPMYhDDC__7K679bEdHL3rRS7KqzslzMsn8a_Noorb0qqjqN9_6doi-boYuajff_tp4QRB13aOv86jafNvMHqDfPIzRiNNOmdtrCVQ9vw1Obse-QoqmHRFOP3aOk70M9xU09wNvh50atj5Zs9n8FOcwH3ccwyaxXMgwFtuZvd-u5uKfaP0-Uhf6EVbXE3jSRw10QnsA1tCaTsKL-eVQclIjK5MEn2COAKP09-zWsgPbx8_uEo7JzZn5yoNxVfpkKAZc12iqd0ycC6MnGnOXNEE9iTaQoZ8-5bBgs6bIWL1lDqT2MtQEw_f7zddNNDWwjbqHh7zA9xSJg_1uR_yOQ-QDQdH7rxsY_vIlms-pLwbwBs-asUi4AqVOKvvGPUo7qbznii6Psi6NiuhmsqUCR2dzJUszZUkWR5dxB8iUs_Cjk0m4qwulIvLwejxjkc2smBcTV2GsviGaJiDkNVSHp_sYLPXrCoTMATTuV_flWoYvH4Sdq1GZD7AVIo2qFUKaZM5Ybnoyyhm_KJxMXm0G8yoXKFzYyiDsHcLM3DXFEsM92yEdkGKyGI6BleLXUhiDkzy4gH65YCpCWymCUnkhzsKv1AHx9xIcoWObuZTVUNYZXF5yUuYQ76IutyOOpDcgzFTCW5TKtxQk2Zhlzu0VqwA3UalDjq2Ck1CHGpUGJ_a3FttcXPuM9FCYa1HYdeXVkL0VwoDI3oxHHPyoZAmu6A510_PpxkkU0ovLx7UMZu9YRbfmhTQVfumi3IU51FPGBXjqWeOv_F1r_Z7isDRnz3Ib11LhrbrPoWUgHAGzQZoGIFn9pyyhUeUSG6MiJC1d4DWT7rXMVDUjvK9YfkkjXGO9q6tV6MlmAw0-IVDdLKukLr7Rn73P_KjUtz7vZZ5oDpL4M79PjWzjEHc8KI3_qPlUyzNV-YCufNHEA2DOSMMQovfh8bP2L0ejWRUEpA8U2bHoVicU18QmTYP4U83OgmNQHxqgeYsXMr00etM8F74hTYGI8ybmdnIpELpQ6FHO08GSg6slr_1UebZb-AXSZuHFL08_291FOoouMn-fuchHxz7jqx-eJWAoNimLgaFfAZM5ByC8Ijqh_sx4QtHVSc4CoGQu_cZIMMEC62aacedkbvDRtbLFiNelqE9EoB1pNF7MProP5V2Z6NSkrW5XMotyIGgZw8zUE2UukOznDZZCcqooI5bOuB67SqnpHIvPnM4uj0nXF3Jv10Fbn0aSmeJFKfZqK-cfZ_66B1Nm2K3Piq9CffL9WTxDB5emSKbT5uUctnw1O9w4ZnPuhoERxzOAXpXc9jdVo_lse9E5zrvSz_M1uTQM-RBTWnJ4Z1sCUD8veU0f8JnCNPZii-NRW3r5WfbRMuVlXgvktnVmTuDu3VkmcoHt7Gw7m8WDtaRhHFXD3Z7YnQ-d_ZZmhC3Rp80ebp9FmQwegEMvXT_agmxu3It5iTuPCSRtN0zewKDp1gV1E6GBlfZ90317fx_H8S2p66SIvAZ2b0FdvntDn76v8x9Wcf0WlR4svvzP15u2jmERfUEsFQwR4eeEfPTzJysbeS3aKz_Wy3r_c8X0j9Tr0nW72O4HKLHFmhyckx7lmfqQRBVd94YQHeMYRdAHDOAESRy2DZm9XuQ-J5IyGIIIYLuSgq9DkPZY0jzT4c1rmu5nsitdUFc9WnBrzivi0vyfET-NQpgBmrhx1HrtcPh3ssb-PH-8kO4YRuE_exZtlT_WzO7rJvZKWMyPyitXw34AodcJfCEbf0ZXChSDv1cUia1vYdf9UVq0uuuh6v_J-Gcaf0B8-YVe1VWwRjV2dHHX_zjt-950q3N5kVJ03MCgH9o_26ZIif9uxLv3zhyTQx1cvTq_dY51vZ-3GQt4T7ldas5mAiXaGveoZPGm5CyhAN54dbSF-VdH77bB2qGDv1YGJ3Bsd6CoHU3T-AHQGEVhm-_ff7TOA679QOx2IRbT5BaLYn9L7iNs69ERuY32ez_YURQREfTm-9_JEvoP.aI3PJg.EjL1xPflWTf3srvDppu-hwlD5ho'}
2025-08-02 11:41:11 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:41:11 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:41:11 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x0186D3C0>
2025-08-02 11:41:11 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:11 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:11 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:41:11 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:11 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:41:11 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:41:11 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:41:11 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:41:11 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:41:11 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:41:11 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:41:11 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:41:11 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:41:11 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:41:11 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:41:11 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:41:12 - managers.commands_server - DEBUG - Request completed in 1.85s with status 200
2025-08-02 11:41:12 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7047910690307617, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:41:12.275099'}, 'success': True}
2025-08-02 11:41:12 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:41:12 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:41:12 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:41:12 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:41:13 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:41:13 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:41:13 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:41:46 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:41:46 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:41:46 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:41:46 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVsuS2koS_RUHa9OtKj1AjpiIEQipRSPRAr03RKkkUOmNnqAb_vdbavvajolZzGIWLMjMOifPqaSSvxaXOm4KVMZlt_jWNX38ddG3cbP49tcCYRy37aWrsrhcfFs8ERRfECOd2TfBeORnz87NJV43Dxkwgp9Eh73LblVrKgpbwHhy7wAAOGRZIZtaPga1dLx4uNiHZbCKlmQ7XJQw60WJeNJBkzPDOsV5YqhPSdCzJ8m55e7dJVtoqKxesNXteBlg1cmXZcLv8ssUKooj6GorkzPLDMtWO1r3Sq4LYbDQ9PR2oqSYaHvz3yXMnaWTdlbMN9WDOvngWBEPo7kODkqoDpGbfeiXkQGr1eLrIn7UpInbC6JegBXPAbhaMezvOKE-sLwofl2Q6Jcv8XOfhComR7I_25MGDKK1WtHVwVYTtOJElemjbmmjoQap7prQtzaZkSapMd0m39KBD3Xen3ajn2ogsJTCUHfksN0zsSfNmO8OMMnVfKE0NWb1OVRFb6cRT9VwgErqQxGE5Wk6FNEQwqgNznwaQmaGSOJyhtAeumxPR-s26uluMmSdO3gSg8oAGnLU6DDqfNZJg7nFggHI8zkfJoyuRiN2E3AolBG_6X0AxSGAjzzyjBwXxkA587A0e8rfaWQkvudkWloR3ZKAPmWcLlPeyZyOW0Cl1zBKTRZNRhm6BpVsP3U56Aw3h0fVqCJ5U-I3pYrOfILfNr-1eM4UeHuqh2cCl2cOM--Z2ltSDELtTXeUYzca6Q0Yls8frexxlDWe6gX6dr4Gp_PdvJ37oprysAho78ozshIpgCBB7vir_8Cdvz-uUeE8kRvUgWuSY3l6Rq5NcRTGg0mC4W32nyCgsYa6f6JU4YIid5CTjXaWt7a32cxYYSFSXHuuzY9yxIc7jkFynphM5_oF80TOxjvOOgo-Cd3PuhSpTq-pP_v71LipffYEcGH_x50_Kv3JlyEUy1B1AIbOk2roI3o-2n7e_eCfxY0JMRdCQ_ddsbFYI3CYx_lMwN1M94pv8x9nKO7cnZJahd05zj4Pbe2BVbBzmKDVC4W1lNyKs52IpwweXH2epxJ5QR7mVJsL8l-efo57QHXkbez8zgXUR9_bg9kP5CoMjT2MyWboT4F-JIbi5fEbnc90xxqW-dBTOt3ySXy5azEQt9tQUR3j491XVyTR67LlRZmdQp9k6KwpH70bKW-3d-n8IZOIJJu8FeSmd63TCV23YaqWR-YeTze4Hu02vAngMtx3zzsMI1c5PABcRjYMLbuzOdvm9w3w3h7rwF55V3xDDRg_-Or-xPkRnZ3r_a7YD3g6960uJ8YmH0OTG4aQXYvl-a5MwntWPgUlRr0fC7sy_GhwZ8Ni-ehYTeCs4Sk9JHGtmDrmeL3V_UbdRJNjejjHElSY8OSXIreql4yYbHfpqTZiedxFDSc_mhzWkUFSI2tqVGwSfLTvwBj4Bm9G5-bYq6OLapeAXH8X92HvjJNLpruvnN9C8VRuC9BLSVJ0JTaFcrrR163FVR3TByvpurr99vo6juPLrapueYxq0r7gqnhFfZe8zu8_Ka_VS1wgkn_5n8vrprqSPP5CWUoSUcLPF_LSPT9ZNzFq6F75sV7m-s8V010S1CY0HWanFRc2KXhciU185qTlZi3RctRHNA0YnhXXDAQsx66XNZcOA7fK2FuBexxDRih4Mqxx0jG3-p70L6iu25_NznS4Kju64OaeZ8Sp_j8jfhpFMTF9ca9xg5p-_e_bHPszfxmo7iuJo3_2LN0qf6wZ7uviigqSPy8lKmbDfgDR0zcyUBt_RmcKGiO_VxQH5rOkbf-4Wrq6q77s_un4Zxt_QHz5hV5WJZ6j8Xr1zA0uEdH23QkLSD5ckaZrgru--XNs8oT970a8oldpe1tX-ICq7Nj67uG0X6YbuEPG8b2SPQkb8dI-xcUG1IXsKjlE48E_T9K_WlFY4nlC-3C-GcDSfxRrnhdEUQRrKDI8zyy-f_8xOhcyzwMrCBFzFbklE1_DJbeKmSUSY24Zr1YhFniejVlx8f1vFkT3Ig.aI3PSg.7i1l6a-Hx_IkfrJTvsvIVF1Wx0E'}
2025-08-02 11:41:46 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:41:46 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:41:46 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x015F3570>
2025-08-02 11:41:46 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:46 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:46 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:41:46 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:46 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:41:46 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:41:46 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:41:46 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:41:46 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:41:46 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:41:46 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:41:46 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:41:46 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:41:46 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:41:46 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:41:46 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:41:46 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:46 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:41:46 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:41:46 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:41:46 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:41:47 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:47 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:41:47 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Request completed in 0.15s with status 200
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.6702880859375e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:41:46.647137'}, 'success': True}
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 5.221366882324219e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:41:46.777371'}, 'success': True}
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-02 11:41:47 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007126331329345703,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:46.796230"
  },
  "success": false
}

2025-08-02 11:41:47 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007126331329345703,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:46.796230"
  },
  "success": false
}

2025-08-02 11:41:47 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007126331329345703,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:46.796230"
  },
  "success": false
}

2025-08-02 11:41:47 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:41:47 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:41:47 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:41:47 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007586479187011719,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:46.934290"
  },
  "success": false
}

2025-08-02 11:41:47 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007586479187011719,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:46.934290"
  },
  "success": false
}

2025-08-02 11:41:47 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007586479187011719,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:41:46.934290"
  },
  "success": false
}

2025-08-02 11:41:47 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:41:47 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:41:48 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:48 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:41:48 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:41:49 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:41:49 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:41:49 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:41:49 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVsuS2koS_RUHa9OtKj1AjpiIEQipRSPRAr03RKkkUOmNnqAb_vdbavvajolZzGIWLMjMOifPqaSSvxaXOm4KVMZlt_jWNX38ddG3cbP49tcCYRy37aWrsrhcfFs8ERRfECOd2TfBeORnz87NJV43Dxkwgp9Eh73LblVrKgpbwHhy7wAAOGRZIZtaPga1dLx4uNiHZbCKlmQ7XJQw60WJeNJBkzPDOsV5YqhPSdCzJ8m55e7dJVtoqKxesNXteBlg1cmXZcLv8ssUKooj6GorkzPLDMtWO1r3Sq4LYbDQ9PR2oqSYaHvz3yXMnaWTdlbMN9WDOvngWBEPo7kODkqoDpGbfeiXkQGr1eLrIn7UpInbC6JegBXPAbhaMezvOKE-sLwofl2Q6Jcv8XOfhComR7I_25MGDKK1WtHVwVYTtOJElemjbmmjoQap7prQtzaZkSapMd0m39KBD3Xen3ajn2ogsJTCUHfksN0zsSfNmO8OMMnVfKE0NWb1OVRFb6cRT9VwgErqQxGE5Wk6FNEQwqgNznwaQmaGSOJyhtAeumxPR-s26uluMmSdO3gSg8oAGnLU6DDqfNZJg7nFggHI8zkfJoyuRiN2E3AolBG_6X0AxSGAjzzyjBwXxkA587A0e8rfaWQkvudkWloR3ZKAPmWcLlPeyZyOW0Cl1zBKTRZNRhm6BpVsP3U56Aw3h0fVqCJ5U-I3pYrOfILfNr-1eM4UeHuqh2cCl2cOM--Z2ltSDELtTXeUYzca6Q0Yls8frexxlDWe6gX6dr4Gp_PdvJ37oprysAho78ozshIpgCBB7vir_8Cdvz-uUeE8kRvUgWuSY3l6Rq5NcRTGg0mC4W32nyCgsYa6f6JU4YIid5CTjXaWt7a32cxYYSFSXHuuzY9yxIc7jkFynphM5_oF80TOxjvOOgo-Cd3PuhSpTq-pP_v71LipffYEcGH_x50_Kv3JlyEUy1B1AIbOk2roI3o-2n7e_eCfxY0JMRdCQ_ddsbFYI3CYx_lMwN1M94pv8x9nKO7cnZJahd05zj4Pbe2BVbBzmKDVC4W1lNyKs52IpwweXH2epxJ5QR7mVJsL8l-efo57QHXkbez8zgXUR9_bg9kP5CoMjT2MyWboT4F-JIbi5fEbnc90xxqW-dBTOt3ySXy5azEQt9tQUR3j491XVyTR67LlRZmdQp9k6KwpH70bKW-3d-n8IZOIJJu8FeSmd63TCV23YaqWR-YeTze4Hu02vAngMtx3zzsMI1c5PABcRjYMLbuzOdvm9w3w3h7rwF55V3xDDRg_-Or-xPkRnZ3r_a7YD3g6960uJ8YmH0OTG4aQXYvl-a5MwntWPgUlRr0fC7sy_GhwZ8Ni-ehYTeCs4Sk9JHGtmDrmeL3V_UbdRJNjejjHElSY8OSXIreql4yYbHfpqTZiedxFDSc_mhzWkUFSI2tqVGwSfLTvwBj4Bm9G5-bYq6OLapeAXH8X92HvjJNLpruvnN9C8VRuC9BLSVJ0JTaFcrrR163FVR3TByvpurr99vo6juPLrapueYxq0r7gqnhFfZe8zu8_Ka_VS1wgkn_5n8vrprqSPP5CWUoSUcLPF_LSPT9ZNzFq6F75sV7m-s8V010S1CY0HWanFRc2KXhciU185qTlZi3RctRHNA0YnhXXDAQsx66XNZcOA7fK2FuBexxDRih4Mqxx0jG3-p70L6iu25_NznS4Kju64OaeZ8Sp_j8jfhpFMTF9ca9xg5p-_e_bHPszfxmo7iuJo3_2LN0qf6wZ7uviigqSPy8lKmbDfgDR0zcyUBt_RmcKGiO_VxQH5rOkbf-4Wrq6q77s_un4Zxt_QHz5hV5WJZ6j8Xr1zA0uEdH23QkLSD5ckaZrgru--XNs8oT970a8oldpe1tX-ICq7Nj67uG0X6YbuEPG8b2SPQkb8dI-xcUG1IXsKjlE48E_T9K_WlFY4nlC-3C-GcDSfxRrnhdEUQRrKDI8zyy-f_8xOhcyzwMrCBFzFbklE1_DJbeKmSUSY24Zr1YhFniejVlx8f1vFkT3Ig.aI3PSw.lFFXmgO39lDgJd2BoYB6vOM9GSE'}
2025-08-02 11:41:49 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:41:49 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:41:49 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x0186D5D0>
2025-08-02 11:41:49 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:49 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:49 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:41:49 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:41:49 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:41:49 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:41:49 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:41:50 - managers.commands_server - DEBUG - Request completed in 1.91s with status 200
2025-08-02 11:41:50 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7668242454528809, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:41:49.570089'}, 'success': True}
2025-08-02 11:41:50 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:41:50 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:41:50 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:41:50 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:41:50 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:41:50 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:41:50 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:41:50 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:41:50 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:41:50 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:41:50 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:41:50 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:41:50 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:41:50 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:41:50 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:41:50 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:44:48 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:45:41 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:45:41 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:45:41 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:45:41 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVsmuo0oS_ZWS1-V7ITG2Kaml9sBoA7aZDBsrSZJ5ugwG81T__pJb9apKrV70osWKyMxz4pwMIvhr8ahxU8ASl93iW9f0-Ouib3Gz-PbXAiKE2_bRVRkuF98WLwi4N0jtDEZaayMX3ibeN4ERU1vA9a0VB1fs-JJwKKvOxFuIJMZcNvSumo4px1-GpdslBSqkvWhertsHdHbNlHOPbJNMFrTrur18pGvchhT64CLN1h_h6J4io-WbUKMc--mdI7guUWBJU8AcVH1o1alRzrAV-bhlS_e6ZXOUWy2fbzSpd92PHTxE7mlnkOcmG8JVEu9ATXzmEp07OUJPx0arTGs6Vn9EFL3ZLL4u8FgnDW4fkHhBb9gVDTYcs_kdT4gPDMttvy6S4Jcv-KXEvogSPVEMa5JpLZFbuehq7yCv5eKWaaY6qKY8aKKXqs4VuOY-09I41aZock2VdoHKuhM_uKlMe6ZQaCKfnA8Khe-7GfNk09ckvL4Rmhox6hyqAuk2oKl6noGQuoCj_fI2nYvg6YOg9Qw29QE1Q8S4nCHkUT1ak25Gg5ryk3ZUV-f7joKlB7Rj0Kgg6FzGTr05xYKi4d1duSCmVDEYkBPT50IYkKT2HuCeHhjz4K7lqNCehDP3y2tP-Ds5GRL3bmdyWiWquaPVKVupR8I7XSf9QBPpNQjSKwMnrfQdjUi2XurR6zQnB7qoVcFxXyJJqAKDjZG0_63lbk_eXSF6WMpzWOo88xrE3pJgJMTelCcc_KClEa2ZLqub2agfZZbopdXDfA125zp5O-dFNOV-4ZHchVdgxjsP0DF0hl_5e878PoZBYb-g49Wec0308vYKHIvgCNQdxDEC0ex_r9qeBIuK1QWvczOhsNKAsWhOM44KM2P5BUdwrXmv69L7o1dwvJVrFOEFcBJyJxcU7zM_Nvadz30pFO1eFn_m96lxX7vMjUaF9R93Plbqiy19wJW-aNMI2C-ioQ_I-eDwefdP1-D2V4BWPtBU1-Eak9E8mxoNI6E_rqkiuBZ7MQDHO7yQmoXV2baS-5Y8IpHmbcpr1UJgTCE3ccZzaMrA2VHneirh3cv9nGhz6PyXp5_l7hEdeYvt32se8dG9K_TsB3QEisRGbbIo8ilQ6kRq8KDkWCL1mfKMZl5HNUWsOsXcWzycHzauX1fRuvj6djVEhaOEmqt0p-XrpK5Ph84MVkg43qSdzI0pp90FI93eKEfgBAdYKuv11moDbFM0T8uyb-HEthpzz6-OwK77A4N5j-NoKvQSThODjRdb0Ym57B2NM5OH0eZeej6PvnxvFGoZ-iuljMKOnzLmQ-PR9iL6GQ6zmm85bg-8mBZL69Xqz1EI93HXbxnPztx8KPWP3Cx328eDOqNoa2xi9Eqt2hC0MBz8RhYkMzGHjX5QXqPD9zW-IH28tS_RRUDaq2z54e2jkVGGIfazXm2qznMKZlAClBxE97kbz_6zx6Ufll6yPcE08EkHJWY2YA16U8qXevBQjlGXWEekpKF0Jd2tRVWNScOKu65uv72_D8PwFlVVlGNYJ-0bqop32Hfx-9z_kzKs3nABk_wLOVQmwZf_-VTdVGGSY0L42SEf3euTdY9hQ-bKj_Eyb_wcMd0jhm1MlkvaFtOU29qFvwtvm8F4qBIYyHbYB2SZpliG21KAZlbMdlmv0udztcmYqEA9woBaF2zy3KK4o6L6I-7fIHHjZ5YzHarKjgy4OdkZcar_z4ifRhFMRDpuiBvY9Nt_R3Psz_XHk-gOExz8M2fJVPljzJChEsIiyV-PEhazYT-AyOkoeRIbf0ZnChJLfo-oFTOfTdr2j6slo7vqy-6fjH-m8QfEl1_oZVWiOXpHl0NYHW8GKeJnRmPvKgdkuU5Q1zd_lk0eM__diHf4vjtE2wqdYZXpreucb8oy3QMeavqpOt53SMNL64aLPV0XR0fIARzOrjHt_tVy6yWaK7T355uhGZpab1l2zZHvlPxdUCxLLb5__1E6j2SuB2a9DqiQWy0pHPrL1QZTS8jh1RJvNj5asyyDGW7x_W-unPlc.aI3QNQ.SxOXeomwiSgXcDlXZRiBbaDeD4c'}
2025-08-02 11:45:41 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:45:41 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:45:41 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06F822B8>
2025-08-02 11:45:41 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:41 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:41 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:45:41 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:41 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:45:41 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:45:41 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:45:42 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:45:42 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:45:42 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:45:42 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:45:42 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:45:42 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:45:42 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:45:42 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:45:42 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:45:42 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:42 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:45:42 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:45:42 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:45:42 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:45:42 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:42 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:45:42 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:45:42 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:45:42 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Request completed in 0.15s with status 200
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.956390380859375e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:45:42.540553'}, 'success': True}
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Request completed in 0.24s with status 200
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.00030684471130371094, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:45:42.520142'}, 'success': True}
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:45:43 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.007381439208984375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:45:42.696440"
  },
  "success": false
}

2025-08-02 11:45:43 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.007381439208984375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:45:42.696440"
  },
  "success": false
}

2025-08-02 11:45:43 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.007381439208984375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:45:42.696440"
  },
  "success": false
}

2025-08-02 11:45:43 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:45:43 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:45:43 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:45:43 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009706020355224609,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:45:42.713720"
  },
  "success": false
}

2025-08-02 11:45:43 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009706020355224609,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:45:42.713720"
  },
  "success": false
}

2025-08-02 11:45:43 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009706020355224609,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:45:42.713720"
  },
  "success": false
}

2025-08-02 11:45:43 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:45:43 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:45:44 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:44 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:45:44 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:45:44 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:45:44 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:45:44 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:45:44 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVsmuo0oS_ZWS1-V7ITG2Kaml9sBoA7aZDBsrSZJ5ugwG81T__pJb9apKrV70osWKyMxz4pwMIvhr8ahxU8ASl93iW9f0-Ouib3Gz-PbXAiKE2_bRVRkuF98WLwi4N0jtDEZaayMX3ibeN4ERU1vA9a0VB1fs-JJwKKvOxFuIJMZcNvSumo4px1-GpdslBSqkvWhertsHdHbNlHOPbJNMFrTrur18pGvchhT64CLN1h_h6J4io-WbUKMc--mdI7guUWBJU8AcVH1o1alRzrAV-bhlS_e6ZXOUWy2fbzSpd92PHTxE7mlnkOcmG8JVEu9ATXzmEp07OUJPx0arTGs6Vn9EFL3ZLL4u8FgnDW4fkHhBb9gVDTYcs_kdT4gPDMttvy6S4Jcv-KXEvogSPVEMa5JpLZFbuehq7yCv5eKWaaY6qKY8aKKXqs4VuOY-09I41aZock2VdoHKuhM_uKlMe6ZQaCKfnA8Khe-7GfNk09ckvL4Rmhox6hyqAuk2oKl6noGQuoCj_fI2nYvg6YOg9Qw29QE1Q8S4nCHkUT1ak25Gg5ryk3ZUV-f7joKlB7Rj0Kgg6FzGTr05xYKi4d1duSCmVDEYkBPT50IYkKT2HuCeHhjz4K7lqNCehDP3y2tP-Ds5GRL3bmdyWiWquaPVKVupR8I7XSf9QBPpNQjSKwMnrfQdjUi2XurR6zQnB7qoVcFxXyJJqAKDjZG0_63lbk_eXSF6WMpzWOo88xrE3pJgJMTelCcc_KClEa2ZLqub2agfZZbopdXDfA125zp5O-dFNOV-4ZHchVdgxjsP0DF0hl_5e878PoZBYb-g49Wec0308vYKHIvgCNQdxDEC0ex_r9qeBIuK1QWvczOhsNKAsWhOM44KM2P5BUdwrXmv69L7o1dwvJVrFOEFcBJyJxcU7zM_Nvadz30pFO1eFn_m96lxX7vMjUaF9R93Plbqiy19wJW-aNMI2C-ioQ_I-eDwefdP1-D2V4BWPtBU1-Eak9E8mxoNI6E_rqkiuBZ7MQDHO7yQmoXV2baS-5Y8IpHmbcpr1UJgTCE3ccZzaMrA2VHneirh3cv9nGhz6PyXp5_l7hEdeYvt32se8dG9K_TsB3QEisRGbbIo8ilQ6kRq8KDkWCL1mfKMZl5HNUWsOsXcWzycHzauX1fRuvj6djVEhaOEmqt0p-XrpK5Ph84MVkg43qSdzI0pp90FI93eKEfgBAdYKuv11moDbFM0T8uyb-HEthpzz6-OwK77A4N5j-NoKvQSThODjRdb0Ym57B2NM5OH0eZeej6PvnxvFGoZ-iuljMKOnzLmQ-PR9iL6GQ6zmm85bg-8mBZL69Xqz1EI93HXbxnPztx8KPWP3Cx328eDOqNoa2xi9Eqt2hC0MBz8RhYkMzGHjX5QXqPD9zW-IH28tS_RRUDaq2z54e2jkVGGIfazXm2qznMKZlAClBxE97kbz_6zx6Ufll6yPcE08EkHJWY2YA16U8qXevBQjlGXWEekpKF0Jd2tRVWNScOKu65uv72_D8PwFlVVlGNYJ-0bqop32Hfx-9z_kzKs3nABk_wLOVQmwZf_-VTdVGGSY0L42SEf3euTdY9hQ-bKj_Eyb_wcMd0jhm1MlkvaFtOU29qFvwtvm8F4qBIYyHbYB2SZpliG21KAZlbMdlmv0udztcmYqEA9woBaF2zy3KK4o6L6I-7fIHHjZ5YzHarKjgy4OdkZcar_z4ifRhFMRDpuiBvY9Nt_R3Psz_XHk-gOExz8M2fJVPljzJChEsIiyV-PEhazYT-AyOkoeRIbf0ZnChJLfo-oFTOfTdr2j6slo7vqy-6fjH-m8QfEl1_oZVWiOXpHl0NYHW8GKeJnRmPvKgdkuU5Q1zd_lk0eM__diHf4vjtE2wqdYZXpreucb8oy3QMeavqpOt53SMNL64aLPV0XR0fIARzOrjHt_tVy6yWaK7T355uhGZpab1l2zZHvlPxdUCxLLb5__1E6j2SuB2a9DqiQWy0pHPrL1QZTS8jh1RJvNj5asyyDGW7x_W-unPlc.aI3QNw.7zoeetx5IB69LVpvuYPIkc9mJs4'}
2025-08-02 11:45:44 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:45:44 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:45:44 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06FA74B0>
2025-08-02 11:45:44 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:44 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:44 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:45:44 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:45:44 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:45:44 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:45:44 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:45:45 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:45:45 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:45:45 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:45:45 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:45:45 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:45:45 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:45:45 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:45:45 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:45:45 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:45:45 - managers.commands_server - DEBUG - Request completed in 1.95s with status 200
2025-08-02 11:45:45 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.8038690090179443, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:45:45.519273'}, 'success': True}
2025-08-02 11:45:45 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:45:45 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:45:45 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:45:46 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:45:46 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:45:46 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:45:46 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:48:51 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:49:04 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:49:11 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:49:20 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:49:51 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:50:32 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:50:34 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:51:01 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 11:51:01 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 11:51:01 - auth - INFO - Token[expires_in]: 3599
2025-08-02 11:51:01 - auth - INFO - Token[scope]: openid https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email
2025-08-02 11:51:01 - auth - INFO - Token[token_type]: Bearer
2025-08-02 11:51:01 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJHSVFTQ19tdFNOT1FuSE5NSkVVV2hnIiwibm9uY2UiOiIydk5KM3FnYURMQWFXanFKN3hucyIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI0NjU5LCJleHAiOjE3NTQxMjgyNTl9.BBZ8d82Z9Vvl4acw7VtVXHuWl5X8m4AV6Ul5KrMAwlmIQ3K841QbNZ_m-IUBQMvJNoPSQJvhZQuwmn_uU9RyzAnJza2xc4WQqSPpgnkfCIcz25YcNdufPNFahB5vnN41AZPevoh1jHrU1i_DocQJHhwZMI0RWqSdE7J5xVTzGxCfAqfEe0ZBatKKK0a7vBh_ejrjAm1Lem3pl7Pd4sLITmUFt4lpTl4FNWPLhMIS-uopXP2O4JGFJtWrXeUpl209W9gnpnidFOH072FDundtYiwrFa2hT7uKOUfjqE6aZBQ9aYzTzRPH3oe40Ert6nBAbwOb6Q6xLge3MilS1LtGqQ
2025-08-02 11:51:01 - auth - INFO - Token[expires_at]: 1754128259
2025-08-02 11:51:01 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': 'GIQSC_mtSNOQnHNMJEUWhg', 'nonce': '2vNJ3qgaDLAaWjqJ7xns', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754124659, 'exp': 1754128259}
2025-08-02 11:51:01 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 11:51:01 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 11:51:01 - auth - INFO -   Used 2FA: False
2025-08-02 11:51:01 - auth - INFO -   Method: none
2025-08-02 11:51:01 - auth - INFO -   Confidence: low
2025-08-02 11:51:02 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:51:02 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:51:02 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:51:02 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuq0gS_ZWS1-V7IQHbPKmlxgM2GNLGTIaNlUCawZBwGW1K7987uW_sUi160RtLjsg8J87JIOKv2a3CdYEIJu3sS1t3-M9Z1-B69uWvGQpD3DS3tnxgMvsyeyEgviFGMrnDAr72jMNe5O1ACsF83XKT1ebNOXtdhqVD3KgdttqqKveuLujC62EsyCbvD4lwMtc7xxxS8nqIqbow-tyDWXjQSDFaKuucH1dl261GO-4OReH4H94KmycSijd_G2vXapWxeCuYtQBv-0UF78f5utixrojccw1KSdDsDT5dj08R6AraxN5RsiVTuiimbBz2V6CngQFT9hmXfSIlR4hrkmvrPmbYpTD7c4afVVrj5oaoEzTCs2AFBPFXPKUucIJII2n00xX8UpNgH6anVDXtUWFhqjRK0Vb-RlkoxeUBLX3QLWWAez_TXQN41voBsySDYzx6ls56QBe8cTd4mcL6llzA_S7VNiqDr9KEeXRYI70bb5SmCjl9CpXR4TKEY9lrQM48ILIBuYxaEfUBiBrfFLIAMBNEgskEoTz1rT2erHjQs90ItzqvXSUGER_AbVTrIGo9zsn8qcSCYdHV4z2QMPo-GkI3YbVCHsKD3vlA7H3wzKMrzMMC9pQzD4jRUf5WSYfUuzoPJStT3ZJYfXzw-pbyjsZ42rBUegWizODQCEngQirZfulbv4VuDk57WEbbNQkPchmZQhIe1r-0XJ3Rv6pUj8D4rsBoE69J7SUUI6X2ZjvKsRtgFrPQ8oST9XietopA9bL6ZnoGp_XcvJnqopryoPBp7fIrshLJB2yC3OFn_b47_X_eo8J5IdevfNdIT-Tyilyb4sjMFSRJCOLJ_4PpyJbBim0kw5PFyp25E6D5cBwHJGTCCgqR4tqT96_oIRx1TiaefdENV74iIh8hl3Tha6pPSAJ3OqdmaO90yv57fZ8a15XHXdiwsP_25s9SfwkkACIJ9g4bAudFNXQRvR9tPt--90xxbYCQDwDUPVesLQ76DvM0zZT9MDJV9mzhbAJx5-7kzCrs1nHUPLCVZ7hndw7jN3ohc5acW_ixE8PxATRXn_qJoKufBznV5rL5T08_292nOvIGO79yPvXRu6rs5AdyZYbGnnC0GfopMDCzBYqX4wPtz2zHQct46ln8glYuvq3X_ipaAV90-pxHIR0nrXM9dG4uXFcFLzkLOxeOtS4NeaEY3HHFs0YA_VsxV-y1ofcqLM-mofaJb3RDQW6dLV5eo0TUEYFnyLvGh3muYvK4b5RwBIIXwqi7n6GMkrXQE8izkn_GfZmw2aG22fS2LUNDPSSDryvMxf0wo91SFZ6ONe6fm7v0cd9hxl-j9ng8MmjZr5MbzupMKlgNF1yVL88R32gKNVlu-byycl6G7llLdMWcd2V1PYMTr-5ltXXrK7arHDCiK8akImkknw7MEsjbjtAPNB1qGYHEWnbHk33PPnYL5K8NEXmjNV7OB67EPLOr2wVZS8FwChbG4qnFmI6LaS63-w-DTrcmLCtMBxb9pfB_JG1bNV_e34dheIvLMs4xqtLmLSyLd9S1yfu0BFJyL9-qurynOf7fL-ACpTkl_JyQt_b1ybrGqKZb5dtymY59Lpj2lqAmoem9YpibW9Ga8GSQA9TVne0mMT2OuoimWUbgxBUDWI7nVvOKz_qeXz64uAi7EANmUQhpvwqTlomrj6R7Q1XVfK9xogtL0tL1NpU6IY7V_xnxm-Avs5BO3DuuUd2t_h1Psd_zt57qvqc4-rFl6Vb57zVzR0Wav24EFZNh34Do7TjtqY3foxMFjaW_VhS_mO6mTUOzP56ILu6yI-2Pir-X8RvEHz_RSUnCKQp6qHIfMdpqEnKzD3X5JA1NV2nYdjX-DTtPuH824h29S5t4VYYaKh-nxnO1izrP1mCH4OlYbq9SCPHcvuBizVbF1pVzgAbNM0fpX424mIdTh3bB9DIsxzKLlSAsRFFkV0BkBIGZff36rXVu6dQP3GIRMXeRnzP4Hsz5JWbmSMT8HC-XQbgQBA5z4uzrfwC4FvWp.aI3Rdg.rjOpROUjGugFAttOonnkC-SW7rE'}
2025-08-02 11:51:02 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:51:02 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:51:02 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x070454B0>
2025-08-02 11:51:02 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:02 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:02 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:51:02 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:02 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:51:02 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:51:02 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:51:03 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:51:03 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:51:03 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:51:03 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:51:03 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:51:03 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:51:03 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:51:03 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:51:03 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:51:03 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:03 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:51:03 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:51:03 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:51:03 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:51:03 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:03 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:51:03 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:51:03 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:51:03 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:51:03 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-02 11:51:03 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.6464462280273438e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:51:03.480255'}, 'success': True}
2025-08-02 11:51:03 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:51:03 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:51:04 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-02 11:51:04 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.1219253540039062e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:51:03.561759'}, 'success': True}
2025-08-02 11:51:04 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:51:04 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:51:04 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:51:04 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007822513580322266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:51:03.637750"
  },
  "success": false
}

2025-08-02 11:51:04 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007822513580322266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:51:03.637750"
  },
  "success": false
}

2025-08-02 11:51:04 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007822513580322266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:51:03.637750"
  },
  "success": false
}

2025-08-02 11:51:04 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:51:04 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:51:04 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:51:04 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009946823120117188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:51:03.709263"
  },
  "success": false
}

2025-08-02 11:51:04 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009946823120117188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:51:03.709263"
  },
  "success": false
}

2025-08-02 11:51:04 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009946823120117188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:51:03.709263"
  },
  "success": false
}

2025-08-02 11:51:04 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:51:04 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:51:04 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:04 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:51:04 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:51:05 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:51:05 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:51:05 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:51:05 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuq0gS_ZWS1-V7IQHbPKmlxgM2GNLGTIaNlUCawZBwGW1K7987uW_sUi160RtLjsg8J87JIOKv2a3CdYEIJu3sS1t3-M9Z1-B69uWvGQpD3DS3tnxgMvsyeyEgviFGMrnDAr72jMNe5O1ACsF83XKT1ebNOXtdhqVD3KgdttqqKveuLujC62EsyCbvD4lwMtc7xxxS8nqIqbow-tyDWXjQSDFaKuucH1dl261GO-4OReH4H94KmycSijd_G2vXapWxeCuYtQBv-0UF78f5utixrojccw1KSdDsDT5dj08R6AraxN5RsiVTuiimbBz2V6CngQFT9hmXfSIlR4hrkmvrPmbYpTD7c4afVVrj5oaoEzTCs2AFBPFXPKUucIJII2n00xX8UpNgH6anVDXtUWFhqjRK0Vb-RlkoxeUBLX3QLWWAez_TXQN41voBsySDYzx6ls56QBe8cTd4mcL6llzA_S7VNiqDr9KEeXRYI70bb5SmCjl9CpXR4TKEY9lrQM48ILIBuYxaEfUBiBrfFLIAMBNEgskEoTz1rT2erHjQs90ItzqvXSUGER_AbVTrIGo9zsn8qcSCYdHV4z2QMPo-GkI3YbVCHsKD3vlA7H3wzKMrzMMC9pQzD4jRUf5WSYfUuzoPJStT3ZJYfXzw-pbyjsZ42rBUegWizODQCEngQirZfulbv4VuDk57WEbbNQkPchmZQhIe1r-0XJ3Rv6pUj8D4rsBoE69J7SUUI6X2ZjvKsRtgFrPQ8oST9XietopA9bL6ZnoGp_XcvJnqopryoPBp7fIrshLJB2yC3OFn_b47_X_eo8J5IdevfNdIT-Tyilyb4sjMFSRJCOLJ_4PpyJbBim0kw5PFyp25E6D5cBwHJGTCCgqR4tqT96_oIRx1TiaefdENV74iIh8hl3Tha6pPSAJ3OqdmaO90yv57fZ8a15XHXdiwsP_25s9SfwkkACIJ9g4bAudFNXQRvR9tPt--90xxbYCQDwDUPVesLQ76DvM0zZT9MDJV9mzhbAJx5-7kzCrs1nHUPLCVZ7hndw7jN3ohc5acW_ixE8PxATRXn_qJoKufBznV5rL5T08_292nOvIGO79yPvXRu6rs5AdyZYbGnnC0GfopMDCzBYqX4wPtz2zHQct46ln8glYuvq3X_ipaAV90-pxHIR0nrXM9dG4uXFcFLzkLOxeOtS4NeaEY3HHFs0YA_VsxV-y1ofcqLM-mofaJb3RDQW6dLV5eo0TUEYFnyLvGh3muYvK4b5RwBIIXwqi7n6GMkrXQE8izkn_GfZmw2aG22fS2LUNDPSSDryvMxf0wo91SFZ6ONe6fm7v0cd9hxl-j9ng8MmjZr5MbzupMKlgNF1yVL88R32gKNVlu-byycl6G7llLdMWcd2V1PYMTr-5ltXXrK7arHDCiK8akImkknw7MEsjbjtAPNB1qGYHEWnbHk33PPnYL5K8NEXmjNV7OB67EPLOr2wVZS8FwChbG4qnFmI6LaS63-w-DTrcmLCtMBxb9pfB_JG1bNV_e34dheIvLMs4xqtLmLSyLd9S1yfu0BFJyL9-qurynOf7fL-ACpTkl_JyQt_b1ybrGqKZb5dtymY59Lpj2lqAmoem9YpibW9Ga8GSQA9TVne0mMT2OuoimWUbgxBUDWI7nVvOKz_qeXz64uAi7EANmUQhpvwqTlomrj6R7Q1XVfK9xogtL0tL1NpU6IY7V_xnxm-Avs5BO3DuuUd2t_h1Psd_zt57qvqc4-rFl6Vb57zVzR0Wav24EFZNh34Do7TjtqY3foxMFjaW_VhS_mO6mTUOzP56ILu6yI-2Pir-X8RvEHz_RSUnCKQp6qHIfMdpqEnKzD3X5JA1NV2nYdjX-DTtPuH824h29S5t4VYYaKh-nxnO1izrP1mCH4OlYbq9SCPHcvuBizVbF1pVzgAbNM0fpX424mIdTh3bB9DIsxzKLlSAsRFFkV0BkBIGZff36rXVu6dQP3GIRMXeRnzP4Hsz5JWbmSMT8HC-XQbgQBA5z4uzrfwC4FvWp.aI3ReA.LucdQ0zaHHtZrZSy6iOih-6u4YM'}
2025-08-02 11:51:05 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:51:05 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:51:05 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x0705D558>
2025-08-02 11:51:05 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:05 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:05 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:51:05 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:51:05 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:51:05 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:51:05 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:51:05 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:51:05 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:51:05 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:51:05 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:51:05 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:51:05 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:51:05 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:51:05 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:51:05 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:51:06 - managers.commands_server - DEBUG - Request completed in 1.88s with status 200
2025-08-02 11:51:06 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.738541841506958, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:51:06.368970'}, 'success': True}
2025-08-02 11:51:06 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:51:06 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:51:06 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:51:07 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:51:07 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:51:07 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:51:07 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:52:25 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 11:52:25 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 11:52:25 - auth - INFO - Token[expires_in]: 3599
2025-08-02 11:52:25 - auth - INFO - Token[scope]: https://www.googleapis.com/auth/userinfo.email openid https://www.googleapis.com/auth/userinfo.profile
2025-08-02 11:52:25 - auth - INFO - Token[token_type]: Bearer
2025-08-02 11:52:25 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjEwNDU2NTQxNjgyOTg2NDMwMjU1OSIsImVtYWlsIjoibm9hc2hwaXJlcjZAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJ5eDNUZE42MWd6WUNlX2NBeDVfWS1BIiwibm9uY2UiOiJoZ1pyYXlMTVJGVXVpdk5aQkJndCIsIm5hbWUiOiLXoNeV16LXlCDXqdek15nXqNeoIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0pVVDlkU0dyRWxTb3h3VWdtUlo2YThHM1JkV1lSZVlSWlVYSHRnUG5wZmxsVlFyQT1zOTYtYyIsImdpdmVuX25hbWUiOiLXoNeV16LXlCIsImZhbWlseV9uYW1lIjoi16nXpNeZ16jXqCIsImlhdCI6MTc1NDEyNDc0NCwiZXhwIjoxNzU0MTI4MzQ0fQ.qXt5yxpqMZOThq3FClBjBs_uaDi7joftX_SaGI95nnWz-sLHD6-GXgif2Toto2lXU77ePEShGNynA4wWuOsW-xE2aCkV2aBYK_vWH1im_n9Nrffbmk1lX9_BlcXLbV-pePL1LfVcR57ZygAYfJuwSwuqGSZNuWZ9d0O51hExRBTf_HIFO8TueI1yM3-R_ANevWOBvPk4Usx1CrVNMwRUQke1nCmzk-iEKhndvirfS1r3G0AvvKA9MExgwTtFJSl7SSIcKtnlFW1OscwxtobDVO_3__mP0SkQgcAEFzGLvKDq_4RoT4X4v0c1EqAT79udgSNd5AqiHFjYl6JHS1b2uQ
2025-08-02 11:52:25 - auth - INFO - Token[expires_at]: 1754128344
2025-08-02 11:52:25 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '104565416829864302559', 'email': 'noashpirer6@gmail.com', 'email_verified': True, 'at_hash': 'yx3TdN61gzYCe_cAx5_Y-A', 'nonce': 'hgZrayLMRFUuivNZBBgt', 'name': ' ', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocJUT9dSGrElSoxwUgmRZ6a8G3RdWYReYRZUXHtgPnpfllVQrA=s96-c', 'given_name': '', 'family_name': '', 'iat': 1754124744, 'exp': 1754128344}
2025-08-02 11:52:25 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 11:52:25 - auth - INFO - Google 2FA detection for noashpirer6@gmail.com:
2025-08-02 11:52:25 - auth - INFO -   Used 2FA: False
2025-08-02 11:52:25 - auth - INFO -   Method: none
2025-08-02 11:52:25 - auth - INFO -   Confidence: low
2025-08-02 11:52:26 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:52:26 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:52:26 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:52:26 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVmmvozgW_SulfO68h9kSSmppyJ48II990UiIGAMmbGEPrfrvY1LdXTVSSzUf5ovl2Nfn3nt84sMfC79CdR4UqGgXX9u6Q78tugbVi69_LAIIUdP4bXlHxeLr4hnQwptIiTpz4pXJKZPWO0jcZzHakaKZK1bAFt42RicluzOkntxyFCSV6tTM9C_T2muRwAraXhIuB5EqHh-HNMya-4jX6wTp_tns65oqT5RxWTux7WKaLR-lMvmAbVY4sj-TZYxZRXcknY6uRhBcc8NXxm7dtAFot8vM0bBnZwaq6-0-F0SXuaS5ncG4kLjL_jP0YITqEMUSaCp30LZUsI3dD9G766Lm6gf1dHRoGWusqKoQU3R_cVWscfsEleNA0RS_-G2BxgrXqPEDQhRYcSyg1wzL_ljHhCSGE4TfFjj8mzT0vCS3I8RXfNHN6QwUfG7OeVt52zN_zrW7YsiDbJwH5eilsq3SrrG5K2mSKlM8uYYMXFrm3Gk_uOkZeMYhV457LG0vFHLEGfPDAiqO1DeSpoKMPC-V4Ukb4FT2En1IXVoAt0KbpDzsb3TYeDqX3mhqhkhQMUOcR3lnTlcjHuR0Pyk7mZUckQoKj1Z2YS3TYesyVurNJeYUCByXdemEko_hAO0ESPlhgCe582ih9-gxCx0lg7nSk5zZrVA7kr894wG7jnU_pyWWDRHI052VdyTvpE7XLSCtV3SYqkwwKcXNVkjL5lPeea1iZ_T1qJThblPA06EMdS6Bp82PXhxr8pwL6YejPJujpDmvTugtCAYm9Kb7QdmZtGKoo5LGT9Ij6YnQnZrgOsflVuvaWTPXdcuFBNLJEDiXDKae6NEgCezh7_o9e_49RmFuPQPbqzxbxddCe4a2SXAOlEMn5Hw888-hnWJ6e5aW7ZC3TSVzaGWDdlZk62AzY5FcBNd83ZUHqqfrZLJhXY6WY1XhnQvU-6UIt3N9XHKz5zjJKRVkAV5ysu3OeYToDrjCeSionPHgMUvDk_X09FlSCRUSjq543d-O8S-4EhKJOuy8KeldqrKsXXY3qfCp2aNxYxLGssPWzEoiyeQkg8vdApnuWZluZ5arn7TCPHKDl4-NlR2eqgGIhtzWfc51hxXhqXPof6p_3vfIetYgi_Bgg2zmH_CFUynIA3zqPF4xWUI44GUDAmW3fyo7SClbcg9OMpD4UZlMivxtWKIhisj_4bTcc6wesnc1kgdz2GabdNP4XbDDq7SMWsfXg-NZ4IrCnpaNdNrxy6MT44g2yrakM8dcrdDnXk-OyrMQ2cHuro29HPd0sL1bdLBxP_zePgGc-4Wg1FF0y-8gcwR_k0FHulnLCn1KQIosqHEr7xmLbnTpBn3oHkfdUzrbE0LqyoFkP2obI_JP58N1bXToDJ4ys9R8UUG9fd30n3fWbEawrS1FHjRTvSNQbPPpvsT7j6QIe1xHOqiZIyX2_YcoyPsxHoz2cNGzla6f4UdbZAcbXBs4jG1521lXn_H9_JPS72oMxf1hOkr9x-7hs1ppsA7bUxDsH6KxErow1pWQEx_4RF6MjL-cdHCjO5W8eQ0sK0SesaRtq-br-_swDG9xWcYZCircvMEyfw-6NnmfLQMXUfmG8gBnX8ihAodf_udTVV1GOEMk4evd9NvnK-sGBTWxou-ONAe-XKn1k6BJZkMaGSNUeEBeyi3yoThyvrsUSXjQhWQbUBwjrCkaMCyzXlZs2vfs6s7EOewgIk96zuF-DZOWiqtH0r0FVdX8WeWcDpZFSzxxLnZGnKr_M-KLKIJZlKSZ2UBq_l_xvPbzvt-TviOMwr-smXjNf5tPFOQ4e_pFkM-E_bujOCS8RnYew-_z9feRoMa4J_T-HE294rjXnH7NWRKHf5gcu5rz4Kb5SQbky6Dsivav7v4s-RewX35ZXVEW8KW22KuDpyRrB7PDveJtNnFLtisM267-WY5Zwvwzwe_Bu7iN1yW8mIYQ6sd6n-nEyc041zw-WB8ZLbRdDbmaZzqnNv4sqijLLLUWf28Efgln5Xe3142zHE9Y4Ne0sOZZhqI5Tlh8-_Zdkj6edQZXAiXwQbS8QU5YshHFLtchXC95jgkCyPIMw6HFt_8AjzckKg.aI3Ryg.VWGsDKIM-cy17PhR7a90v_3dIxY'}
2025-08-02 11:52:26 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:52:26 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:52:26 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x070675E8>
2025-08-02 11:52:26 - endpoints.settings - INFO - User ID from session: c79096af-bc59-4f04-8dc8-653aac46335e
2025-08-02 11:52:26 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=c79096af-bc59-4f04-8dc8-653aac46335e
2025-08-02 11:52:26 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:52:26 - services.settings_service - INFO - Input parameter - user_id: c79096af-bc59-4f04-8dc8-653aac46335e
2025-08-02 11:52:26 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:52:26 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:52:26 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=c79096af-bc59-4f04-8dc8-653aac46335e, setting_key='routerId')
2025-08-02 11:52:26 - services.settings_service - INFO - No UserSetting record found for this user
2025-08-02 11:52:26 - services.settings_service - INFO - This means the user has never saved a router ID before
2025-08-02 11:52:26 - services.settings_service - INFO - Checking UserRouter table for additional verification...
2025-08-02 11:52:27 - services.settings_service - INFO - Found 0 active UserRouter records for user
2025-08-02 11:52:27 - services.settings_service - INFO - === get_router_id_setting completed - no routerId found ===
2025-08-02 11:52:27 - endpoints.settings - INFO - Service call completed - result: None, error: No routerId found for user
2025-08-02 11:52:27 - endpoints.settings - WARNING - Service returned error: No routerId found for user
2025-08-02 11:52:27 - endpoints.settings - INFO - No router ID found for user c79096af-bc59-4f04-8dc8-653aac46335e - this is normal for first-time users
2025-08-02 11:52:35 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 11:52:35 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 11:52:35 - auth - INFO - Token[expires_in]: 3599
2025-08-02 11:52:35 - auth - INFO - Token[scope]: https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email openid
2025-08-02 11:52:35 - auth - INFO - Token[token_type]: Bearer
2025-08-02 11:52:35 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJLbDRzVUZvQUk2QjFWRWNJSl9Wbml3Iiwibm9uY2UiOiJaSWxXMGdhMDJUdEJNYnc2QWlMVyIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI0NzU1LCJleHAiOjE3NTQxMjgzNTV9.d_kY6OOytRiZSuX66lcD14RPNect53-7TIz8FOW3IyTewUEHKYUhma3uOvTYa1DmDcsGMYdKA5xeSEkSX0grvbYakG-egTpF3BekUEv-gUEzk3mWxb5ZOiVlh-dEt7VRWdX1sxy6KOI1yWwYRvD0K4P2Rkc9B1QpPJSUY_afkdEPSaFwbW_G1KJE0uUISZwT1wGQZ5FA1byuxNVi2wC4QDhoGgHjLOlD5PRovXXQZ-rEGDAbLY0labGIqi9jwf-q-l-eZ-yGhYIl5KkcYTALcrGylBdJTQ0DRtBXsHYoQ2YM8arBvPLPOfGiRmeiL5MNmHgvoQ36SxCgrUsIlpET_w
2025-08-02 11:52:35 - auth - INFO - Token[expires_at]: 1754128354
2025-08-02 11:52:35 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': 'Kl4sUFoAI6B1VEcIJ_Vniw', 'nonce': 'ZIlW0ga02TtBMbw6AiLW', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754124755, 'exp': 1754128355}
2025-08-02 11:52:35 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 11:52:36 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 11:52:36 - auth - INFO -   Used 2FA: False
2025-08-02 11:52:36 - auth - INFO -   Method: none
2025-08-02 11:52:36 - auth - INFO -   Confidence: low
2025-08-02 11:52:37 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:52:37 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:52:37 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:52:37 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuo8gS_ZWS18W9kAw2JbXU2AzGNtjMw8ZKBjMPNmAMpfr3Tm5VV109vcVbvBUiMvPEOScjI76vrm38qGAd1_3qW_8Y4q-roYsfq2_fVzAM46679k0R16tvqwkC9g3inEHuGXVKk_0pNtrbpUl2dL3Pg1lpPNrkZoBNjyLE6LvrsMBzqetGbLnjMJX38KrA2BkgdzB2A2PcmZe1ze8iJUtFBNhoGOVWS039SOy30THa-yzPyObx8Vir2phu1XR93wksdKSJ37DUkd37pfRUN7cI6zlb4lI9MIPikrhyctgkuxzuEu_I6RuD02VD1PaSC5SM4AvnuOvujFlZ3NkGag70isOJNb36uopfbfaIuytETqAIRYANSVN_4hlygaRZ9usqi367Ek-HNJDC7JwdDGuWCTWTO7nqW38nM3KlF6qpjIopj6rk54qjAc_cFmqe5uqczJ6pEB5QaG8WRi-XCd8UK1USstPugMcut2AebULLbtobStOGpLKEmmivj-HcPE9AzD3AEkGtz6cqegYg6nyDzgOALxBpXC8Q8kvhrflsJqOSC7PKK9TJ5XBY-0Dlo4cCot4j7dxfKFY4AV2P8kCKK1I0hk5KnCpxDPfK4AP26YNXGblqGVbqE-Usg1obUP5ezsbMc-1CzptMMTlCmQtK4VHeWZvPOwJJb0GUaySc1TpwVCTZmhTe71WnBGdJbSJ-W4d7sYkMOg332z9aXHv23QPSQ-O-Q-OnJa-B7K0RRobszQWUQxjVPCFU06PPZvE68zKN9BLKbrkGu_ecslt4IU1lUPmIuzhFZsr5gEihM_7m7zvL_-sWVfYEHb_1HS071_oUORbCEXEXpGkIksX_U8Drs235T80qgJaLju6oB6NknaAqyQUrqFiEay17oeG8XORlqvAHKxIOqleHQHNKxZ4WfnQaOB_7cijZgyz94vehcdt6pE6ElfUfd_5qlImuA8DWgWQTIbAnpGGI0Plo93H3T89gtxoIqQCoiuewD5NUfRt_GUZG3LX8IHoWfTEAKziCmKN30Nv2oQws-RVKhGDjfqdUImmKpRkXAhvOBTg5ylJPNXT9MiiRNocof3v6Ue4-0lF2sf1nzUc-eu6BWPyAjoij2EudLRw9BRx9CYRXxntUn7lAqqb2UvJkVk2bfYuuhcecz1OvZ74xuAxThjxB6Rc1DnuaxNamPG_Es0PKkxmPlrA_elZaQXI4P00PEnzFh52keNGRo1-xIRSGiyePZ-DBQsLixGxFchsXlvDEEkuYC7JyXgHtnzO7TLFI6Ne27kQu0b0m5niWickZPf3J40fqAvQiZLeE1l7QM_eu8FZEwsWA4hg4V4k4HgR8sGTDH01ilDSfFjkimIaXamdg3FEanzZSss9P55KnL3rzdF3Nxx6CxHPBycNLGEjyPWPz8YbdsRKLfWySUk8u6WMReiZ3Ch_SVG6jg6nhvN5v3W7vNaiTKBv42D4vp8v5JmV6FWcnWlGrffJsNJIxXrvkgWq3bAXzOqLu1oVNG6OGlfZ92317fx_H8S1pmqSMYZt1b2FTvcOhT9-X7p_Vt-atfTS3rIy__M8H4gpm5ReUpc4ilPCjQ1776SPrNoYPNFV-Dpdl98eA6a8p7FK0fCypzhIbTma2hC2E8uFq19nCGg4RWiZwmmQ3OCBIitxgLZU_n9S6IJMqHMIY4ExFZ89NmPZ40t7T4Q22bfeL6pIubOoejbeF8YI4t_9nxA_dCDNEHfcWP-Bj2PydLLHP69cn0n3L4ujfKYumyqcxQ39d3WCVldO1htVi2E8gdDrJnsjGX9ElBYplf0YUtV7OZl336WrR4G6Guv-X8S8anyC-_Eavmzpcor5cOngCcWD2WyUYGS47OWi5zcJ-eHwumzIl_7sR7_Cd2yWbJjzBpjh3nnPSD1i-BQJUz8eGd7lQjTFLj6st0Va8I5YAjifPmLm_OpbBwqVCh2C5GYIkcGZD0wzLssQGsDhN46sfP36WzjVb6oFkmAi_sRSGx7cAo9YxjkE2prB4vQ5ChqbJmGRXP_4B4tnz1A.aI3R1Q.Ht1lcDiew-wSLEBR2Od1iGUXiZ8'}
2025-08-02 11:52:37 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:52:37 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:52:37 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x07073780>
2025-08-02 11:52:37 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:37 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:37 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:52:37 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:37 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:52:37 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:52:37 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:52:37 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:52:37 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:52:37 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:52:37 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:52:37 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:52:37 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:52:37 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:52:37 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:52:37 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:52:37 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:37 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:52:37 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:52:37 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:52:37 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:52:38 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:38 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:52:38 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.9325485229492188e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:52:37.666042'}, 'success': True}
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.0265579223632812e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:52:37.728008'}, 'success': True}
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:52:38 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000946044921875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:52:37.817069"
  },
  "success": false
}

2025-08-02 11:52:38 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000946044921875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:52:37.817069"
  },
  "success": false
}

2025-08-02 11:52:38 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000946044921875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:52:37.817069"
  },
  "success": false
}

2025-08-02 11:52:38 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:52:38 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:52:38 - managers.commands_server - DEBUG - Request completed in 0.15s with status 400
2025-08-02 11:52:38 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0006902217864990234,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:52:37.874070"
  },
  "success": false
}

2025-08-02 11:52:38 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0006902217864990234,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:52:37.874070"
  },
  "success": false
}

2025-08-02 11:52:38 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0006902217864990234,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:52:37.874070"
  },
  "success": false
}

2025-08-02 11:52:38 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:52:38 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:52:39 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:39 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:52:39 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:52:40 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:52:40 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:52:40 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:52:40 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuo8gS_ZWS18W9kAw2JbXU2AzGNtjMw8ZKBjMPNmAMpfr3Tm5VV109vcVbvBUiMvPEOScjI76vrm38qGAd1_3qW_8Y4q-roYsfq2_fVzAM46679k0R16tvqwkC9g3inEHuGXVKk_0pNtrbpUl2dL3Pg1lpPNrkZoBNjyLE6LvrsMBzqetGbLnjMJX38KrA2BkgdzB2A2PcmZe1ze8iJUtFBNhoGOVWS039SOy30THa-yzPyObx8Vir2phu1XR93wksdKSJ37DUkd37pfRUN7cI6zlb4lI9MIPikrhyctgkuxzuEu_I6RuD02VD1PaSC5SM4AvnuOvujFlZ3NkGag70isOJNb36uopfbfaIuytETqAIRYANSVN_4hlygaRZ9usqi367Ek-HNJDC7JwdDGuWCTWTO7nqW38nM3KlF6qpjIopj6rk54qjAc_cFmqe5uqczJ6pEB5QaG8WRi-XCd8UK1USstPugMcut2AebULLbtobStOGpLKEmmivj-HcPE9AzD3AEkGtz6cqegYg6nyDzgOALxBpXC8Q8kvhrflsJqOSC7PKK9TJ5XBY-0Dlo4cCot4j7dxfKFY4AV2P8kCKK1I0hk5KnCpxDPfK4AP26YNXGblqGVbqE-Usg1obUP5ezsbMc-1CzptMMTlCmQtK4VHeWZvPOwJJb0GUaySc1TpwVCTZmhTe71WnBGdJbSJ-W4d7sYkMOg332z9aXHv23QPSQ-O-Q-OnJa-B7K0RRobszQWUQxjVPCFU06PPZvE68zKN9BLKbrkGu_ecslt4IU1lUPmIuzhFZsr5gEihM_7m7zvL_-sWVfYEHb_1HS071_oUORbCEXEXpGkIksX_U8Drs235T80qgJaLju6oB6NknaAqyQUrqFiEay17oeG8XORlqvAHKxIOqleHQHNKxZ4WfnQaOB_7cijZgyz94vehcdt6pE6ElfUfd_5qlImuA8DWgWQTIbAnpGGI0Plo93H3T89gtxoIqQCoiuewD5NUfRt_GUZG3LX8IHoWfTEAKziCmKN30Nv2oQws-RVKhGDjfqdUImmKpRkXAhvOBTg5ylJPNXT9MiiRNocof3v6Ue4-0lF2sf1nzUc-eu6BWPyAjoij2EudLRw9BRx9CYRXxntUn7lAqqb2UvJkVk2bfYuuhcecz1OvZ74xuAxThjxB6Rc1DnuaxNamPG_Es0PKkxmPlrA_elZaQXI4P00PEnzFh52keNGRo1-xIRSGiyePZ-DBQsLixGxFchsXlvDEEkuYC7JyXgHtnzO7TLFI6Ne27kQu0b0m5niWickZPf3J40fqAvQiZLeE1l7QM_eu8FZEwsWA4hg4V4k4HgR8sGTDH01ilDSfFjkimIaXamdg3FEanzZSss9P55KnL3rzdF3Nxx6CxHPBycNLGEjyPWPz8YbdsRKLfWySUk8u6WMReiZ3Ch_SVG6jg6nhvN5v3W7vNaiTKBv42D4vp8v5JmV6FWcnWlGrffJsNJIxXrvkgWq3bAXzOqLu1oVNG6OGlfZ92317fx_H8S1pmqSMYZt1b2FTvcOhT9-X7p_Vt-atfTS3rIy__M8H4gpm5ReUpc4ilPCjQ1776SPrNoYPNFV-Dpdl98eA6a8p7FK0fCypzhIbTma2hC2E8uFq19nCGg4RWiZwmmQ3OCBIitxgLZU_n9S6IJMqHMIY4ExFZ89NmPZ40t7T4Q22bfeL6pIubOoejbeF8YI4t_9nxA_dCDNEHfcWP-Bj2PydLLHP69cn0n3L4ujfKYumyqcxQ39d3WCVldO1htVi2E8gdDrJnsjGX9ElBYplf0YUtV7OZl336WrR4G6Guv-X8S8anyC-_Eavmzpcor5cOngCcWD2WyUYGS47OWi5zcJ-eHwumzIl_7sR7_Cd2yWbJjzBpjh3nnPSD1i-BQJUz8eGd7lQjTFLj6st0Va8I5YAjifPmLm_OpbBwqVCh2C5GYIkcGZD0wzLssQGsDhN46sfP36WzjVb6oFkmAi_sRSGx7cAo9YxjkE2prB4vQ5ChqbJmGRXP_4B4tnz1A.aI3R1g.2GyuNEDGf1NG03vHdbbpF0Bl72c'}
2025-08-02 11:52:40 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:52:40 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:52:40 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x0707C5B8>
2025-08-02 11:52:40 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:40 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:40 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:52:40 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:52:40 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:52:40 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:52:40 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:52:41 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:52:41 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:52:41 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:52:41 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:52:41 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:52:41 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:52:41 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:52:41 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:52:41 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:52:41 - managers.commands_server - DEBUG - Request completed in 1.96s with status 200
2025-08-02 11:52:41 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7981417179107666, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:52:40.668758'}, 'success': True}
2025-08-02 11:52:41 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:52:41 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:52:41 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:52:41 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:52:41 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:52:41 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:52:41 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:55:04 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:55:08 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:55:24 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 11:55:24 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 11:55:24 - auth - INFO - Token[expires_in]: 3599
2025-08-02 11:55:24 - auth - INFO - Token[scope]: https://www.googleapis.com/auth/userinfo.email openid https://www.googleapis.com/auth/userinfo.profile
2025-08-02 11:55:24 - auth - INFO - Token[token_type]: Bearer
2025-08-02 11:55:24 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiI1TnB0eU9zS2JNZmpCZ3FUd3NvR2NRIiwibm9uY2UiOiI2enZ3bEtOVGxxa3dxcVhTWTdLQiIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI0OTIyLCJleHAiOjE3NTQxMjg1MjJ9.PgJ44i6wdn-Nm8c8llWn7pZlKl7s6ApDDiJOJGXVlnDRM4UvugVrQPUzLj4_y-pfiF8-7u_b5NEHbchS-ydjKSDrzH31Dy7rPfZAIM3GpRq5u9ZMLKl9liAWZnMt_xlKm9Kg0gXRyg8YHcWH5CsK6drhwC0e61d7IojoYsa4FYqXwgSq6qTUjwSoZTvWRt5HWQCMxmj8KqIGdr-3bk5xygtCM6HZhwgXq2qtEKK05gEmEvhJqAPjbTo_kZ_R2ZdpUINbuv28H07pCUYe4lII76BZLaWkxYQ1zeRn_FdEkOQYJURc19GgXnqwkja3CLL3IZ6waGEDLSJWyVtaUMt8xQ
2025-08-02 11:55:24 - auth - INFO - Token[expires_at]: 1754128522
2025-08-02 11:55:24 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': '5NptyOsKbMfjBgqTwsoGcQ', 'nonce': '6zvwlKNTlqkwqqXSY7KB', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754124922, 'exp': 1754128522}
2025-08-02 11:55:24 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 11:55:24 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 11:55:24 - auth - INFO -   Used 2FA: False
2025-08-02 11:55:24 - auth - INFO -   Method: none
2025-08-02 11:55:24 - auth - INFO -   Confidence: low
2025-08-02 11:55:26 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:55:26 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:55:26 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:55:26 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcey20oO_RWX1ta9ZDNIdNVUjQKTRFKXOWxUDC3mIAYxvPK_T_Paz_ZMzWIWsyTQOMA5AIG_NvcGtqVfwarffOvbAX7dDB1sN9_-2vhhCLvu3tc5rDbfNrMPmDcfO-iEQCsL9VR39gnmqaWMnEJotVBZtycePJyhifKqi4So2Ub9IAm9afK8DanCWm5j2wyc1GfXaNmyfQowKsgfezsSG7jrJnM5hEoj3anCmZQSyA2jNpBcMMCKlcIuu4_dZTirlVb4-1IWpWFLpu0z7hNN6NSda_eieq5aoMxxOL4G_xS710O01w-aqHOqwDtATvXpMNCdYvqXidmCcDDng1CMGL6jNl83cGrSFnZ3HymBLCQO9hQAv-0pUoGgGObrJo1-qQLnSxLwYXpLL7q5iLiSip1Y9o13Emmx1HLFkEfZEEeF9zLZVoFrHHMlSzJliRfXkHEXyJS7sKObibhncKXCs6l0umDQOayYVwtX04f6htI0ISGvpjoStDFc6pcEuMwFDB5U2iKV0SsAUefpVBYAbIVIYLVCiJN8NpebEY9yxi7KWSYl54D5lQeUc9TKIOpdwsq8tcQSw33HJV2QYDIfjaGd4FLJjaEgDx5gXh6YishRirBUXihnEVTqgPL3YjqmrmPlYlansnHA5SUn5TPKu6jL7YQj6g2IMpXwF6UKbAVRNmf57PWKXYAbr9TR-ViFAldHOpWEwvE3F8daPOeC-FCYZ1OYtObVkbwVwkiRvBmLcrCjksW4YrjUzcin21mkEF9cPq1tsHrXLrq1LsSpCEoP1c7NkZEcPIAnvj3-qt-z1-_pEZXW7Nte49lqequ0ObJNhMNhDkiSEMSrnrhRHTFoMosOLopXNieP4MyIUF4aULQVKygZhGuubwGsPCJg-5vFT5NPRFNoJYZtRJL6OSZUEtjru0vm89Yg8j_r--R4bFxCw8PS_I-eT7U8U1UAmCrgLTwE1ow4DBGKj06fvX-5OnNUQUgGQJFdm2kNQvEsbNL1FH-q2YVzTepDBwxrs1xmlGZvWZciMMUp5HHWwrxOLjnC4AoD5iwTLjmQbHmdp8p3vCIoEDcbL35p-snDQzyKDlq_fR7S0XUu-KqHb3MYsk3KYmLoV8BuhjgjvAIKaD4zllAMdZJRD-Xswrx9xBeSTOkxqrZKuQ_3RWFXu8YrrsWuow_N-ZxebhfesYrqrMmk-Rpiq1U_zEXKyPu8bR4pt9_uhntAKawQhIm-naPsqp_bRSDw87xrPx7eQZQJvtGe1MB4snQtmCI92F4l9_epuJbMNcZiR5vjvSuEtkCduisdtcl4wiCNRzuxzmq380nOfTpjrD_pp2Fmo157xsvWekqw1ZM8ldn--hT5qN0SQU5Nc9yfZFrwkjF2nuDZs9crRsVsyb6Sy_PwkQVGfc-9uwa8qDFFJRheYC9gu-ZkupAsRHFHHz3Jt_PJVfEFatWdi9j8proXUwtxho-d6jnmmU-cJIkQPXr0efYs6Rd7tnrflPv9pKLt1oV1A9HCSvq-6b69v4_j-BbXdVxAv0m7t7Au3_2hT97X7Z9Wj_oNln5afEFBVRp9-Z-jmrZ-pAVECT835L2fP7Meod-iq_LjuKwPPw9Mf0_8LkFuSmn6-dZdA_mRHeOnMXY1H65V-0OE3DhGEcweAzhBEvttQ2avF7nLibgMhxACjC6p9LUPkx6Lm2cyvPlN0_2sck0X1lWPztta7Iq4NP9nxE-hEGaINu4Dtn477P8Zr7Y__fcX4v1IYfT3lUVX5d_PzMMv02K-V365CvYDCEXH6QvJ-NO6pkC29PeJIpk1Nu26P1qLDnc9VP3fFf8s4w-IL7_Qq7oKVyu9vMbiqhjFMx-fT0d3d9cjcjdp2A_tn2NTJMR_F-Ldfz-c4n0dSn6d3zrXlrTLNjsC1ldu1_rsoNMOt6YGyyPelGebK4A_Sq6-HP7RMfQ2XCd0CNbO4ASO0XuKohmGwfeAwSgK23z__mN07uk6DwRNR9iDIbcYfARbcgexrc9Acgt3uyCkKYqABLP5_i98G_mh.aI3Sfg.nujoEEeTdIzoiFsIJF0kd1f1C5g'}
2025-08-02 11:55:26 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:55:26 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:55:26 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x067104B0>
2025-08-02 11:55:26 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:26 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:26 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:55:26 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:26 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:55:26 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:55:26 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:55:26 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:55:26 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:55:26 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:55:26 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:55:26 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:55:26 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:55:26 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:55:26 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:55:26 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:55:26 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:26 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:55:26 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:55:26 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:55:26 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:55:27 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:27 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:55:27 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Request completed in 0.20s with status 200
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.0002522468566894531, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:55:26.621070'}, 'success': True}
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.86102294921875e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:55:26.720143'}, 'success': True}
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:55:27 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0032618045806884766,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:55:26.800635"
  },
  "success": false
}

2025-08-02 11:55:27 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0032618045806884766,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:55:26.800635"
  },
  "success": false
}

2025-08-02 11:55:27 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0032618045806884766,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:55:26.800635"
  },
  "success": false
}

2025-08-02 11:55:27 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:55:27 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:55:27 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-02 11:55:27 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008089542388916016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:55:26.871702"
  },
  "success": false
}

2025-08-02 11:55:27 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008089542388916016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:55:26.871702"
  },
  "success": false
}

2025-08-02 11:55:27 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008089542388916016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:55:26.871702"
  },
  "success": false
}

2025-08-02 11:55:27 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:55:27 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:55:28 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:28 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:55:28 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:55:29 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:55:29 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:55:29 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:55:29 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcey20oO_RWX1ta9ZDNIdNVUjQKTRFKXOWxUDC3mIAYxvPK_T_Paz_ZMzWIWsyTQOMA5AIG_NvcGtqVfwarffOvbAX7dDB1sN9_-2vhhCLvu3tc5rDbfNrMPmDcfO-iEQCsL9VR39gnmqaWMnEJotVBZtycePJyhifKqi4So2Ub9IAm9afK8DanCWm5j2wyc1GfXaNmyfQowKsgfezsSG7jrJnM5hEoj3anCmZQSyA2jNpBcMMCKlcIuu4_dZTirlVb4-1IWpWFLpu0z7hNN6NSda_eieq5aoMxxOL4G_xS710O01w-aqHOqwDtATvXpMNCdYvqXidmCcDDng1CMGL6jNl83cGrSFnZ3HymBLCQO9hQAv-0pUoGgGObrJo1-qQLnSxLwYXpLL7q5iLiSip1Y9o13Emmx1HLFkEfZEEeF9zLZVoFrHHMlSzJliRfXkHEXyJS7sKObibhncKXCs6l0umDQOayYVwtX04f6htI0ISGvpjoStDFc6pcEuMwFDB5U2iKV0SsAUefpVBYAbIVIYLVCiJN8NpebEY9yxi7KWSYl54D5lQeUc9TKIOpdwsq8tcQSw33HJV2QYDIfjaGd4FLJjaEgDx5gXh6YishRirBUXihnEVTqgPL3YjqmrmPlYlansnHA5SUn5TPKu6jL7YQj6g2IMpXwF6UKbAVRNmf57PWKXYAbr9TR-ViFAldHOpWEwvE3F8daPOeC-FCYZ1OYtObVkbwVwkiRvBmLcrCjksW4YrjUzcin21mkEF9cPq1tsHrXLrq1LsSpCEoP1c7NkZEcPIAnvj3-qt-z1-_pEZXW7Nte49lqequ0ObJNhMNhDkiSEMSrnrhRHTFoMosOLopXNieP4MyIUF4aULQVKygZhGuubwGsPCJg-5vFT5NPRFNoJYZtRJL6OSZUEtjru0vm89Yg8j_r--R4bFxCw8PS_I-eT7U8U1UAmCrgLTwE1ow4DBGKj06fvX-5OnNUQUgGQJFdm2kNQvEsbNL1FH-q2YVzTepDBwxrs1xmlGZvWZciMMUp5HHWwrxOLjnC4AoD5iwTLjmQbHmdp8p3vCIoEDcbL35p-snDQzyKDlq_fR7S0XUu-KqHb3MYsk3KYmLoV8BuhjgjvAIKaD4zllAMdZJRD-Xswrx9xBeSTOkxqrZKuQ_3RWFXu8YrrsWuow_N-ZxebhfesYrqrMmk-Rpiq1U_zEXKyPu8bR4pt9_uhntAKawQhIm-naPsqp_bRSDw87xrPx7eQZQJvtGe1MB4snQtmCI92F4l9_epuJbMNcZiR5vjvSuEtkCduisdtcl4wiCNRzuxzmq380nOfTpjrD_pp2Fmo157xsvWekqw1ZM8ldn--hT5qN0SQU5Nc9yfZFrwkjF2nuDZs9crRsVsyb6Sy_PwkQVGfc-9uwa8qDFFJRheYC9gu-ZkupAsRHFHHz3Jt_PJVfEFatWdi9j8proXUwtxho-d6jnmmU-cJIkQPXr0efYs6Rd7tnrflPv9pKLt1oV1A9HCSvq-6b69v4_j-BbXdVxAv0m7t7Au3_2hT97X7Z9Wj_oNln5afEFBVRp9-Z-jmrZ-pAVECT835L2fP7Meod-iq_LjuKwPPw9Mf0_8LkFuSmn6-dZdA_mRHeOnMXY1H65V-0OE3DhGEcweAzhBEvttQ2avF7nLibgMhxACjC6p9LUPkx6Lm2cyvPlN0_2sck0X1lWPztta7Iq4NP9nxE-hEGaINu4Dtn477P8Zr7Y__fcX4v1IYfT3lUVX5d_PzMMv02K-V365CvYDCEXH6QvJ-NO6pkC29PeJIpk1Nu26P1qLDnc9VP3fFf8s4w-IL7_Qq7oKVyu9vMbiqhjFMx-fT0d3d9cjcjdp2A_tn2NTJMR_F-Ldfz-c4n0dSn6d3zrXlrTLNjsC1ldu1_rsoNMOt6YGyyPelGebK4A_Sq6-HP7RMfQ2XCd0CNbO4ASO0XuKohmGwfeAwSgK23z__mN07uk6DwRNR9iDIbcYfARbcgexrc9Acgt3uyCkKYqABLP5_i98G_mh.aI3Sfw.4ulL7KDPwrIEdp2zxgxp0JYhPgE'}
2025-08-02 11:55:29 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:55:29 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:55:29 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06BB3270>
2025-08-02 11:55:29 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:29 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:29 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:55:29 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:55:29 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:55:29 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:55:29 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:55:30 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:55:30 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:55:30 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:55:30 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:55:30 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:55:30 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:55:30 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:55:30 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:55:30 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:55:30 - managers.commands_server - DEBUG - Request completed in 1.93s with status 200
2025-08-02 11:55:30 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7912557125091553, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:55:29.669196'}, 'success': True}
2025-08-02 11:55:30 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:55:30 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:55:30 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:55:30 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:55:30 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:55:30 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:55:30 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:57:22 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:59:11 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:59:14 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 11:59:28 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 11:59:28 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 11:59:28 - auth - INFO - Token[expires_in]: 3599
2025-08-02 11:59:28 - auth - INFO - Token[scope]: openid https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email
2025-08-02 11:59:28 - auth - INFO - Token[token_type]: Bearer
2025-08-02 11:59:28 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJjNlJMVjctM041RUlFM3NmcjdoWGxBIiwibm9uY2UiOiJySmo3RGw2VkxUY29Nd3NDa2tCRyIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI1MTY3LCJleHAiOjE3NTQxMjg3Njd9.BFAcMDUW7UHnfGveuVo-Jcrm_5QHJSYa12rudldJvY6NqBIzTYrhGNNGmcfruBEgYfYcAkCFxpUKXm49r1LRqmioy3dATEvAtE4y_z-wAsWGI_M8PdqKf0Z_AfU-Vzy7s0PsI6pMcIcRgC4DJTRFKMhZCX_Spokbu7o-bSDGzAOlgoskZM1-5ocmcIS-8XLujB_sF2_sfSBqUkOz0EQ2UsQJTg3oBHFVs4Sbeo5vM8jc83eqT9JUrMPIzH2KBr6_IRYLW5nm0bHDoE_qCYIlc8Z4tQNB80QiPQ267__he1Mme8vmMUBM9zRgNHMX55O5a7weUaHN3FBlJIhnMjbVrA
2025-08-02 11:59:28 - auth - INFO - Token[expires_at]: 1754128767
2025-08-02 11:59:28 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': 'c6RLV7-3N5EIE3sfr7hXlA', 'nonce': 'rJj7Dl6VLTcoMwsCkkBG', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754125167, 'exp': 1754128767}
2025-08-02 11:59:28 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 11:59:29 - auth - INFO - ID Token AMR: []
2025-08-02 11:59:29 - auth - INFO - ID Token ACR: None
2025-08-02 11:59:29 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 11:59:29 - auth - INFO -   Used 2FA: False
2025-08-02 11:59:29 - auth - INFO -   Method: none
2025-08-02 11:59:29 - auth - INFO -   Confidence: low
2025-08-02 11:59:30 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:59:30 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:59:30 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:59:30 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmOq0oS_ZUnr6-rIAHbXKmlBhswLicum5mNBUmaeShm83T_vZO6Y7d60YveWCIi88Q5J8IZf6_uNW4Kv8Rlt_raNT3-supb3Ky-_r3yEcJte--qDJerr6unD_gXnxJ05rjRJkkd3_zMjA-PILL1J23I2Zu2LUf3CC5-SD_R87yeZnZK5gRXqo10030o1_pU9p1yxCX3wJJ1tPE0hhjfSlrYToL3zvfzOT3fVegcDsw0DJJc5C3_vCn-YMApxTS3mRwe5tFmEt9CZfTYbJQ2RRENz-kEXdphQYay82OM_A9_H7lvQsDqwk3V5etRcQBMLs4w18erwOxl3BXp5UCDCggUveVWX1Z4qpMGt3efOEEiLA122832dzwhLjAcz39ZJeEvV_DzFAcKSi7JSTdnldYStVWLrvb26kYtbplmwBEa6qgpXgrtK3ANMdPSONXmaHYNSLsAcu4sjW6q0p4hF5oiJef9icKOsGC-WfQ1eVxfSJkaMXAJVeHxNqK5Gs5ATl3A00F5m89FOAQgbD2dSwNALRAxLhcIdYIHc74Y0QhTadYOkD07AuWXHtAOYQNB2LmMlXoLxYKifcdlXRBTUAlHZMf0uZBHdIS9B_jBA1MeOlqOCm0gNfOgvPakfqcmY-I6VqamVQINgYZzxsIDqTtf58ueJtJrEKZXxp-1MrA1Itl8woPXaXYOLopWhQexREe5CnUuRkfxtxbHmj3nRPRwlGdz1HmpqxN7S4KREHtTidSQRi2NaM1wuYuRTZeDyhG9NNwvbbA6187bhRfRlAeFR7jLz9CIBQ_QsW-Pv_h79vI9PcLCevq2V3v2NbmUt2domwRHphwQxwhEi_-plp-glaIOUix9M3MZMlqB0rCylUlcsIKCJ7jmcvapFxVzU0ZgZZNJamkhox180O1vz4UfFwf257nUV6xeVX7w-9Qo1i5zo1Fh_kfPpwo-uTIAfBkoFo2A9SS4fUjuh_vP3g-uzotXgNgAaNC1-cZgNM-iJl1P6I9repJdk3vXAS_ZkpwahdlZ1ikPTHVCCi1ZlNfCQmYMOTdwJvFozsDZhss8lb7j5UFOtNl0_svTz3H3iI68xdbvnEd8dJ0Tvfjh2zJFYpM2mxT5K9DQcBmCl-Mjmc9UYjTjOsE0YrQ05F9EWUCkgfbWPJYPZcC9Va1PqCnu3PV40l2fBk0f5uFpcDfah6jOhtvEiqYpBXo0vShF7sNFQraXp9p8cwqWb-jz7aNIqicTCoY0CJ3EPu_zehRaW1HvcPcefrw9KO8uPMy1NT-3LfXeqpsaIhXdoj17OBk3-Q3G3t6563WVBf22Wgf6QZmFSx5VbeZBes1VqECqvt455z4V760M7u1DFz_M7DJT0hWY7fVkREwlHmWrZfUAV9wAdynaMfjD4E9mA9_V-QjexGZzV2_u2ebKggqOh0q6f-xdNUc7j-2umrijrsn7FWy293uMaVjg3VBAU4T8fIu0I3Q47sL52xGb_lFjZDE_qXEJ08BqBPK6taiqMXmwyG-ZhH_FXVe3X19fx3F8iaoqyrFfJ-0LqopXv-_i12UJJOWjeqmb6pHk-H-_gAs_yUnBzxfy3j0_q4rYb8hW-b5clmOfC6a7x34bkzTa3M7Wds1onKRKTPtotrGTL6z9PiRpmuIYfkcBmmGZ3bpm02FgtxkTFahHGFCbgkuGHYo7Kqo_4v7Fr-v2B8elHKrKjqy3heqCONf_Z8TvgokI8uI-cOM3_e6f0RL7M38fiO5HgsOfW5ZslX9fMw-_SPLnvfSLxbDvQOR2lAzExh_RpQSJJb9XFEcvd5O2JdmfLSKLu-rL7ifjHzT-gPjrF3pZlWiJNqd0e8g31tlAFRzbfZaJCknXCer6Bv-BncfMfzfi1X8V9tGuQme_yi6ta59vp3UqAsnXLm_VwRGQhtfmDRciXRcHW86BP55dfRb-0fKbNVomtA-WztAMTW12HLfheZ7eAZ7iOGr17dv30bknyzwwm01IPXh2TeFHsGa3mFr7PGbXeLsN0IbjGMzwq2__Atp89co.aI3Tcg.sKdU1Od-mL8oxWnAo9Nm-M41AYk'}
2025-08-02 11:59:30 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:59:30 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:59:30 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x07220138>
2025-08-02 11:59:30 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:30 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:30 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:59:30 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:30 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:59:30 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:59:30 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:59:30 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:59:30 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:59:30 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:59:30 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:59:30 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:59:30 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:59:30 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:59:30 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:59:30 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:59:31 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:31 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:59:31 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:59:31 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:31 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 11:59:31 - managers.commands_server - INFO - Checking commands server health
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Request completed in 0.18s with status 200
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.4318695068359375e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:59:31.017106'}, 'success': True}
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.6702880859375e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T08:59:31.077936'}, 'success': True}
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 11:59:31 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007901191711425781,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:59:31.186860"
  },
  "success": false
}

2025-08-02 11:59:31 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007901191711425781,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:59:31.186860"
  },
  "success": false
}

2025-08-02 11:59:31 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007901191711425781,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:59:31.186860"
  },
  "success": false
}

2025-08-02 11:59:31 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:59:31 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:59:31 - managers.commands_server - DEBUG - Request completed in 0.18s with status 400
2025-08-02 11:59:31 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007753372192382812,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:59:31.260667"
  },
  "success": false
}

2025-08-02 11:59:31 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007753372192382812,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:59:31.260667"
  },
  "success": false
}

2025-08-02 11:59:31 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007753372192382812,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T08:59:31.260667"
  },
  "success": false
}

2025-08-02 11:59:31 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 11:59:31 - services.base - INFO - Service operation completed: start_session
2025-08-02 11:59:33 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:33 - services.base - INFO - Service operation completed: scan_network
2025-08-02 11:59:33 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 11:59:33 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 11:59:33 - endpoints.settings - INFO - Request method: GET
2025-08-02 11:59:33 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 11:59:33 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmOq0oS_ZUnr6-rIAHbXKmlBhswLicum5mNBUmaeShm83T_vZO6Y7d60YveWCIi88Q5J8IZf6_uNW4Kv8Rlt_raNT3-supb3Ky-_r3yEcJte--qDJerr6unD_gXnxJ05rjRJkkd3_zMjA-PILL1J23I2Zu2LUf3CC5-SD_R87yeZnZK5gRXqo10030o1_pU9p1yxCX3wJJ1tPE0hhjfSlrYToL3zvfzOT3fVegcDsw0DJJc5C3_vCn-YMApxTS3mRwe5tFmEt9CZfTYbJQ2RRENz-kEXdphQYay82OM_A9_H7lvQsDqwk3V5etRcQBMLs4w18erwOxl3BXp5UCDCggUveVWX1Z4qpMGt3efOEEiLA122832dzwhLjAcz39ZJeEvV_DzFAcKSi7JSTdnldYStVWLrvb26kYtbplmwBEa6qgpXgrtK3ANMdPSONXmaHYNSLsAcu4sjW6q0p4hF5oiJef9icKOsGC-WfQ1eVxfSJkaMXAJVeHxNqK5Gs5ATl3A00F5m89FOAQgbD2dSwNALRAxLhcIdYIHc74Y0QhTadYOkD07AuWXHtAOYQNB2LmMlXoLxYKifcdlXRBTUAlHZMf0uZBHdIS9B_jBA1MeOlqOCm0gNfOgvPakfqcmY-I6VqamVQINgYZzxsIDqTtf58ueJtJrEKZXxp-1MrA1Itl8woPXaXYOLopWhQexREe5CnUuRkfxtxbHmj3nRPRwlGdz1HmpqxN7S4KREHtTidSQRi2NaM1wuYuRTZeDyhG9NNwvbbA6187bhRfRlAeFR7jLz9CIBQ_QsW-Pv_h79vI9PcLCevq2V3v2NbmUt2domwRHphwQxwhEi_-plp-glaIOUix9M3MZMlqB0rCylUlcsIKCJ7jmcvapFxVzU0ZgZZNJamkhox180O1vz4UfFwf257nUV6xeVX7w-9Qo1i5zo1Fh_kfPpwo-uTIAfBkoFo2A9SS4fUjuh_vP3g-uzotXgNgAaNC1-cZgNM-iJl1P6I9repJdk3vXAS_ZkpwahdlZ1ikPTHVCCi1ZlNfCQmYMOTdwJvFozsDZhss8lb7j5UFOtNl0_svTz3H3iI68xdbvnEd8dJ0Tvfjh2zJFYpM2mxT5K9DQcBmCl-Mjmc9UYjTjOsE0YrQ05F9EWUCkgfbWPJYPZcC9Va1PqCnu3PV40l2fBk0f5uFpcDfah6jOhtvEiqYpBXo0vShF7sNFQraXp9p8cwqWb-jz7aNIqicTCoY0CJ3EPu_zehRaW1HvcPcefrw9KO8uPMy1NT-3LfXeqpsaIhXdoj17OBk3-Q3G3t6563WVBf22Wgf6QZmFSx5VbeZBes1VqECqvt455z4V760M7u1DFz_M7DJT0hWY7fVkREwlHmWrZfUAV9wAdynaMfjD4E9mA9_V-QjexGZzV2_u2ebKggqOh0q6f-xdNUc7j-2umrijrsn7FWy293uMaVjg3VBAU4T8fIu0I3Q47sL52xGb_lFjZDE_qXEJ08BqBPK6taiqMXmwyG-ZhH_FXVe3X19fx3F8iaoqyrFfJ-0LqopXv-_i12UJJOWjeqmb6pHk-H-_gAs_yUnBzxfy3j0_q4rYb8hW-b5clmOfC6a7x34bkzTa3M7Wds1onKRKTPtotrGTL6z9PiRpmuIYfkcBmmGZ3bpm02FgtxkTFahHGFCbgkuGHYo7Kqo_4v7Fr-v2B8elHKrKjqy3heqCONf_Z8TvgokI8uI-cOM3_e6f0RL7M38fiO5HgsOfW5ZslX9fMw-_SPLnvfSLxbDvQOR2lAzExh_RpQSJJb9XFEcvd5O2JdmfLSKLu-rL7ifjHzT-gPjrF3pZlWiJNqd0e8g31tlAFRzbfZaJCknXCer6Bv-BncfMfzfi1X8V9tGuQme_yi6ta59vp3UqAsnXLm_VwRGQhtfmDRciXRcHW86BP55dfRb-0fKbNVomtA-WztAMTW12HLfheZ7eAZ7iOGr17dv30bknyzwwm01IPXh2TeFHsGa3mFr7PGbXeLsN0IbjGMzwq2__Atp89co.aI3Tcw.KTJ76-xBpAETWbU6lk92KhzMq6o'}
2025-08-02 11:59:33 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 11:59:33 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 11:59:33 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x072277E0>
2025-08-02 11:59:33 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:33 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:33 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 11:59:33 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 11:59:33 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 11:59:33 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 11:59:33 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 11:59:34 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:59:34 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 11:59:34 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 11:59:34 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 11:59:34 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 11:59:34 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 11:59:34 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 11:59:34 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 11:59:34 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 11:59:35 - managers.commands_server - DEBUG - Request completed in 1.98s with status 200
2025-08-02 11:59:35 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.8390591144561768, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T08:59:34.683874'}, 'success': True}
2025-08-02 11:59:35 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 11:59:35 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 11:59:35 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 11:59:35 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 11:59:35 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 11:59:35 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 11:59:35 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:01:04 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:01:16 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:01:24 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:02:53 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:02:56 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:03:34 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 12:03:34 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 12:03:34 - auth - INFO - Token[expires_in]: 3599
2025-08-02 12:03:34 - auth - INFO - Token[scope]: https://www.googleapis.com/auth/userinfo.email openid https://www.googleapis.com/auth/userinfo.profile
2025-08-02 12:03:34 - auth - INFO - Token[token_type]: Bearer
2025-08-02 12:03:34 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiI4NndUa1gtMGltamxxMlM5ZEY3RXlnIiwibm9uY2UiOiJkYkliRWJNQm1SN1NDSGd1NWxTMiIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI1NDEzLCJleHAiOjE3NTQxMjkwMTN9.o11hef9LLYIOCsmvtReDXMVk-gToqhJpFDejHScsPai43I3ggPpLBpBrgG2o3KROIoOUYeWK9o1GOIXrdDGn8DA1DsWi4IEX7azc9J_bhgUNYlxpJfoN8w9Dx4Q0fID28BRgVk-entoSk9xfzF_4hdXW2neELmZUir1e19VemQflIrg3ZYzD2jMIuwsr0zm3yHNoWUNNbrVkq2QeDuwDcmCpMe62eaJWZtk4VOr9hbnXCCBXNgbsN7Arkn9JjH6D2uOD8DYyq2XDooegxEs8EuxvFjUo-sF9PEgym-WQffsOWXzVlUgy_Uu-sRdsTJr13wnV5rdWLtwd8R-b9IPOTg
2025-08-02 12:03:34 - auth - INFO - Token[expires_at]: 1754129012
2025-08-02 12:03:34 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': '86wTkX-0imjlq2S9dF7Eyg', 'nonce': 'dbIbEbMBmR7SCHgu5lS2', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754125413, 'exp': 1754129013}
2025-08-02 12:03:34 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 12:03:34 - auth - INFO - Decoding ID token for additional 2FA claims...
2025-08-02 12:03:34 - auth - INFO - ID Token Claims Found: {
  "iss": "https://accounts.google.com",
  "azp": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "aud": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "sub": "113106855699918290550",
  "email": "chenferaru8@gmail.com",
  "email_verified": true,
  "at_hash": "86wTkX-0imjlq2S9dF7Eyg",
  "nonce": "dbIbEbMBmR7SCHgu5lS2",
  "name": "chen feraru",
  "picture": "https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c",
  "given_name": "chen",
  "family_name": "feraru",
  "iat": 1754125413,
  "exp": 1754129013
}
2025-08-02 12:03:35 - auth - INFO - Checking ID token claims for 2FA indicators...
2025-08-02 12:03:35 - auth - INFO - ID Token AMR: []
2025-08-02 12:03:35 - auth - INFO - ID Token ACR: None
2025-08-02 12:03:35 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 12:03:35 - auth - INFO -   Used 2FA: False
2025-08-02 12:03:35 - auth - INFO -   Method: none
2025-08-02 12:03:35 - auth - INFO -   Confidence: low
2025-08-02 12:03:35 - auth - WARNING - No Google 2FA detected for chenferaru8@gmail.com
2025-08-02 12:03:36 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:03:36 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:03:36 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:03:36 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmS2soS_RUHa9OtKiFAjrgRF5AEUqOiQbM2hIbSPLUGNDj877eEfe2OF2_xFm_BgizVyXNOZmV-X9wrXOdOgYt28a2tO_x10TW4Xnz7vnA8DzfNvS1TXCy-LUYHsi8OtVPo0xqNijve_SSJ1wfASImyuw0jxQsUFiIpNdJxuzy_h7WgXDRwdEWJu_fOdpNJDMf7QBzzInCy4l3dpFVVqal8P4A32Z94976pZMVrh5YWz_QjOOYJgh_ZSOW7qZl8T5dq9jgiwe02IFW4pByKTbUvzcgZB7rqeBkijpMDL9oUiXMIrbedvyXUREW4no4mlGNllLeBfR4Ltu7Ny93abTa1GFJgwyy-LvBQxTVu7g5xgkRWALIUgH_iMXGBZlj26yL2f7uCRylyj158iSVFm0SAYrER87ayD-JazG8pUuVeVsUeHe1ENq7QUvcpSqIETeFkqTKwoMxYE99biQhsVcjRkY_PB4nC5m7GfNPBNQ6uLyRN5dHyHCr90633pvJxhkJiQRa4xW065_7DhX5jK0ziQmqGiHAxQ4iDzGnTRQ17OeEnxMmrs7mjnMImXvm1DP3WovXEninmFHBMa2XBiJKPfu8ZETjnQu-d5M6G7MOGQ-abKPNy9CA5M7e4diR_K8Z9bJl6KiZlLKs7IE_pSuZI3uk6XQ6ASK-gn1xpZ0KFayAiWRtlzm6RkcHLEZU-ty-8k1D6ChN5p_0fLaY-2aZE9DCUbTDUec6rEHsLghETexOe5OB7lIQAqRZzUdPhwokM0Qvkw1wGvbWMrJl5EU2Zm9uEuzD6arSzIYgco__N3zbm_0Pg5_roGHZlG9f4UtxG39AIjkCZMIo8GM5-rlDhaw4IW_mYtU4-DHImMzZv0TczK2YsN2cJrjbXKrXSLL4ZErrmQEEAccrRB8gYVPnZJkzkGs_vEueod-LxF7-nxn1FEIGXa_9R86GUR6ZwIVu4Rx14UB-Jhs4n9_3Ds_YPS2H3V-itXIhky2BrlUa2Tg2KEoOPayIJlsa8K5DlDV5I1FxrdV3KXE0cvCPgdcpu5FygVSFTccqz3pTCsyHP_VQ4pp25GdFmgOy3p08dNtGRNVj_c2YTHy1TArMfjiFQJDagSaPIUyAu8BPBy_CJ9GfC00i9DnKSkmeC2JcSgAgH7PlsiZdDkz_aG-ZMWU-XoVp-RFIlcDg5KV7z7sQrWqTD8L0676t9HR5hSb_dLmJ50SxsvLElOF5Es_a5Y7HldoBrjHgl8ubGmTxWurtRqCErGyopKNG2Z7lhdaUCkYPb_S0k2cg4LJWUHYJJuK8i3zRggflzbmtxDTBgdZxfg0ysQ9q2Jg4mstj1TU1NOT2eUGloCLm1nn7AK-a6nvPyQyXjNcSOZNhtutIvNRu5hXk47E0Uug3a7Oq0YKXktOZgd-G2nDV-QJMrSxwOfLPlu-EhJFq5bAT2nQ_HfGlcg6C5GOakZ1o43rVu2dz8RpVqQPeFztS-cW57f3tbuqz4Tt4-mW6NV1aYDKyobavm2-tr3_cvYVmGGXaquHnxyvzV6drodZ7-cRGULzh34uwLuVTE_pf_-VZVl0GcYZLwOSHv7fjMusdOTbbKz-Uyf_hcMO09cpqIHG_XvZqaSyrOk-wDKqwvbPhxZu10PjkGFEOzWwoCekVvl9UqeTxWm5QOc6_zMKTWORM_tl7UUmH1EXUvTlU1v1jO6byyaEk9Z7Iz4lT9nxGfRhFMj0zcANdO3W3_DufY5_P7g-gOYuz_u2XJVvm0Zuivi8DJ42y8F04-G_YTiNwO4wex8Vd0TkFi8Z8VRX7kbtw0n0pLFnfZFe2_jH_R-ATx5Td6URbeHPVd0eVdeZ_fNsrhFHZMpkByXMVe29Wf2yaL6P9uxKvzujuE29I7O2V6aSzjfJOWyR7yDrq8lZy58xBeajec70GVc4aQQac_W8q0-6th10tv7tDOnSsDaECttwyzZlkWbIk5DEMtfvz42Tr3eO4Her32qYBdLSkcuMvVBlNLh8WrJd5sXG_NMDSm2cWPfwA8FfiZ.aI3UaA.EfNogGYocFKqX2WSyh7vyp4tWDg'}
2025-08-02 12:03:36 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:03:36 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:03:36 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06E12C90>
2025-08-02 12:03:36 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:36 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:36 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:03:36 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:36 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:03:36 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:03:36 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:03:36 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:03:36 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:03:36 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:03:36 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:03:36 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:03:36 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:03:36 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:03:36 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:03:36 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:03:37 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:37 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:03:37 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:03:37 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:37 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:03:37 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Request completed in 0.17s with status 200
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.743171691894531e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:03:37.047517'}, 'success': True}
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.9325485229492188e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:03:37.094759'}, 'success': True}
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Request completed in 0.17s with status 400
2025-08-02 12:03:37 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009431838989257812,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:03:37.214971"
  },
  "success": false
}

2025-08-02 12:03:37 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009431838989257812,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:03:37.214971"
  },
  "success": false
}

2025-08-02 12:03:37 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009431838989257812,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:03:37.214971"
  },
  "success": false
}

2025-08-02 12:03:37 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:03:37 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:03:37 - managers.commands_server - DEBUG - Request completed in 0.15s with status 400
2025-08-02 12:03:37 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008997917175292969,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:03:37.242784"
  },
  "success": false
}

2025-08-02 12:03:37 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008997917175292969,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:03:37.242784"
  },
  "success": false
}

2025-08-02 12:03:37 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008997917175292969,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:03:37.242784"
  },
  "success": false
}

2025-08-02 12:03:37 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:03:37 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:03:38 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:38 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:03:38 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 12:03:39 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:03:39 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:03:39 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:03:39 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmS2soS_RUHa9OtKiFAjrgRF5AEUqOiQbM2hIbSPLUGNDj877eEfe2OF2_xFm_BgizVyXNOZmV-X9wrXOdOgYt28a2tO_x10TW4Xnz7vnA8DzfNvS1TXCy-LUYHsi8OtVPo0xqNijve_SSJ1wfASImyuw0jxQsUFiIpNdJxuzy_h7WgXDRwdEWJu_fOdpNJDMf7QBzzInCy4l3dpFVVqal8P4A32Z94976pZMVrh5YWz_QjOOYJgh_ZSOW7qZl8T5dq9jgiwe02IFW4pByKTbUvzcgZB7rqeBkijpMDL9oUiXMIrbedvyXUREW4no4mlGNllLeBfR4Ltu7Ny93abTa1GFJgwyy-LvBQxTVu7g5xgkRWALIUgH_iMXGBZlj26yL2f7uCRylyj158iSVFm0SAYrER87ayD-JazG8pUuVeVsUeHe1ENq7QUvcpSqIETeFkqTKwoMxYE99biQhsVcjRkY_PB4nC5m7GfNPBNQ6uLyRN5dHyHCr90633pvJxhkJiQRa4xW065_7DhX5jK0ziQmqGiHAxQ4iDzGnTRQ17OeEnxMmrs7mjnMImXvm1DP3WovXEninmFHBMa2XBiJKPfu8ZETjnQu-d5M6G7MOGQ-abKPNy9CA5M7e4diR_K8Z9bJl6KiZlLKs7IE_pSuZI3uk6XQ6ASK-gn1xpZ0KFayAiWRtlzm6RkcHLEZU-ty-8k1D6ChN5p_0fLaY-2aZE9DCUbTDUec6rEHsLghETexOe5OB7lIQAqRZzUdPhwokM0Qvkw1wGvbWMrJl5EU2Zm9uEuzD6arSzIYgco__N3zbm_0Pg5_roGHZlG9f4UtxG39AIjkCZMIo8GM5-rlDhaw4IW_mYtU4-DHImMzZv0TczK2YsN2cJrjbXKrXSLL4ZErrmQEEAccrRB8gYVPnZJkzkGs_vEueod-LxF7-nxn1FEIGXa_9R86GUR6ZwIVu4Rx14UB-Jhs4n9_3Ds_YPS2H3V-itXIhky2BrlUa2Tg2KEoOPayIJlsa8K5DlDV5I1FxrdV3KXE0cvCPgdcpu5FygVSFTccqz3pTCsyHP_VQ4pp25GdFmgOy3p08dNtGRNVj_c2YTHy1TArMfjiFQJDagSaPIUyAu8BPBy_CJ9GfC00i9DnKSkmeC2JcSgAgH7PlsiZdDkz_aG-ZMWU-XoVp-RFIlcDg5KV7z7sQrWqTD8L0676t9HR5hSb_dLmJ50SxsvLElOF5Es_a5Y7HldoBrjHgl8ubGmTxWurtRqCErGyopKNG2Z7lhdaUCkYPb_S0k2cg4LJWUHYJJuK8i3zRggflzbmtxDTBgdZxfg0ysQ9q2Jg4mstj1TU1NOT2eUGloCLm1nn7AK-a6nvPyQyXjNcSOZNhtutIvNRu5hXk47E0Uug3a7Oq0YKXktOZgd-G2nDV-QJMrSxwOfLPlu-EhJFq5bAT2nQ_HfGlcg6C5GOakZ1o43rVu2dz8RpVqQPeFztS-cW57f3tbuqz4Tt4-mW6NV1aYDKyobavm2-tr3_cvYVmGGXaquHnxyvzV6drodZ7-cRGULzh34uwLuVTE_pf_-VZVl0GcYZLwOSHv7fjMusdOTbbKz-Uyf_hcMO09cpqIHG_XvZqaSyrOk-wDKqwvbPhxZu10PjkGFEOzWwoCekVvl9UqeTxWm5QOc6_zMKTWORM_tl7UUmH1EXUvTlU1v1jO6byyaEk9Z7Iz4lT9nxGfRhFMj0zcANdO3W3_DufY5_P7g-gOYuz_u2XJVvm0Zuivi8DJ42y8F04-G_YTiNwO4wex8Vd0TkFi8Z8VRX7kbtw0n0pLFnfZFe2_jH_R-ATx5Td6URbeHPVd0eVdeZ_fNsrhFHZMpkByXMVe29Wf2yaL6P9uxKvzujuE29I7O2V6aSzjfJOWyR7yDrq8lZy58xBeajec70GVc4aQQac_W8q0-6th10tv7tDOnSsDaECttwyzZlkWbIk5DEMtfvz42Tr3eO4Her32qYBdLSkcuMvVBlNLh8WrJd5sXG_NMDSm2cWPfwA8FfiZ.aI3UaQ.Y27fSBSvzTRw0-yax2cDH8CWuRU'}
2025-08-02 12:03:39 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:03:39 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:03:39 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06E28858>
2025-08-02 12:03:39 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:39 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:39 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:03:39 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:03:39 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:03:39 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:03:39 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:03:39 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:03:39 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:03:39 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:03:39 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:03:39 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:03:39 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:03:39 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:03:39 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:03:39 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:03:40 - managers.commands_server - DEBUG - Request completed in 1.89s with status 200
2025-08-02 12:03:40 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7313649654388428, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T09:03:40.000426'}, 'success': True}
2025-08-02 12:03:40 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 12:03:40 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 12:03:40 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 12:03:40 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 12:03:40 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 12:03:40 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 12:03:40 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:04:48 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:05:07 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:05:24 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 12:05:24 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 12:05:24 - auth - INFO - Token[expires_in]: 3599
2025-08-02 12:05:24 - auth - INFO - Token[scope]: openid https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile
2025-08-02 12:05:24 - auth - INFO - Token[token_type]: Bearer
2025-08-02 12:05:24 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJJcFdkRHZjTHBPSlJ3WkY4VENLUWtRIiwibm9uY2UiOiJ4dDlBdTUxV1gzbW9zQWxLc1FTUiIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI1NTIyLCJleHAiOjE3NTQxMjkxMjJ9.XRnA0iA-Vsgym0YY2mtvOxBTdvRg6IMSEJUVdia7vpipK90uFWaD8As2rp4Wa8LNQs-l8C5Hck2LGgoYF8OLL1RYDIrW06r-jO3o2R2yUYAPbsJG-fm11XKFRqKO-xmU8yV5uCMiIIar5aPHvg-KU7T-DkK_0SfZhHnb5jaB6fL-PAWyee3SBscLlPLiFta59KJjOhEaTu2SkBnuL8NSQXLmi0RXsx9elNcB8mFXr3dRbx8IJeN9ms-xDypeTC3YrINCsPfXKjkztXvS2PIiVEQxe_K-xDna9IXWwQ6JgNvlJPygA5m8Hh66xOv9phPVUhhSqN8a2-4gz0rbdb-J8w
2025-08-02 12:05:24 - auth - INFO - Token[expires_at]: 1754129121
2025-08-02 12:05:24 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': 'IpWdDvcLpOJRwZF8TCKQkQ', 'nonce': 'xt9Au51WX3mosAlKsQSR', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754125522, 'exp': 1754129122}
2025-08-02 12:05:24 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 12:05:24 - auth - INFO - Decoding ID token for additional 2FA claims...
2025-08-02 12:05:24 - auth - INFO - ID Token Claims Found: {
  "iss": "https://accounts.google.com",
  "azp": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "aud": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "sub": "113106855699918290550",
  "email": "chenferaru8@gmail.com",
  "email_verified": true,
  "at_hash": "IpWdDvcLpOJRwZF8TCKQkQ",
  "nonce": "xt9Au51WX3mosAlKsQSR",
  "name": "chen feraru",
  "picture": "https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c",
  "given_name": "chen",
  "family_name": "feraru",
  "iat": 1754125522,
  "exp": 1754129122
}
2025-08-02 12:05:24 - auth - INFO - Checking ID token claims for 2FA indicators...
2025-08-02 12:05:24 - auth - INFO - ID Token AMR: []
2025-08-02 12:05:24 - auth - INFO - ID Token ACR: None
2025-08-02 12:05:24 - auth - INFO - ID Token issued at: 2025-08-02 12:05:22, age: -1 day, 21:00:02.506557
2025-08-02 12:05:24 - auth - INFO - Fresh authentication detected with forced login (high confidence 2FA)
2025-08-02 12:05:24 - auth - INFO - User likely went through Google 2FA during forced re-authentication
2025-08-02 12:05:24 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 12:05:24 - auth - INFO -   Used 2FA: True
2025-08-02 12:05:24 - auth - INFO -   Method: forced_fresh_auth
2025-08-02 12:05:24 - auth - INFO -   Confidence: high
2025-08-02 12:05:24 - auth - INFO - User chenferaru8@gmail.com authenticated with Google 2FA (forced_fresh_auth)
2025-08-02 12:05:25 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:05:25 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:05:25 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:05:25 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmSq0gS_JW2Oj-qIAEJymzMBi1IIECF2LnIkkWQiK0AsbW9f-9Eb-2eOcxhDpKZIiM9wj1C6X--gBu8FnGXVtHL-0tSVUkeX29VE8bR9dbEbXqFjy59-fLM6-MG3VCMM7vmEf89doUdBgAkYAmSI0hgkvw7yb4D5nUN6DVFYYhrHTcFLOOy-wHwaOPm5f3PFxiGcdteu-oelxhlgoB_haRg0MeVNnJr2ejCKjieiqPdrHfUCTHD7aJ8bqtm9-mcGOVwTe_BOnQeJFPEkTradJq7YO4d1AnS8EnP2ZEZ0VB3h_PegEMKq0PPSYKAtpMBok9HP-Z9ANFowQNPdUCf7tUUSWXrDuPdmRKtVzpjQ61JV-E-VzkKxnrwE_OUnppYbxICbhPvJJiVIVwkQ9SPBxeoKLGYUrqtZLHNU6UWLboUtNNAUmsWKxGPNcLiPjXDEYYCPAWoX3GEVaBZnv_ygqKfqsSTnAaHEJ2RbFizRGlIaqWiq_2ttJKKy10z1UE1pUE7-Jnq6MAzN3ctSzNtTmbPVCkPqKw37wcvkyjfFAvtsEfKViZjV1gwTzalo5v-isvUIa0uoSo6XoZwrnoFiJmHewzKy6wUUR-AqPUNNgsAuUCkcblASKO6s-azmQxqtp-1ncoorkDC0gfaLmpUEHUebWf-0mJBUtD1GA-kpHqIhtBJKaUQh_CoPnzA9z4Y88jV8rDQelwzD0r9get3EhqQ59p3KauQagqUOt8ZdYfrzvp83lKYeg2iTKfhrJWBo2HK1qTu_E5zcnA-aFW025ThUawig03D4-YXF9eefVfGfFjSd1hSWeoaWN4SYyAsb7bHNfaDliWUZnrs2byP553EYr6Uul3GYHeek7dLX5hTHhQ-7l2cIjMVfECl0Bl-9u87y-_xFhX2BB2_9h0dncvLFDkWxhFJF6RpCJJFfzkUo_vl6GfmcfNh5DLt3D3G3muK5XSXBSsoeIxrLblMtMs3kWmNNpXMgcPPujMqISWa1nNN2DRwnnkZPNgP6fC9vyfHTe3RFyosrH_MfKzUiS0DwJfBwaZCYE-YwyPC96Ptc_a9Z_AbHYRMADTVc_jGpDXfJkfDQNSnnsmiZ7EfBuD3zl7MzMLqbFvOA0sawwO1t0m_VQuRNsXcjO97PpzvQHHUZZ9K6Pp5kGNuDpX_1PTJw8c88ja2f535WEfPlalFD-iIJI6N2myR-K-AZyVNGC-Pj3g_sz2tmfqoZnf8kflX91IKJBIIu02mgvQ8UHT9edyYUX9JVpJq7GXLjhBc9zWqTzz5EB2444QWNDXjQE7R9JbIuS17DHHfh6TyRO6sKNTF20mNQ64aIjvTFbiAyfKEj6CVD8StoCj3JF4-T2diLCxustnHVkWSBBsWfhz7hDhZa5PY3U9X0rj56bEM2AxuVjeF-BCcKY5pY9OGSv6hILGDLH-Ss3O6h-YDGPdN-VA4zdBdpUDkxW1HPs61cMMVotvQ0SUYOUmONb5oiXE31bG5pb1G0rbtx809Zfe5c3sDfEjI3utjfD3hpBLykusM-krG718uf0yJwBbcMV2txnPP1-mHbaWp8alxEBBMMpNNEAWEzA34dWvDqo7xg4W_SxT9kXZd3b6_vQ3D8PrNYGCN2tewKt4Wb3lbTACVt-o1LiDK__f0uqluKI9xwecLee2mZ9VNDBvsKt_MZUl8Gkx3TWGb4mOpdqJdHyr1Wb4MvsiZ25N-13E6fCwOSJEszXMkoGiG5oiayfqeWd_ppAgfYQzIVcGingvTjkzqz_TxCuu6_d7lUi6syg7b29LsgjjX_2fEp0IYM8Qv7i1uYPPg_p0ssd_P_8Omsav8ZjPgy8sNFiifriUsFsG-AeHbCeqxjN-jSwkcQ78simWXu6ht8emPIWHjrh5l96Pj7238BvHHT_SyKsMlOna88GApx6WLqhXyU6sbF3xco7B7NPFv2HlK_3ch3uCbsE24KlRgdT-3nqNcZCLbgD3Uzqdq5wqhFhPWJS42VF3sHDEHcFA8Yxb-1fIrIlw29BEsk6FoilxxLLvieZ7iAE-yLPny9eu31bmiZR_o1SoibzxDkPEtIJh1TBKQjxkiXq-DcMWydEzzL1__Ah-gGIc.aI3U1Q.-UDeI634n_8w-vQQAzQeWGfbY6s'}
2025-08-02 12:05:25 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:05:25 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:05:25 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x067C2D20>
2025-08-02 12:05:25 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:25 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:25 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:05:25 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:25 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:05:25 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:05:25 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:05:26 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:05:26 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:05:26 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:05:26 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:05:26 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:05:26 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:05:26 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:05:26 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:05:26 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:05:26 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:26 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:05:26 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:05:26 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:05:26 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:05:26 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:26 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:05:26 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:05:26 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:05:26 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:05:26 - managers.commands_server - DEBUG - Request completed in 0.20s with status 200
2025-08-02 12:05:26 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.00025963783264160156, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:05:26.462144'}, 'success': True}
2025-08-02 12:05:26 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:05:26 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:05:27 - managers.commands_server - DEBUG - Request completed in 0.17s with status 200
2025-08-02 12:05:27 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.1219253540039062e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:05:26.495919'}, 'success': True}
2025-08-02 12:05:27 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:05:27 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:05:27 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 12:05:27 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.004372596740722656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:05:26.637667"
  },
  "success": false
}

2025-08-02 12:05:27 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.004372596740722656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:05:26.637667"
  },
  "success": false
}

2025-08-02 12:05:27 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-02 12:05:27 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.004372596740722656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:05:26.637667"
  },
  "success": false
}

2025-08-02 12:05:27 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012569427490234375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:05:26.647820"
  },
  "success": false
}

2025-08-02 12:05:27 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:05:27 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012569427490234375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:05:26.647820"
  },
  "success": false
}

2025-08-02 12:05:27 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:05:27 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012569427490234375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:05:26.647820"
  },
  "success": false
}

2025-08-02 12:05:27 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:05:27 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:05:28 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:28 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:05:28 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 12:05:28 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:05:28 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:05:28 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:05:28 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmSq0gS_JW2Oj-qIAEJymzMBi1IIECF2LnIkkWQiK0AsbW9f-9Eb-2eOcxhDpKZIiM9wj1C6X--gBu8FnGXVtHL-0tSVUkeX29VE8bR9dbEbXqFjy59-fLM6-MG3VCMM7vmEf89doUdBgAkYAmSI0hgkvw7yb4D5nUN6DVFYYhrHTcFLOOy-wHwaOPm5f3PFxiGcdteu-oelxhlgoB_haRg0MeVNnJr2ejCKjieiqPdrHfUCTHD7aJ8bqtm9-mcGOVwTe_BOnQeJFPEkTradJq7YO4d1AnS8EnP2ZEZ0VB3h_PegEMKq0PPSYKAtpMBok9HP-Z9ANFowQNPdUCf7tUUSWXrDuPdmRKtVzpjQ61JV-E-VzkKxnrwE_OUnppYbxICbhPvJJiVIVwkQ9SPBxeoKLGYUrqtZLHNU6UWLboUtNNAUmsWKxGPNcLiPjXDEYYCPAWoX3GEVaBZnv_ygqKfqsSTnAaHEJ2RbFizRGlIaqWiq_2ttJKKy10z1UE1pUE7-Jnq6MAzN3ctSzNtTmbPVCkPqKw37wcvkyjfFAvtsEfKViZjV1gwTzalo5v-isvUIa0uoSo6XoZwrnoFiJmHewzKy6wUUR-AqPUNNgsAuUCkcblASKO6s-azmQxqtp-1ncoorkDC0gfaLmpUEHUebWf-0mJBUtD1GA-kpHqIhtBJKaUQh_CoPnzA9z4Y88jV8rDQelwzD0r9get3EhqQ59p3KauQagqUOt8ZdYfrzvp83lKYeg2iTKfhrJWBo2HK1qTu_E5zcnA-aFW025ThUawig03D4-YXF9eefVfGfFjSd1hSWeoaWN4SYyAsb7bHNfaDliWUZnrs2byP553EYr6Uul3GYHeek7dLX5hTHhQ-7l2cIjMVfECl0Bl-9u87y-_xFhX2BB2_9h0dncvLFDkWxhFJF6RpCJJFfzkUo_vl6GfmcfNh5DLt3D3G3muK5XSXBSsoeIxrLblMtMs3kWmNNpXMgcPPujMqISWa1nNN2DRwnnkZPNgP6fC9vyfHTe3RFyosrH_MfKzUiS0DwJfBwaZCYE-YwyPC96Ptc_a9Z_AbHYRMADTVc_jGpDXfJkfDQNSnnsmiZ7EfBuD3zl7MzMLqbFvOA0sawwO1t0m_VQuRNsXcjO97PpzvQHHUZZ9K6Pp5kGNuDpX_1PTJw8c88ja2f535WEfPlalFD-iIJI6N2myR-K-AZyVNGC-Pj3g_sz2tmfqoZnf8kflX91IKJBIIu02mgvQ8UHT9edyYUX9JVpJq7GXLjhBc9zWqTzz5EB2444QWNDXjQE7R9JbIuS17DHHfh6TyRO6sKNTF20mNQ64aIjvTFbiAyfKEj6CVD8StoCj3JF4-T2diLCxustnHVkWSBBsWfhz7hDhZa5PY3U9X0rj56bEM2AxuVjeF-BCcKY5pY9OGSv6hILGDLH-Ss3O6h-YDGPdN-VA4zdBdpUDkxW1HPs61cMMVotvQ0SUYOUmONb5oiXE31bG5pb1G0rbtx809Zfe5c3sDfEjI3utjfD3hpBLykusM-krG718uf0yJwBbcMV2txnPP1-mHbaWp8alxEBBMMpNNEAWEzA34dWvDqo7xg4W_SxT9kXZd3b6_vQ3D8PrNYGCN2tewKt4Wb3lbTACVt-o1LiDK__f0uqluKI9xwecLee2mZ9VNDBvsKt_MZUl8Gkx3TWGb4mOpdqJdHyr1Wb4MvsiZ25N-13E6fCwOSJEszXMkoGiG5oiayfqeWd_ppAgfYQzIVcGingvTjkzqz_TxCuu6_d7lUi6syg7b29LsgjjX_2fEp0IYM8Qv7i1uYPPg_p0ssd_P_8Omsav8ZjPgy8sNFiifriUsFsG-AeHbCeqxjN-jSwkcQ78simWXu6ht8emPIWHjrh5l96Pj7238BvHHT_SyKsMlOna88GApx6WLqhXyU6sbF3xco7B7NPFv2HlK_3ch3uCbsE24KlRgdT-3nqNcZCLbgD3Uzqdq5wqhFhPWJS42VF3sHDEHcFA8Yxb-1fIrIlw29BEsk6FoilxxLLvieZ7iAE-yLPny9eu31bmiZR_o1SoibzxDkPEtIJh1TBKQjxkiXq-DcMWydEzzL1__Ah-gGIc.aI3U1w.8QfHqqjm3VfiU5NQ0NtTOfT5ojw'}
2025-08-02 12:05:28 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:05:28 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:05:28 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x062A0348>
2025-08-02 12:05:28 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:28 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:28 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:05:28 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:05:28 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:05:28 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:05:28 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:05:28 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:05:28 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:05:28 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:05:28 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:05:28 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:05:28 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:05:28 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:05:28 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:05:28 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:05:29 - managers.commands_server - DEBUG - Request completed in 1.97s with status 200
2025-08-02 12:05:29 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.8130435943603516, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T09:05:29.475201'}, 'success': True}
2025-08-02 12:05:29 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 12:05:29 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 12:05:29 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 12:05:30 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 12:05:30 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 12:05:30 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 12:05:30 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:05:42 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:05:46 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:06:02 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 12:06:02 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 12:06:02 - auth - INFO - Token[expires_in]: 3599
2025-08-02 12:06:02 - auth - INFO - Token[scope]: https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile openid
2025-08-02 12:06:02 - auth - INFO - Token[token_type]: Bearer
2025-08-02 12:06:02 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiIxU05fbURMenZCa0UtNWFrRFJldml3Iiwibm9uY2UiOiI2ajFNYzM1dnZGSTV0bTd6WVFwWCIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI1NTYxLCJleHAiOjE3NTQxMjkxNjF9.W0tzt1o0rgWK-yUfAyFFtZNMkACZPgtOvLaxaQsqOcOnaTswudBxz2-OgF73wPPKy5USMPGqA1xZfvlXESJQcESPoTyaecBx77we9x4KiFucKg8l0FrDq14kfe1HukJLNSRxVuyuuCjNNS_DYk2dCa2XFrYpm5He6X4T-YzvRLgMvZqEIUAtWhAvnKvp0FiWadA40Xguh0uaJ3wELjK1stWGeaCGZopPOKdyjc6vWasXDuHhgA7O8ndRaTmOrIE4hF8mhduaR6411lLRA0Ym87m1S6LeYfbhcfuDeqdt9PN0prVKwjYdXI0cld8FPwwZPQwn2lQZAdsq5_Q33wwMKQ
2025-08-02 12:06:02 - auth - INFO - Token[expires_at]: 1754129160
2025-08-02 12:06:02 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': '1SN_mDLzvBkE-5akDReviw', 'nonce': '6j1Mc35vvFI5tm7zYQpX', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754125561, 'exp': 1754129161}
2025-08-02 12:06:02 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 12:06:02 - auth - INFO - Decoding ID token for additional 2FA claims...
2025-08-02 12:06:02 - auth - INFO - ID Token Claims Found: {
  "iss": "https://accounts.google.com",
  "azp": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "aud": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "sub": "113106855699918290550",
  "email": "chenferaru8@gmail.com",
  "email_verified": true,
  "at_hash": "1SN_mDLzvBkE-5akDReviw",
  "nonce": "6j1Mc35vvFI5tm7zYQpX",
  "name": "chen feraru",
  "picture": "https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c",
  "given_name": "chen",
  "family_name": "feraru",
  "iat": 1754125561,
  "exp": 1754129161
}
2025-08-02 12:06:02 - auth - INFO - Checking ID token claims for 2FA indicators...
2025-08-02 12:06:02 - auth - INFO - ID Token AMR: []
2025-08-02 12:06:02 - auth - INFO - ID Token ACR: None
2025-08-02 12:06:02 - auth - INFO - ID Token issued at: 2025-08-02 12:06:01, age: -1 day, 21:00:01.737519
2025-08-02 12:06:02 - auth - INFO - Fresh authentication detected with forced login (high confidence 2FA)
2025-08-02 12:06:02 - auth - INFO - User likely went through Google 2FA during forced re-authentication
2025-08-02 12:06:02 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 12:06:02 - auth - INFO -   Used 2FA: True
2025-08-02 12:06:02 - auth - INFO -   Method: forced_fresh_auth
2025-08-02 12:06:02 - auth - INFO -   Confidence: high
2025-08-02 12:06:02 - auth - INFO - User chenferaru8@gmail.com authenticated with Google 2FA (forced_fresh_auth)
2025-08-02 12:06:03 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:06:03 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:06:03 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:06:03 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmyo0gS_JUynUvvJYlA4pmN2aAFCUkgIUAsF1kCyb49VkFb_Xsnquqq6p45zGGOREZ6hHsE6X_MoI8eGW7Cwpt9zIKiCFL88IvKxd7Dr3AdPlDbhLOvr7wOV5EfYZLZVC3-e-yBGgIAAWTmYDUHUAPcB2A_AHzjIANpikA8SlxlKMd58xdAW-Nq9vHHDLkurutHUyQ4JygDgtwbArxKH1h5bPR5iwvWDHK5H5kz44NrOxwPYp6Ij8PxxqdJw2Mq227yymCP8y3uVe3T2EQyAuOZT5tBvkZL475WZEmQx8S9svZiz6Qqc9VkzXKOp4FF7SMyR25n2w2L6J0YxUU6uLa83whzB7dJpGg0fQ0Kb3yWS3WePxS5C_qUFhxjgXS0CawTjxKVv4mqoBz2JpSik87lnytbxYDjjXqk1X0R-zyglgxRAj_LiIj70oxEFhTkKBb8ikdEBZrhuK-zyPupCh6OobN3o0t0VPVRpORIrMWsKe2NyIrZLZE1qZc0sZf3diwZCrS0dSLHYSyPwWhpEmVBibHGXW_FImVrQibvd9F5cwTY5CfM051SIl95I2VKl5amUOEdbr07Ft0ZCrFFenTy23jOvM6BXm2rTOxAMEGEOJ8gxKe01ceLFvRSvBvlrbQ4mzxAuQ3lrVdJ0Gss-h7bU4sZoJBpLSwYAmnv9a4RUudM6N2D1NqQ62z4TD1TTt1M7kjN1MmVltRvxKiPLPOeiHERSRpPSWOykLak7qiMlw1FqJfQixUajXLuGDKhrA_S1m5kI4WXvVx423XuHoTCU5nQPax_cTHvo20eCR8G2AYDzlNdlcibE4yIyBvvSI1dL8cBRXaGuWjJ87IVGcKXkjbTGO6NZaT11BfhlDqZTXoXBk8LeRtSITL6n_3bxvT99L3sPiDDLm1DiS75bfAMneAIwIRh6MLgpacOGN_RbxLO7Q0COuEhVDfhmHpZSk9YTsYRXH3KhSgWZGuUKC-396p2B47mscZd6I1Xf0zoGFPeMUb7eyvuf_T34rguLfpGuZn-j5k_C2lgcgdyubO_Uy68D4RD65H73uY1-85SubUC3YUDZckyuEqjZfsOnqoaUZ9KfBQsnbmqkNsZOyHWMr2534-po4tPd0_t7sCupUygNSHVcLLj3DGBZ0Oa9ilHpp06KeFmUOlPTV_rbhMeaY3vv85soqNlHqlJD2QIgMSe8qgD8itMs3oSvBQfyH7GO1rWlKcUJ085Frg3AzRjQxWgCozTfNB9fhCExpalhN_Y16C5dGf0REr9eXEvOdLqvvXWzxHOL4GwpPvr9TQwuipd95889bT9LjV36lFxd-q10AaE3fVzuewx91ycIqF1T8EqBUK1_aQWiY-pQ5scz7J6e97boW03sSyrj62VQG-DoClUVpkxB8yaC21ujd3tHEid_bkTdb4xQr7LT10JhMhAHr8AZtCGoEVHut-d4xNVN8Yeo83eLsrr5eQNsct2BqrNbXsIA355WeXeDWnZpRJ3i1BYZaHXohu7oKj0fOOBla2WGaWyZ2z5Tuj67RZ_eg13lUFZ3U99bHmmCNzUWwnXvrevSp_DVLF5r_5kHgpN9710UsjrVrtFicmDFTZNWX-8v_d9__bdWVAZ1W9ukb1PpvI-vf5R7hdvOENR-uV_Ti-rwo9S_IVUySOPFHy9kI9meFVdY1QRV_luLlP-y2CaR4jqkBxTqvzItuexWye7OYOS7Q13UU_SUTs5IAUYmlsBSNELejUvF3HXLZYJHWRu62II2IyJupUbNiAoP8P2DZVl_aPZqZxb5A2xt6nnCXEs_8-IL6EIpkteXB9XqGpX_w6m2O_n_2HTxFV-sxnq68xHWZQOjxxlk2DfgcjtIOqIjD-iUwkSi35ZFMNMd6O6_m20xLiLNm_-6vhHG79BfPmJnhe5O0XZmJJcmuk6QWSabDlaSmmS4zJym7b6fW3SkP7vQryjd34TrAr3jIrkUlvG-Xacx2u4Q_LlVGxN3pXxXL_hbE2V2dYQUoj6s6WO_L9qjp2704a2zjQZiqYAuyK8OI6jVpADDANm3759X51HNO0DzbIe8LnFHGDfmS-WGMwRhxdzvFw6LsswNKa52bc_AZEDGmk.aI3U-w.RTA7uAsxUZLvFC_pID6z8R_nDVs'}
2025-08-02 12:06:03 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:06:03 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:06:03 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x07020CA8>
2025-08-02 12:06:03 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:03 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:03 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:06:03 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:03 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:06:03 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:06:03 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:06:04 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:06:04 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:06:04 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:06:04 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:06:04 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:06:04 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:06:04 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:06:04 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:06:04 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:06:04 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:04 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:06:04 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:06:04 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:06:04 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:06:04 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:04 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:06:04 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:06:04 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:06:04 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Request completed in 0.17s with status 200
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.5033950805664062e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:06:04.525158'}, 'success': True}
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Request completed in 0.15s with status 200
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.002716064453125e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:06:04.617960'}, 'success': True}
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 12:06:05 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008890628814697266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:06:04.686809"
  },
  "success": false
}

2025-08-02 12:06:05 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008890628814697266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:06:04.686809"
  },
  "success": false
}

2025-08-02 12:06:05 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008890628814697266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:06:04.686809"
  },
  "success": false
}

2025-08-02 12:06:05 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:06:05 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:06:05 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-02 12:06:05 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008754730224609375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:06:04.769520"
  },
  "success": false
}

2025-08-02 12:06:05 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008754730224609375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:06:04.769520"
  },
  "success": false
}

2025-08-02 12:06:05 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008754730224609375,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:06:04.769520"
  },
  "success": false
}

2025-08-02 12:06:05 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:06:05 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:06:06 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:06 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:06:06 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 12:06:07 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:06:07 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:06:07 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:06:07 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmyo0gS_JUynUvvJYlA4pmN2aAFCUkgIUAsF1kCyb49VkFb_Xsnquqq6p45zGGOREZ6hHsE6X_MoI8eGW7Cwpt9zIKiCFL88IvKxd7Dr3AdPlDbhLOvr7wOV5EfYZLZVC3-e-yBGgIAAWTmYDUHUAPcB2A_AHzjIANpikA8SlxlKMd58xdAW-Nq9vHHDLkurutHUyQ4JygDgtwbArxKH1h5bPR5iwvWDHK5H5kz44NrOxwPYp6Ij8PxxqdJw2Mq227yymCP8y3uVe3T2EQyAuOZT5tBvkZL475WZEmQx8S9svZiz6Qqc9VkzXKOp4FF7SMyR25n2w2L6J0YxUU6uLa83whzB7dJpGg0fQ0Kb3yWS3WePxS5C_qUFhxjgXS0CawTjxKVv4mqoBz2JpSik87lnytbxYDjjXqk1X0R-zyglgxRAj_LiIj70oxEFhTkKBb8ikdEBZrhuK-zyPupCh6OobN3o0t0VPVRpORIrMWsKe2NyIrZLZE1qZc0sZf3diwZCrS0dSLHYSyPwWhpEmVBibHGXW_FImVrQibvd9F5cwTY5CfM051SIl95I2VKl5amUOEdbr07Ft0ZCrFFenTy23jOvM6BXm2rTOxAMEGEOJ8gxKe01ceLFvRSvBvlrbQ4mzxAuQ3lrVdJ0Gss-h7bU4sZoJBpLSwYAmnv9a4RUudM6N2D1NqQ62z4TD1TTt1M7kjN1MmVltRvxKiPLPOeiHERSRpPSWOykLak7qiMlw1FqJfQixUajXLuGDKhrA_S1m5kI4WXvVx423XuHoTCU5nQPax_cTHvo20eCR8G2AYDzlNdlcibE4yIyBvvSI1dL8cBRXaGuWjJ87IVGcKXkjbTGO6NZaT11BfhlDqZTXoXBk8LeRtSITL6n_3bxvT99L3sPiDDLm1DiS75bfAMneAIwIRh6MLgpacOGN_RbxLO7Q0COuEhVDfhmHpZSk9YTsYRXH3KhSgWZGuUKC-396p2B47mscZd6I1Xf0zoGFPeMUb7eyvuf_T34rguLfpGuZn-j5k_C2lgcgdyubO_Uy68D4RD65H73uY1-85SubUC3YUDZckyuEqjZfsOnqoaUZ9KfBQsnbmqkNsZOyHWMr2534-po4tPd0_t7sCupUygNSHVcLLj3DGBZ0Oa9ilHpp06KeFmUOlPTV_rbhMeaY3vv85soqNlHqlJD2QIgMSe8qgD8itMs3oSvBQfyH7GO1rWlKcUJ085Frg3AzRjQxWgCozTfNB9fhCExpalhN_Y16C5dGf0REr9eXEvOdLqvvXWzxHOL4GwpPvr9TQwuipd95889bT9LjV36lFxd-q10AaE3fVzuewx91ycIqF1T8EqBUK1_aQWiY-pQ5scz7J6e97boW03sSyrj62VQG-DoClUVpkxB8yaC21ujd3tHEid_bkTdb4xQr7LT10JhMhAHr8AZtCGoEVHut-d4xNVN8Yeo83eLsrr5eQNsct2BqrNbXsIA355WeXeDWnZpRJ3i1BYZaHXohu7oKj0fOOBla2WGaWyZ2z5Tuj67RZ_eg13lUFZ3U99bHmmCNzUWwnXvrevSp_DVLF5r_5kHgpN9710UsjrVrtFicmDFTZNWX-8v_d9__bdWVAZ1W9ukb1PpvI-vf5R7hdvOENR-uV_Ti-rwo9S_IVUySOPFHy9kI9meFVdY1QRV_luLlP-y2CaR4jqkBxTqvzItuexWye7OYOS7Q13UU_SUTs5IAUYmlsBSNELejUvF3HXLZYJHWRu62II2IyJupUbNiAoP8P2DZVl_aPZqZxb5A2xt6nnCXEs_8-IL6EIpkteXB9XqGpX_w6m2O_n_2HTxFV-sxnq68xHWZQOjxxlk2DfgcjtIOqIjD-iUwkSi35ZFMNMd6O6_m20xLiLNm_-6vhHG79BfPmJnhe5O0XZmJJcmuk6QWSabDlaSmmS4zJym7b6fW3SkP7vQryjd34TrAr3jIrkUlvG-Xacx2u4Q_LlVGxN3pXxXL_hbE2V2dYQUoj6s6WO_L9qjp2704a2zjQZiqYAuyK8OI6jVpADDANm3759X51HNO0DzbIe8LnFHGDfmS-WGMwRhxdzvFw6LsswNKa52bc_AZEDGmk.aI3U_Q.A52JydYNWxrSFHDWDnashN8L_BM'}
2025-08-02 12:06:07 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:06:07 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:06:07 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x07273D20>
2025-08-02 12:06:07 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:07 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:07 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:06:07 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:06:07 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:06:07 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:06:07 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:06:07 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:06:07 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:06:07 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:06:07 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:06:07 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:06:07 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:06:07 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:06:07 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:06:07 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:06:07 - managers.commands_server - DEBUG - Request completed in 1.94s with status 200
2025-08-02 12:06:07 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7675142288208008, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T09:06:07.472084'}, 'success': True}
2025-08-02 12:06:07 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 12:06:07 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 12:06:07 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 12:06:08 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 12:06:08 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 12:06:08 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 12:06:08 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:07:19 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 12:07:19 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 12:07:19 - auth - INFO - Token[expires_in]: 3599
2025-08-02 12:07:19 - auth - INFO - Token[scope]: https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile openid
2025-08-02 12:07:19 - auth - INFO - Token[token_type]: Bearer
2025-08-02 12:07:19 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJTb0k5QmdoY2x3SFBDVENQU1VTQmFnIiwibm9uY2UiOiJjNE43dGdzNHFmUXRoNGN6ZGxjWSIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI1NjM5LCJleHAiOjE3NTQxMjkyMzl9.BaE8mfavKyVOSEGoZVoAn2NAvudrq_up15XzfmZnx8WXuggHlkI6ug6lyf7mBVF4DRkzGP3MO5H8XPxJHOcHMtG36Zh86qgqt5guhUSLrFHBc3ADQdZji5e6nd8Qm0lFKIwpvjJaHfnMVOCFjJ1-l4qQ0zxbCzzwW0IOEokPMV02-SQSH1TOuvj5VAQMEA6R5HIj_vsm6Xdm3ILXBRRrSwtOdN07DmcC7fKOph-U_9ZWmxzMm4p3DXjD_JUX4v0uGJ13iPOFsQIDf75gYkrSnQrQGlMHNOuNtgyIyLzhkzJYK-WH5uOp4QjXiSRJAKaSFFHsf3unzXQWbu-3aJV5vg
2025-08-02 12:07:19 - auth - INFO - Token[expires_at]: 1754129238
2025-08-02 12:07:19 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': 'SoI9BghclwHPCTCPSUSBag', 'nonce': 'c4N7tgs4qfQth4czdlcY', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754125639, 'exp': 1754129239}
2025-08-02 12:07:19 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 12:07:19 - auth - INFO - Decoding ID token for additional 2FA claims...
2025-08-02 12:07:19 - auth - INFO - ID Token Claims Found: {
  "iss": "https://accounts.google.com",
  "azp": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "aud": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "sub": "113106855699918290550",
  "email": "chenferaru8@gmail.com",
  "email_verified": true,
  "at_hash": "SoI9BghclwHPCTCPSUSBag",
  "nonce": "c4N7tgs4qfQth4czdlcY",
  "name": "chen feraru",
  "picture": "https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c",
  "given_name": "chen",
  "family_name": "feraru",
  "iat": 1754125639,
  "exp": 1754129239
}
2025-08-02 12:07:19 - auth - INFO - Checking ID token claims for 2FA indicators...
2025-08-02 12:07:19 - auth - INFO - ID Token AMR: []
2025-08-02 12:07:19 - auth - INFO - ID Token ACR: None
2025-08-02 12:07:19 - auth - INFO - ID Token issued at: 2025-08-02 12:07:19, age: -1 day, 21:00:00.966516
2025-08-02 12:07:19 - auth - INFO - Fresh authentication detected with forced login (high confidence 2FA)
2025-08-02 12:07:19 - auth - INFO - User likely went through Google 2FA during forced re-authentication
2025-08-02 12:07:20 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 12:07:20 - auth - INFO -   Used 2FA: True
2025-08-02 12:07:20 - auth - INFO -   Method: forced_fresh_auth
2025-08-02 12:07:20 - auth - INFO -   Confidence: high
2025-08-02 12:07:20 - auth - INFO - User chenferaru8@gmail.com authenticated with Google 2FA (forced_fresh_auth)
2025-08-02 12:07:21 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:07:21 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:07:21 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:07:21 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmSo0gS_ZWyPLcyg2CRSLMxG20IJAGJQGwXWRDsEIDEIom2-vcOMqurapbDHOaIh8dzf8-deH--wBhdSNSldfjy_pLUdVJGl7i-4Si8xLeoTS-o79KXPz7zhuiWxVlEM7tbH_1r7II6CgAB5GdgMQPQAuI7mL9D8MrwnMAsKMSliW4EVVHV_Q3Qt9Ht5f3PF4Rx1LaXri6iiqI8ERRfEViarCxoDzyOJQmX0YFbc0nmoCxzkkdTBmHa6av0fptZDdxcn-t5IJ2O0SAcutJO26dMJDZZpQcm01q8W_NF7zCPqriKsQATBE5rd9OdjbqWo4vaBypKrovi1A5rP7cPWrDXz3g2OntDUPmLxraLa8cWikfIZfgYTgXIMfHVg3RYHqQArRPvsDS25vKkmJIh71yoZpApDrrgD6Faxs_mKq-U06gtATPnqRLRo8mouJ-a0QjHQBGyi1_xjKrA8qL4x0sW_lQleu7TYIczPdub51FhtExpFdI1_loRFHIqNEu9q5Zy13Z-rjoG9KxVoeVpro3J6Fkq40GV98bt3csVxrckou222XG9B5G7nDAPNmNksfFKyzSYVadQHcqnOx7r4Qil3IMiE1Sn8UjCIYBh65t8HkAwQaRRNUEoD3VzHnUruav5dtQ2Knd0lwBVPtQ24U2FYeexdu5PLRLAINfjPJgCdRfesZMyRyLdsaz2PhQHHz7K0NVKTLSB1iyDyuhp_U7J7pnn2oWS15lqLRl1LDh1Q-uOxqivGUq9gWFusGjUqsDRKOXzU934neaUUN9pdbhZVViW6tDkUyyvfnFx7dF395QPD3yHB8eprknlrShGRuXNt7TG9q7lCaNZHq9bxUPfKDzly6jraQx25zllO_VFOZUB8Wnv0jO00qUPmRQ595_9-870_YhDYj-R4ze-Y2R6dXqGzpniSMCFaYphMulvBaDgDRLWHnywprTa2FvNODO2ZRCpmrACIlLc85Sba1uODXfhqMkSObunWttpgr975M7Eg_Bp4HzloZ3dK7sf_X1yXDUee2IwOf_bzB-1-uSrAIpVsLMZDO0n5dCH9H64_pz94JniyoCYC6Cmeo54s1jNt8HDNDPmauR7yTvzHyYUt85Wyi1y7mx7XwZn5YF3zNYGfqvSf9SSSisqtiIeC3h01GmfKuT6ZVBSbg5T_tT0c919yqNsI_vXmU919Nw9M-mBHAnQ2EMbz4D-CoyWqzzFKyOZ7me-ZTXLeKh58VTHUnxdoe2CxGg4PG3d3O5q366XFdSWQx_erpe-YXh3jIlfPRaO2yeJXBaK0CdC-YznZGVL3OZUjLsPVtV5eeF-PPayTte327GCny6Ea3Lt-KRPz-bxJskrzC43RujnGR8JVbgwCCilg3JvhnyP5LhSbX0t5XtmVnJXA4yPYD2Odwco-rYuPlQbwJlpmDJj6f2Q8_bSULdL4cTLSn4ZWiK4IWGVo7s6nW7mvdNDDcw3BK_n8UFv0tn5IvoOeYwq4Rp24-aby_7scgPod3uGzT50qTWUTTznE6-4mZVxM3alKmt6r3XJU3kex7QY995h5sh8rzeckbuZedovD8iUJLmN2b4aXcMJ-hmL9jY_JPR1a3HdRPTBSruuad_f3u73--uXs6Ama19xTd4mU3mbXv-siuvXiKCs_PY_pze3Os7K6ButUmUhLfj5Ql6652fVVYRu1FW-zGXK_zSY7pKiNqXHZq2IqyTF5V3-WFvrD_NsrtDUNeonB2QAz4oLABmWYxezhsuHgZsXbEJwjyMIBMJnwwKnHUiaa9q_oqZpfzQ7lcN11VF7m3qeEMfm_4z4KRTFxPTFjaMbuvWLfyZT7Pfz_7Bp6iq_2Qw1lRiRrHxeKkQmwb6A6O0kG6iMP6JTCRrLflkUL0x3s7b9bbTUuOu-6v7u-Ecbv0F8-4le1RX-jHLavEta7hobXcrhMSyxR4-bDHf97fe1KVP2vwvxht6W62RR4yOqC731nONpP8tXcIs0_VBv3CXWotn5FJEV05CNI5UQ3Y-eOS7_0YrCDE8b2gfTZBiWAcKC5wVRFJkFFAHPg5fv379W55JN-8AKQghikZuBKA5m3DwCMyRG3CyazwMs8DwbseLL978AyCoZcw.aI3VSA.naPfCUNAKWQ3oojhUsRQfG7t_Gc'}
2025-08-02 12:07:21 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:07:21 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:07:21 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x07273A98>
2025-08-02 12:07:21 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:21 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:21 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:07:21 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:21 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:07:21 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:07:21 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:07:21 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:07:21 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:07:21 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:07:21 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:07:21 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:07:21 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:07:21 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:07:21 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:07:21 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:07:22 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:22 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:07:22 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:07:22 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:22 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:07:22 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.314018249511719e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:07:21.763705'}, 'success': True}
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Request completed in 0.17s with status 200
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.0994415283203125e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:07:21.891204'}, 'success': True}
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Request completed in 0.15s with status 400
2025-08-02 12:07:22 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009756088256835938,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:07:21.913906"
  },
  "success": false
}

2025-08-02 12:07:22 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009756088256835938,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:07:21.913906"
  },
  "success": false
}

2025-08-02 12:07:22 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009756088256835938,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:07:21.913906"
  },
  "success": false
}

2025-08-02 12:07:22 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:07:22 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:07:22 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 12:07:22 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0015206336975097656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:07:22.050191"
  },
  "success": false
}

2025-08-02 12:07:22 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0015206336975097656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:07:22.050191"
  },
  "success": false
}

2025-08-02 12:07:22 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0015206336975097656,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:07:22.050191"
  },
  "success": false
}

2025-08-02 12:07:22 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:07:22 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:07:24 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:24 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:07:24 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 12:07:24 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:07:24 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:07:24 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:07:24 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmSo0gS_ZWyPLcyg2CRSLMxG20IJAGJQGwXWRDsEIDEIom2-vcOMqurapbDHOaIh8dzf8-deH--wBhdSNSldfjy_pLUdVJGl7i-4Si8xLeoTS-o79KXPz7zhuiWxVlEM7tbH_1r7II6CgAB5GdgMQPQAuI7mL9D8MrwnMAsKMSliW4EVVHV_Q3Qt9Ht5f3PF4Rx1LaXri6iiqI8ERRfEViarCxoDzyOJQmX0YFbc0nmoCxzkkdTBmHa6av0fptZDdxcn-t5IJ2O0SAcutJO26dMJDZZpQcm01q8W_NF7zCPqriKsQATBE5rd9OdjbqWo4vaBypKrovi1A5rP7cPWrDXz3g2OntDUPmLxraLa8cWikfIZfgYTgXIMfHVg3RYHqQArRPvsDS25vKkmJIh71yoZpApDrrgD6Faxs_mKq-U06gtATPnqRLRo8mouJ-a0QjHQBGyi1_xjKrA8qL4x0sW_lQleu7TYIczPdub51FhtExpFdI1_loRFHIqNEu9q5Zy13Z-rjoG9KxVoeVpro3J6Fkq40GV98bt3csVxrckou222XG9B5G7nDAPNmNksfFKyzSYVadQHcqnOx7r4Qil3IMiE1Sn8UjCIYBh65t8HkAwQaRRNUEoD3VzHnUruav5dtQ2Knd0lwBVPtQ24U2FYeexdu5PLRLAINfjPJgCdRfesZMyRyLdsaz2PhQHHz7K0NVKTLSB1iyDyuhp_U7J7pnn2oWS15lqLRl1LDh1Q-uOxqivGUq9gWFusGjUqsDRKOXzU934neaUUN9pdbhZVViW6tDkUyyvfnFx7dF395QPD3yHB8eprknlrShGRuXNt7TG9q7lCaNZHq9bxUPfKDzly6jraQx25zllO_VFOZUB8Wnv0jO00qUPmRQ595_9-870_YhDYj-R4ze-Y2R6dXqGzpniSMCFaYphMulvBaDgDRLWHnywprTa2FvNODO2ZRCpmrACIlLc85Sba1uODXfhqMkSObunWttpgr975M7Eg_Bp4HzloZ3dK7sf_X1yXDUee2IwOf_bzB-1-uSrAIpVsLMZDO0n5dCH9H64_pz94JniyoCYC6Cmeo54s1jNt8HDNDPmauR7yTvzHyYUt85Wyi1y7mx7XwZn5YF3zNYGfqvSf9SSSisqtiIeC3h01GmfKuT6ZVBSbg5T_tT0c919yqNsI_vXmU919Nw9M-mBHAnQ2EMbz4D-CoyWqzzFKyOZ7me-ZTXLeKh58VTHUnxdoe2CxGg4PG3d3O5q366XFdSWQx_erpe-YXh3jIlfPRaO2yeJXBaK0CdC-YznZGVL3OZUjLsPVtV5eeF-PPayTte327GCny6Ea3Lt-KRPz-bxJskrzC43RujnGR8JVbgwCCilg3JvhnyP5LhSbX0t5XtmVnJXA4yPYD2Odwco-rYuPlQbwJlpmDJj6f2Q8_bSULdL4cTLSn4ZWiK4IWGVo7s6nW7mvdNDDcw3BK_n8UFv0tn5IvoOeYwq4Rp24-aby_7scgPod3uGzT50qTWUTTznE6-4mZVxM3alKmt6r3XJU3kex7QY995h5sh8rzeckbuZedovD8iUJLmN2b4aXcMJ-hmL9jY_JPR1a3HdRPTBSruuad_f3u73--uXs6Ama19xTd4mU3mbXv-siuvXiKCs_PY_pze3Os7K6ButUmUhLfj5Ql6652fVVYRu1FW-zGXK_zSY7pKiNqXHZq2IqyTF5V3-WFvrD_NsrtDUNeonB2QAz4oLABmWYxezhsuHgZsXbEJwjyMIBMJnwwKnHUiaa9q_oqZpfzQ7lcN11VF7m3qeEMfm_4z4KRTFxPTFjaMbuvWLfyZT7Pfz_7Bp6iq_2Qw1lRiRrHxeKkQmwb6A6O0kG6iMP6JTCRrLflkUL0x3s7b9bbTUuOu-6v7u-Ecbv0F8-4le1RX-jHLavEta7hobXcrhMSyxR4-bDHf97fe1KVP2vwvxht6W62RR4yOqC731nONpP8tXcIs0_VBv3CXWotn5FJEV05CNI5UQ3Y-eOS7_0YrCDE8b2gfTZBiWAcKC5wVRFJkFFAHPg5fv379W55JN-8AKQghikZuBKA5m3DwCMyRG3CyazwMs8DwbseLL978AyCoZcw.aI3VSg._n0pKh1kGMLqIa4T4E6N7aliiRE'}
2025-08-02 12:07:24 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:07:24 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:07:24 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x07280A38>
2025-08-02 12:07:24 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:24 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:24 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:07:24 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:07:24 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:07:24 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:07:24 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:07:25 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:07:25 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:07:25 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:07:25 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:07:25 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:07:25 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:07:25 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:07:25 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:07:25 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:07:26 - managers.commands_server - DEBUG - Request completed in 1.89s with status 200
2025-08-02 12:07:26 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.731921672821045, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T09:07:25.570307'}, 'success': True}
2025-08-02 12:07:26 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 12:07:26 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 12:07:26 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 12:07:26 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 12:07:26 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 12:07:26 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 12:07:26 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:08:39 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:09:05 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-02 12:11:13 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 12:11:13 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 12:11:13 - auth - INFO - Token[expires_in]: 3599
2025-08-02 12:11:13 - auth - INFO - Token[scope]: https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email openid
2025-08-02 12:11:13 - auth - INFO - Token[token_type]: Bearer
2025-08-02 12:11:13 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMzEwNjg1NTY5OTkxODI5MDU1MCIsImVtYWlsIjoiY2hlbmZlcmFydThAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJkQmVEVDFwTm1lWkNHbjlZY0RtZUNnIiwibm9uY2UiOiI5TVhmRzRNblRCRm9ZZEozc09QRCIsIm5hbWUiOiJjaGVuIGZlcmFydSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMYW9rT3NZV0xSSi1qQjJFYU5PS29EWEFjTmUtVVJlbUIxcG1EV0ZsMmF3TFlTekE9czk2LWMiLCJnaXZlbl9uYW1lIjoiY2hlbiIsImZhbWlseV9uYW1lIjoiZmVyYXJ1IiwiaWF0IjoxNzU0MTI1ODcxLCJleHAiOjE3NTQxMjk0NzF9.S9kaAFgMFKb2tEwPSeYtfnoLQ7kb1s2uNuUY4hDJTRzhzqW0Mg5DorThoKqQhakL4H95AudJk90qNtQYl-YdcLyEw_WirOYVOMzc9Srfz5SUusStKT-AEjW4aXpyUXjgNazkX3CPAbYU770wKYr1y0tGvA949jzorz-gBEWRwJ3Gpd60KlnuIVWiaWlthUAyCqjDxZ54aGZ7mlCe3TJ4xATlYhLu89aGeWetpL-FhE9Bd8yuKc8reGbxVKgCR1KZNAx8awDEqINQ0a54Qd4h1ZZNSeYG3plWZ110ndLywovCV-b3mc9U_dUUCjuC6HP0A_rE-gDPs-BUUJwZLx8xNA
2025-08-02 12:11:13 - auth - INFO - Token[expires_at]: 1754129471
2025-08-02 12:11:13 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '113106855699918290550', 'email': 'chenferaru8@gmail.com', 'email_verified': True, 'at_hash': 'dBeDT1pNmeZCGn9YcDmeCg', 'nonce': '9MXfG4MnTBFoYdJ3sOPD', 'name': 'chen feraru', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c', 'given_name': 'chen', 'family_name': 'feraru', 'iat': 1754125871, 'exp': 1754129471}
2025-08-02 12:11:13 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 12:11:13 - auth - INFO - Decoding ID token for additional 2FA claims...
2025-08-02 12:11:13 - auth - INFO - ID Token Claims Found: {
  "iss": "https://accounts.google.com",
  "azp": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "aud": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "sub": "113106855699918290550",
  "email": "chenferaru8@gmail.com",
  "email_verified": true,
  "at_hash": "dBeDT1pNmeZCGn9YcDmeCg",
  "nonce": "9MXfG4MnTBFoYdJ3sOPD",
  "name": "chen feraru",
  "picture": "https://lh3.googleusercontent.com/a/ACg8ocLaokOsYWLRJ-jB2EaNOKoDXAcNe-URemB1pmDWFl2awLYSzA=s96-c",
  "given_name": "chen",
  "family_name": "feraru",
  "iat": 1754125871,
  "exp": 1754129471
}
2025-08-02 12:11:13 - auth - INFO - Checking ID token claims for 2FA indicators...
2025-08-02 12:11:13 - auth - INFO - ID Token AMR: []
2025-08-02 12:11:13 - auth - INFO - ID Token ACR: None
2025-08-02 12:11:13 - auth - INFO - ID Token issued at: 2025-08-02 12:11:11, age: -1 day, 21:00:02.628619
2025-08-02 12:11:13 - auth - INFO - Fresh authentication detected with forced login (high confidence 2FA)
2025-08-02 12:11:13 - auth - INFO - User likely went through Google 2FA during forced re-authentication
2025-08-02 12:11:13 - auth - INFO - Google 2FA detection for chenferaru8@gmail.com:
2025-08-02 12:11:13 - auth - INFO -   Used 2FA: True
2025-08-02 12:11:13 - auth - INFO -   Method: forced_fresh_auth
2025-08-02 12:11:13 - auth - INFO -   Confidence: high
2025-08-02 12:11:13 - auth - INFO - User chenferaru8@gmail.com authenticated with Google 2FA (forced_fresh_auth)
2025-08-02 12:11:14 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:11:14 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:11:14 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:11:14 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVceS4zgW_JWOOg-rCBpJ7IiNWIpGllTRm4uCBCF6UzSimeh_X7C6p7tndw972CMfgHyZiUfkny_UI7iXqE_q6OXrS1zXcYHuj7qFKLo_WtQl92Dok5c_Pvc9UZs-UoR39u2A_l67Bz0GoEiKJcgdQVImyX0F4CugX3csoMAGQ9wb1JZBhar-L4ChQ-3L1z9fAghR1937OkcVRpkDinsNSN6gjxt16cLFusV32iLO9OLIamAsExx1VE3C6PJ3Bd2Fm3xyWBD2tcXEk2T1YEtZps03BiENcTSrsbARWRNutHdKCZ-3W36tCiOi9cVyDTBGlcQcbUwzPE3vFtTIeSr3hOpowXvqUud6i8TddhZn0Tirm2P_0Js79Pnk2TJEKxAbLRBi78JbucHrJ0PWjgeXUlIjPIVVUU-tewH0mC1WqoZ-TIIti51AU5Nicz89wxUGUByzBb_qKXaBZjnuj5c0-ukKms9JeIDpLT0b1nICanrqTmXf-MJpcyr1XDWVUTFPo3rwM8XRKM_c52qWZOoSL56pAI9SWG-RRi87Ad-US_UgpVfhTCKXXzEvNtDSh_aK2zSQVtZSHR31ES7180rJmUdxIKz05VpGz5CKOt9gs5AiV4gEVSvEaVJEa7mZ8ahk0qKKCnN1eTKofEoVo1ahot6j7cxfKZYkCFyP8aiEVA7RCJ0EXEt5hEdl8Cnu6VNTEblqAUv1iXsWYaUNuH9_SsfUc-38lNWpYvJAWXJGEXHfRVtuAsDSGyrKNDpY1Cp0VCzZmhXR71WnoG4HtY7EfQWPch0ZbAKP-19aXHvx3TPWw5K-w5LXta-B7a0wRortzSTcQxrVLAaq6bE3M59u4onFeoEirNdg955TdCsvrKkISx9zl-fITHifAkngjD_5-876PT2i0p4Dx298R0tvlT5HjoVxZNKlkgRS8ep_rpW2ZIvyaJagcHL1GGaF75F671tqtWKFJYdxrdV71rSTUl90NSx0QS8535fqBZKcpn_yY5PQWfeds-BgD6fDD36fGveNR-sAlta_3flUKzNbhRRXhQcbQMqesYYhwucj4fPun57B7TUKMiGlKp7DtSat-jY5GUYKPrTsLHsW-25QnORIcmaWVm_b5yK0ThM8AMkm_U4pZdqUCxPlEgeXnLo6yjpPVeD6RVhgbQ4ofnr6Oe4-1lF0yP615mMfPfcMVj8CRyZxbVIXi8S_AriJcMJ4BTri-cwkWjW1SclyUl1k7tXg8oCXY0W-hFQvje8G8vpHVV-1bR6CjhrUwfKYRDyb-pIsHw6pxKxYt2ZSXz60JMivzJFj-SE65xz5ofaaVxBeBK-zNN6dtL159k1ZIGe0j4U1rKEz-otJ8FLmMIHbzJabxWqw5C4tvPOhZ2235HjxWjCT_eHJcwyXLXW7EPFecvTxTB-aaENeimo42Q4WWfSJxc_CRyZOPssEB39bFgKizTMz8WbhJddhxwUH5KC-uRJyInH7aDcPF7hr0SGc7Ess6ODiq_y0C0ZR-jipGhmwjBYxCfB9FftwoJvC8QEgq-g6j_VTsImQLiFn3SPLErJB2BzfSf7eSkQsvnfE3rLOo3-ddpPK49etg3WD8IOV9H3TfX17G8fx9XuyBE3avcK6fFtD5W19_dPqUb82bf1IC_Tlfz6AyiAtvuAuVRrhhp8v5L2fP7vuUdDiVPkeLuvuz4Dp70nQJXg52iPRBI1aIl84VJwHxRIJMd4eDGsCApKluR1JAZqhd0TDZM8ns83puIQDRBS5Kdn0uYNJT8bNRzK8Bk3T_aC6toN11eN4WxmviEvzf0b81I0xIX5xH6gN2mH3z3it_b7-HzGNU-XvMfMIyrSY71VQroZ9B8Kn4_SJbfxRXVvgWvorotjdejbtut-uFgd3PVT9X4x_0PgN4stP9Kqu4FrlFPdxYJTK3Mu1F53p7vYu4uUmhf3Q_j42RUL_dyPegjdeiHc1vAZ1fus856qfiWxPSYF6u9Siy0MVEZaOyj1oStGRCyoYr56x8P_ouA0B1wkdwvVmAA3IzY5lNxzHgR3FkSxLvnz79n107uk6D_RmE5EPjiFI9AgJZotIIuAQQ6DtNoQblqURzb18-xfVXxdc.aI3WMg.fiXbQUcpaq25Wj8-HBfkGbgm1lI'}
2025-08-02 12:11:14 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:11:14 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:11:14 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x010133F0>
2025-08-02 12:11:14 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:11:14 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:11:14 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:11:14 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:11:14 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:11:14 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:11:14 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:11:15 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:11:15 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:11:15 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:11:15 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:11:15 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:11:15 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:11:15 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:11:15 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:11:15 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:11:15 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:11:15 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:11:15 - managers.commands_server - DEBUG - Performing health check...
2025-08-02 12:11:15 - managers.commands_server - INFO - Checking commands server health
2025-08-02 12:11:15 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-02 12:11:15 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-02 12:11:15 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.3855438232421875e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-02T09:11:15.212535'}, 'success': True}
2025-08-02 12:11:15 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-02 12:11:15 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-02 12:11:15 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-02 12:11:15 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010528564453125,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:11:15.365747"
  },
  "success": false
}

2025-08-02 12:11:15 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010528564453125,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:11:15.365747"
  },
  "success": false
}

2025-08-02 12:11:15 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010528564453125,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-02T09:11:15.365747"
  },
  "success": false
}

2025-08-02 12:11:15 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-02 12:11:15 - services.base - INFO - Service operation completed: start_session
2025-08-02 12:11:17 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:11:17 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:11:17 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-02 12:11:17 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:11:17 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:11:17 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:11:17 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVceS4zgW_JWOOg-rCBpJ7IiNWIpGllTRm4uCBCF6UzSimeh_X7C6p7tndw972CMfgHyZiUfkny_UI7iXqE_q6OXrS1zXcYHuj7qFKLo_WtQl92Dok5c_Pvc9UZs-UoR39u2A_l67Bz0GoEiKJcgdQVImyX0F4CugX3csoMAGQ9wb1JZBhar-L4ChQ-3L1z9fAghR1937OkcVRpkDinsNSN6gjxt16cLFusV32iLO9OLIamAsExx1VE3C6PJ3Bd2Fm3xyWBD2tcXEk2T1YEtZps03BiENcTSrsbARWRNutHdKCZ-3W36tCiOi9cVyDTBGlcQcbUwzPE3vFtTIeSr3hOpowXvqUud6i8TddhZn0Tirm2P_0Js79Pnk2TJEKxAbLRBi78JbucHrJ0PWjgeXUlIjPIVVUU-tewH0mC1WqoZ-TIIti51AU5Nicz89wxUGUByzBb_qKXaBZjnuj5c0-ukKms9JeIDpLT0b1nICanrqTmXf-MJpcyr1XDWVUTFPo3rwM8XRKM_c52qWZOoSL56pAI9SWG-RRi87Ad-US_UgpVfhTCKXXzEvNtDSh_aK2zSQVtZSHR31ES7180rJmUdxIKz05VpGz5CKOt9gs5AiV4gEVSvEaVJEa7mZ8ahk0qKKCnN1eTKofEoVo1ahot6j7cxfKZYkCFyP8aiEVA7RCJ0EXEt5hEdl8Cnu6VNTEblqAUv1iXsWYaUNuH9_SsfUc-38lNWpYvJAWXJGEXHfRVtuAsDSGyrKNDpY1Cp0VCzZmhXR71WnoG4HtY7EfQWPch0ZbAKP-19aXHvx3TPWw5K-w5LXta-B7a0wRortzSTcQxrVLAaq6bE3M59u4onFeoEirNdg955TdCsvrKkISx9zl-fITHifAkngjD_5-876PT2i0p4Dx298R0tvlT5HjoVxZNKlkgRS8ep_rpW2ZIvyaJagcHL1GGaF75F671tqtWKFJYdxrdV71rSTUl90NSx0QS8535fqBZKcpn_yY5PQWfeds-BgD6fDD36fGveNR-sAlta_3flUKzNbhRRXhQcbQMqesYYhwucj4fPun57B7TUKMiGlKp7DtSat-jY5GUYKPrTsLHsW-25QnORIcmaWVm_b5yK0ThM8AMkm_U4pZdqUCxPlEgeXnLo6yjpPVeD6RVhgbQ4ofnr6Oe4-1lF0yP615mMfPfcMVj8CRyZxbVIXi8S_AriJcMJ4BTri-cwkWjW1SclyUl1k7tXg8oCXY0W-hFQvje8G8vpHVV-1bR6CjhrUwfKYRDyb-pIsHw6pxKxYt2ZSXz60JMivzJFj-SE65xz5ofaaVxBeBK-zNN6dtL159k1ZIGe0j4U1rKEz-otJ8FLmMIHbzJabxWqw5C4tvPOhZ2235HjxWjCT_eHJcwyXLXW7EPFecvTxTB-aaENeimo42Q4WWfSJxc_CRyZOPssEB39bFgKizTMz8WbhJddhxwUH5KC-uRJyInH7aDcPF7hr0SGc7Ess6ODiq_y0C0ZR-jipGhmwjBYxCfB9FftwoJvC8QEgq-g6j_VTsImQLiFn3SPLErJB2BzfSf7eSkQsvnfE3rLOo3-ddpPK49etg3WD8IOV9H3TfX17G8fx9XuyBE3avcK6fFtD5W19_dPqUb82bf1IC_Tlfz6AyiAtvuAuVRrhhp8v5L2fP7vuUdDiVPkeLuvuz4Dp70nQJXg52iPRBI1aIl84VJwHxRIJMd4eDGsCApKluR1JAZqhd0TDZM8ns83puIQDRBS5Kdn0uYNJT8bNRzK8Bk3T_aC6toN11eN4WxmviEvzf0b81I0xIX5xH6gN2mH3z3it_b7-HzGNU-XvMfMIyrSY71VQroZ9B8Kn4_SJbfxRXVvgWvorotjdejbtut-uFgd3PVT9X4x_0PgN4stP9Kqu4FrlFPdxYJTK3Mu1F53p7vYu4uUmhf3Q_j42RUL_dyPegjdeiHc1vAZ1fus856qfiWxPSYF6u9Siy0MVEZaOyj1oStGRCyoYr56x8P_ouA0B1wkdwvVmAA3IzY5lNxzHgR3FkSxLvnz79n107uk6D_RmE5EPjiFI9AgJZotIIuAQQ6DtNoQblqURzb18-xfVXxdc.aI3WMw.L_FzBRdGQeegF1TrNGk5BmAda_g'}
2025-08-02 12:11:17 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:11:17 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:11:17 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x01027ED0>
2025-08-02 12:11:17 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:11:17 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:11:17 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:11:17 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-02 12:11:17 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:11:17 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:11:17 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-02 12:11:18 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:11:18 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-02 12:11:18 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-02 12:11:18 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-02 12:11:18 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-02 12:11:18 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-02 12:11:18 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-02 12:11:18 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-02 12:11:18 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-02 12:11:18 - managers.commands_server - DEBUG - Request completed in 1.91s with status 200
2025-08-02 12:11:18 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Unknown', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7656543254852295, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-02T09:11:18.471675'}, 'success': True}
2025-08-02 12:11:18 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-02 12:11:18 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-02 12:11:18 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-02 12:11:19 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-02 12:11:19 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-02 12:11:19 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-02 12:11:19 - services.base - INFO - Service operation completed: scan_network
2025-08-02 12:11:29 - auth - INFO - === GOOGLE OAUTH TOKEN ANALYSIS ===
2025-08-02 12:11:29 - auth - INFO - Token keys: ['access_token', 'expires_in', 'scope', 'token_type', 'id_token', 'expires_at', 'userinfo']
2025-08-02 12:11:29 - auth - INFO - Token[expires_in]: 3599
2025-08-02 12:11:29 - auth - INFO - Token[scope]: https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile openid
2025-08-02 12:11:29 - auth - INFO - Token[token_type]: Bearer
2025-08-02 12:11:29 - auth - INFO - Token[id_token]: eyJhbGciOiJSUzI1NiIsImtpZCI6ImRkNTMwMTIwNGZjMWQ2YTBkNjhjNzgzYTM1Y2M5YzEwYjI1ZTFmNGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxMDUzOTgwMjEzNDM4LXA0anZ2NDdrM2dtY3VjZTIwNm01aXY4Y2h0MGdwcWh1LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiMTA1Mzk4MDIxMzQzOC1wNGp2djQ3azNnbWN1Y2UyMDZtNWl2OGNodDBncHFodS5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjEwNDU2NTQxNjgyOTg2NDMwMjU1OSIsImVtYWlsIjoibm9hc2hwaXJlcjZAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJhQmxhNGl1bGI1TFJRT0d0UmxGdzN3Iiwibm9uY2UiOiJWYXZPcWZ1UGcyV1dwcXhtTGlkVCIsIm5hbWUiOiLXoNeV16LXlCDXqdek15nXqNeoIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0pVVDlkU0dyRWxTb3h3VWdtUlo2YThHM1JkV1lSZVlSWlVYSHRnUG5wZmxsVlFyQT1zOTYtYyIsImdpdmVuX25hbWUiOiLXoNeV16LXlCIsImZhbWlseV9uYW1lIjoi16nXpNeZ16jXqCIsImlhdCI6MTc1NDEyNTg4OSwiZXhwIjoxNzU0MTI5NDg5fQ.buelJ6HoZmMT75b3hQXNmJ_W_jIQStFIWyzo3YabLuGAIAwwIMardufJlTYtwRB31zxiUVXoALLqDAJ0itagvzkqM9INcjm24gNPo0e8q8WWHxdaqJKJ-3K3ColbnEr0Ye3QASGpjwJR9a_uFNnyUpp14OxADq7OJdZzkcPrEVzhCUaNd9cAaxnGQyilAYrH41ZgwHL1CY0sLG3psrpT_OJDHPhXnyNjbQOcIgB6gIE_wVQGHROQ0e2tdV2QE8wXS4I-qqACuBNcdN2KICu6zCSEzDVC3o2S66aR4tsLzVsSB4iGeF0qRccboYdF_dZ7MMWMMQ07iAYYRwcxdYUlCA
2025-08-02 12:11:29 - auth - INFO - Token[expires_at]: 1754129488
2025-08-02 12:11:29 - auth - INFO - Token[userinfo]: {'iss': 'https://accounts.google.com', 'azp': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'aud': '1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com', 'sub': '104565416829864302559', 'email': 'noashpirer6@gmail.com', 'email_verified': True, 'at_hash': 'aBla4iulb5LRQOGtRlFw3w', 'nonce': 'VavOqfuPg2WWpqxmLidT', 'name': ' ', 'picture': 'https://lh3.googleusercontent.com/a/ACg8ocJUT9dSGrElSoxwUgmRZ6a8G3RdWYReYRZUXHtgPnpfllVQrA=s96-c', 'given_name': '', 'family_name': '', 'iat': 1754125889, 'exp': 1754129489}
2025-08-02 12:11:29 - auth - INFO - === END OAUTH ANALYSIS ===
2025-08-02 12:11:29 - auth - INFO - Decoding ID token for additional 2FA claims...
2025-08-02 12:11:29 - auth - INFO - ID Token Claims Found: {
  "iss": "https://accounts.google.com",
  "azp": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "aud": "1053980213438-p4jvv47k3gmcuce206m5iv8cht0gpqhu.apps.googleusercontent.com",
  "sub": "104565416829864302559",
  "email": "noashpirer6@gmail.com",
  "email_verified": true,
  "at_hash": "aBla4iulb5LRQOGtRlFw3w",
  "nonce": "VavOqfuPg2WWpqxmLidT",
  "name": "\u05e0\u05d5\u05e2\u05d4 \u05e9\u05e4\u05d9\u05e8\u05e8",
  "picture": "https://lh3.googleusercontent.com/a/ACg8ocJUT9dSGrElSoxwUgmRZ6a8G3RdWYReYRZUXHtgPnpfllVQrA=s96-c",
  "given_name": "\u05e0\u05d5\u05e2\u05d4",
  "family_name": "\u05e9\u05e4\u05d9\u05e8\u05e8",
  "iat": 1754125889,
  "exp": 1754129489
}
2025-08-02 12:11:30 - auth - INFO - Checking ID token claims for 2FA indicators...
2025-08-02 12:11:30 - auth - INFO - ID Token AMR: []
2025-08-02 12:11:30 - auth - INFO - ID Token ACR: None
2025-08-02 12:11:30 - auth - INFO - ID Token issued at: 2025-08-02 12:11:29, age: -1 day, 21:00:01.107052
2025-08-02 12:11:30 - auth - INFO - Fresh authentication detected with forced login (high confidence 2FA)
2025-08-02 12:11:30 - auth - INFO - User likely went through Google 2FA during forced re-authentication
2025-08-02 12:11:30 - auth - INFO - Google 2FA detection for noashpirer6@gmail.com:
2025-08-02 12:11:30 - auth - INFO -   Used 2FA: True
2025-08-02 12:11:30 - auth - INFO -   Method: forced_fresh_auth
2025-08-02 12:11:30 - auth - INFO -   Confidence: high
2025-08-02 12:11:30 - auth - INFO - User noashpirer6@gmail.com authenticated with Google 2FA (forced_fresh_auth)
2025-08-02 12:11:31 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-02 12:11:31 - endpoints.settings - INFO - Request method: GET
2025-08-02 12:11:31 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-02 12:11:31 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVtmuo0gW_JXSfW7fm6yGkkYavGGwSV_2RSNZQGIWsy8G06p_n8TV3VWjaanmYV4QzgzHiRMcMvj9jbz51yLqkwq9fX2LqyrOo-utasMIXW9t1CVXf-iTt99euEfUprc0wsi-HaL_XLv6PSYgAcmsALcCpAH4rwTxlQLvFEmvWQZTXOuoLfwyKvs_CYYuat--_v7mh2HUdde-ukclZnn6JP8uAEGnjiyck6rhQLY5jTAQN4dcBZ_0eruPjvs0L09Tszp_Alsk2Q1nPBpD244DBXP2Vikx0uCq22wOxSFr6i3Vn7qJPQgIAuo8oftp6_CnqslKKZ32qBnVB0fn7d6RbJ9yiuEoX47oudJWh_tDmKHQbVBzbSbRkAMtGGYoTWuT6OFwgo85E_3WvA_AXfWxTFPy-hmDx_mqMChIL7S_jd2TYCi6oLn6QT2KDqmkm-06Xbc3sb4j0arPOrfnvGsMSMBio6KpTrH3L0uJNUMTJE9z3I_1FJtEMTz_21uK_jItespJIIbpJZV1c5YImEqdVPS1t5VYqdDu0FBGxZBGKHqZYquka2zuMEsyOMezayiESyqMO-9HN5MIzzgUUNyn560MIkdYOE8WoaY39R2XqUNKWZYqdNTGcK4eZ_KQuSRPBKU2nwv0CEjUeTqTBSRYKJKoXCikSdmZ88WIRyXbz3Cn0GdHAH7pkXCHWoVEvUtZmbdILADhOy7tkglQRDSGdkKci8MYHpXBI_mHR045cmAeFvCBa-ZBqQ64fi-lY-o61l3KqlQxBEKZ77Syw3Vndb5sCdx6TaJMpfwZloENccvmU9l5PbRz8iLCCu02ZXg8VEhnkvC4-dGLY82eI-N-GODZDDgvdXVsb4k5Umxvth_hziShoU4wi5-4R9wTtjszicuCK6zetfNu0RUUfBKSyeg7ch5mnuCRROLb41_6PXv5Pd1QYT1926s9W00vpfZEtol5DsAhE_z_ePE_UYspgWJOBKJEGAdZMwACZjGJaIbUwoVrYV5zwdqu432GtkeYYvi0COypk_SGmN-t7aKPSQJ7wZ2dCkYWwZ6dfLtzGhTdCaZ0GhhVC18o5hk6Wk9PX0YqAQh7dEm5RyDGv_CKT87gsPPm5OGC2rJ2-d0E6KnZkxFQCWXZqDfzCo9kclQI-W4Rue5ZuW7nlqsftdIUmdErps7KD0_VIPAMub37XHSjGvs0OOTf6V_2Pbyed5GFfbCJfPGfYEunhpFHsJnTvDB5gvArohghAXf7JzRi-qLj5-AkI8ZPcDYBfm0YuIsZPP7BEOUye6y8QjHWDBavOrCQr_Y1k1S9P0j2c64o1w_OgyhIwjhKit-i4SbnWPKobShinlLTcirhfG52ggzS3o8f871ReAmGWUHSMfysQMQ1nG0fJ-Q38kleUSdqW-Ep37fAjShV0MU6G2WN96_DAZZPs64J-jIJu2Z9kZE338PPdm_Nydb0IeJDwZ9KUX2mueC2R5rw4vF4JrYu6M4iVXdtbVwv8u74mTjlE2aBegmleMPG0v46Wqp41C4qiMgeWaS650ZHp6VV0wjbYQNDBMmTtB3Yeavv5521pSpSZ1lfo_vuPFudvqFTMTqARgvDoHLR4Yq8taLYiqKCdSq4Lj48JuSa-VbAZ14XVnWEj7Gk7-vu68fHOI7v3-PIr9PuPayKjyWJPpbISMtb9R4Vfpp_-Z_hdVvd0jz6gquUKcIFX-fmtX--qm4iv8VR9D2RFvwrlfpr4ncJ3vY3uU-nQx4wZ029iL2WH0ZqxHB_WGKTAAzFc4AkKJriVjWdPR70-k7FRTiEET7SCyZ9cGHSg7hukuHdr-vuD7FLubAqe5yJi-aFca7_z4wvozBnWeFmlgBp2X_Gy9rP-_-V7ThrfgofHDU3v0jz57X0i8Wwfw2AifjXlV6u6Ps99_2KWeP0ge39GQ1eOOZ1T77uaYxLf4Qcwy110q77aQzwl0E1lP2f3f0h-Re0X36prqzKcGGw_MeluQ2fMWnbdTMV5xQZeLtOw35ofx7HPKH-3uAP_0PYxlwVyqbBI11s97leTaMZF5rH-pxIach2tcjVPNM59vFnWd_y3FJb4R8dz67CZfKH4PXEaYbFLrAcyXMsTeEPKYZ_-_bt-0he02XOwjUPeNa_rYKQ4Vf0DdArDoXcimUo3w9plqKY6O3bvwGF_0Y5.aI3WQw.Vl1nA7elKzkWl-VJEChuq4ZZ8vU'}
2025-08-02 12:11:31 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-02 12:11:31 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-02 12:11:31 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x0103A600>
2025-08-02 12:11:31 - endpoints.settings - INFO - User ID from session: c79096af-bc59-4f04-8dc8-653aac46335e
2025-08-02 12:11:31 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=c79096af-bc59-4f04-8dc8-653aac46335e
2025-08-02 12:11:31 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-02 12:11:31 - services.settings_service - INFO - Input parameter - user_id: c79096af-bc59-4f04-8dc8-653aac46335e
2025-08-02 12:11:31 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-02 12:11:31 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-02 12:11:31 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=c79096af-bc59-4f04-8dc8-653aac46335e, setting_key='routerId')
2025-08-02 12:11:31 - services.settings_service - INFO - No UserSetting record found for this user
2025-08-02 12:11:31 - services.settings_service - INFO - This means the user has never saved a router ID before
2025-08-02 12:11:31 - services.settings_service - INFO - Checking UserRouter table for additional verification...
2025-08-02 12:11:31 - services.settings_service - INFO - Found 0 active UserRouter records for user
2025-08-02 12:11:31 - services.settings_service - INFO - === get_router_id_setting completed - no routerId found ===
2025-08-02 12:11:31 - endpoints.settings - INFO - Service call completed - result: None, error: No routerId found for user
2025-08-02 12:11:31 - endpoints.settings - WARNING - Service returned error: No routerId found for user
2025-08-02 12:11:31 - endpoints.settings - INFO - No router ID found for user c79096af-bc59-4f04-8dc8-653aac46335e - this is normal for first-time users
2025-08-03 14:57:00 - 2fa_service - INFO - Backup code used for user d27c4aa2-1566-4112-8236-ee23ab685be7. Remaining codes: 1
2025-08-03 14:57:00 - 2fa_service - WARNING - Backup code not found or already used for user d27c4aa2-1566-4112-8236-ee23ab685be7
2025-08-03 14:57:00 - 2fa_service - WARNING - Backup code not found or already used for user d27c4aa2-1566-4112-8236-ee23ab685be7
2025-08-03 15:05:17 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:05:21 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:05:50 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:05:50 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:05:50 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:05:50 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmum9oS_ZXI43AObAyYSFe6tmltg43pDBNr05i-ObSGKP9-N05ucvT0Bm_whtQu1qq1qlT1fXWvw6aAZVh2q29d04dfV30bNqtv31fQ98O2vXdVFparb6sJAvYN4ludlGh1qrjJfqRNdcpljNbO9EVkoGXLeMNj-DbYXOZQsUA-xM-rIUwSk2kMzC09pmJKvAMeyu1pmFnMww1h5ETliDcsZn8UUTfYD_GQmsV13DXnhMmix9WU4shMSYUmSXHHXtYm_kEyhvNgcgtAN9_DnQkO51xhIsBmtnTe8BH_2MEt3EfOcQtHfXuVdUGTxBtQknD9aNna9HkGF7jYSPf803C3OMEwq6-r8FknTdjeIfKCYKg1ADS5pv7EE-QDSbGbr6sk-O1LOB1iT_STc3LQzVkm1ERu5aKr3b1My8U1Uw1lVAx5VEU3VWwNOMYuU9M4VedodgyFcIBCOTM_OqlMuIZQqCKfnPYHPLxtF8yjRWjJQ3tDNLVPKkuoCqTr6M_VcAJC6gCW8MrrfCqCwQNB6-pU6gF8gYjDcoGQnwpnzmcjGpWUn1VOWZ9uWxyWLlC5oFFA0DmklbpLiQVOwJuzdkCMK2Iw-nZMnAph9CWldwE7uOCZBzc19wt1QJy5V2o94u_kZEycm5XJaZUoxpZQ5mytcIh31ubznkDSaxCkGglntfRsFUk2J4VzO9XOwVlUq4Dblb4kVIFOxb60-6PlZs3u7YD0ULhrU_hp4dWRvSXCSJC9KY84-FFNI0I1HOpsZM8zJ1NIL6HslzZYnWPn7VIX0pR7hYtqF6bAiLcuIGJoj7_rd-3l-_kICmuCtlu7tpacy-sU2CbCEfAbiGMfRIv_tI4TvGltO5-PDQ_PY59wVYPzcacIygXLK1iEay65dXizZM1QdTU3nyivV-e88nhtrb_qo2LPfuWlULR6WfxV30vjrnbIK-EX5n_0_FkpE1V6gC090SJ8YE1IQx-g_4P9q_eDo7M7DfhrD6iKY7ONQaquhT91PSE-tPQgOCZ10QHL27yQGoXZWdYh90z56YsEb-FuqxQCaQi5EWY8688ZONnKMk8lvLm5lyNtNpH_9vQ17i7Skbeh9efNRT46twOx-AFtAUexpzqbuJLKkzprJMLLQwnNZ8qTqqFNSuqg2QzYN6cMbfN4jK8qOzjKvfTYScq8kQcFj_GWchRv-KlNu3acwH1v3LxNcy-Ms9VChrzsj81GVyjfNNSe-7C3enLYpUCaLlChnZbfVy2tyOWHzQ2uyAxjwjM6hgaZMT4a02JYs7tXqlc4D27DjvN1ysRbcPVybrhXA6bkWeoIENtZUZIR3NV0g8cBj-rMDvfSoMN9UNMxscuuwIBdl4oa5VjPVIzauCTP26YEXqpgXfmh1Z0cHpLzVYg9i7j3F_cwxERBirhdeTKa8jtbZhDJHXZorZ0OxKm_5Brpk0Tp5AGnqwcCJ8YPg8NTGtaRejxKQDC5IasPWD6yVpymaBa45kzllaSKUnrEUl9D2631qzpECyvuurr99v4-juNbVFVRHsI6ad_8qniHfRe_L_s_KR_VW1jAJP_yP6fXTfVI8vALYimTABG-NuS9m16suxA26K78PC9L_uvEdPcYtjF6no8Kp12wWtIrGbaWcmLWXhShdNgH6JnAKZLd4IAg1-QGq9fpMKyZjIwKv_dDgNMFlQwbP-5QPz7i_g3Wdfur2IXOr8oOHbil5gVxrv_PiC-jEKaPNu4jbGDTb_6Oltjn9_uAdD-SMPj3zqKr8unMMF9XD1gk-XQvYbEY9hMI_R0lA7LxV3ShQLHkz4kCzPJv0rafWotOd9WX3b8V_yrjE8SX3-hlVfpLNJl6aUteaZNorZJh45zbSOi5Tvyubz6PTR6T_92Id_i-3Uebyj_BKju3jn26HrB0h669ej5W3G3rqyFmXsNiR9QFZws5gOPJ0eftXy1LY_4yob23dIYgCZzeUBTNsiyxASxOUfjqx4-fo3NPlnkgaTrAH-waw8OHh62ZEMcgG66xkGE8n6YoMiTZ1Y9_AN8y8-0.aI9Qng.gW2TJ6zZXqBqMkEIPmCrXbpluIY'}
2025-08-03 15:05:50 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:05:50 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:05:50 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x070460D8>
2025-08-03 15:05:50 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:05:50 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:05:50 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:05:50 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:05:50 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:05:50 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:05:50 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:05:50 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:05:50 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:05:50 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:05:50 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:05:50 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:05:50 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:05:50 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:05:50 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:05:50 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:05:51 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:05:51 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:05:51 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:05:51 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:05:51 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:05:51 - managers.commands_server - DEBUG - Request completed in 0.23s with status 200
2025-08-03 15:05:51 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.00032973289489746094, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:05:51.820985'}, 'success': True}
2025-08-03 15:05:51 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:05:51 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:05:51 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:05:51 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:05:51 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:05:51 - managers.commands_server - DEBUG - Request completed in 0.17s with status 400
2025-08-03 15:05:51 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0015659332275390625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:05:52.130742"
  },
  "success": false
}

2025-08-03 15:05:51 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0015659332275390625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:05:52.130742"
  },
  "success": false
}

2025-08-03 15:05:51 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0015659332275390625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:05:52.130742"
  },
  "success": false
}

2025-08-03 15:05:51 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:05:51 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:05:52 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:05:52 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:05:52 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:05:52 - managers.commands_server - DEBUG - Request completed in 0.38s with status 500
2025-08-03 15:05:52 - managers.commands_server - ERROR - Commands server returned 500: {
  "data": null,
  "error": {
    "code": "COMMAND_FAILED",
    "details": null,
    "message": "Command failed: Failed to get ARP table: Channel closed."
  },
  "metadata": {
    "executionTime": 0.22171473503112793,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:05:53.361662"
  },
  "success": false
}

2025-08-03 15:05:52 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/network/scan': Commands server returned 500: {
  "data": null,
  "error": {
    "code": "COMMAND_FAILED",
    "details": null,
    "message": "Command failed: Failed to get ARP table: Channel closed."
  },
  "metadata": {
    "executionTime": 0.22171473503112793,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:05:53.361662"
  },
  "success": false
}

2025-08-03 15:05:52 - services.base - ERROR - Service operation failed: scan_network - Commands server returned 500: {
  "data": null,
  "error": {
    "code": "COMMAND_FAILED",
    "details": null,
    "message": "Command failed: Failed to get ARP table: Channel closed."
  },
  "metadata": {
    "executionTime": 0.22171473503112793,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:05:53.361662"
  },
  "success": false
}

2025-08-03 15:05:53 - managers.commands_server - DEBUG - Request completed in 2.42s with status 200
2025-08-03 15:05:53 - managers.commands_server - DEBUG - Received response: {'data': {'infrastructure_ready': True, 'message': 'Session established successfully', 'router_reachable': True, 'session_id': '366d0f94-0efb-47e0-a9e4-e77bc6553e39'}, 'error': None, 'metadata': {'executionTime': 2.267270088195801, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:05:54.294384'}, 'success': True}
2025-08-03 15:05:53 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/session/start'
2025-08-03 15:05:53 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: {'infrastructure_ready': True, 'message': 'Session established successfully', 'router_reachable': True, 'session_id': '366d0f94-0efb-47e0-a9e4-e77bc6553e39'}, error: None
2025-08-03 15:05:53 - services.commands_server_operations.session_execute - INFO - Session started successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:05:53 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:05:59 - twofa_endpoints - INFO - 2FA setup started for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:10:16 - twofa_endpoints - ERROR - 2FA setup verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: (psycopg2.errors.UndefinedColumn) column "updated_at" of relation "user_2fa_attempts" does not exist
LINE 1: ... success, ip_address, user_agent, id, created_at, updated_at...
                                                             ^

[SQL: INSERT INTO user_2fa_attempts (user_id, attempt_type, success, ip_address, user_agent, id, created_at, updated_at) VALUES (%(user_id)s, %(attempt_type)s, %(success)s, %(ip_address)s, %(user_agent)s, %(id)s::UUID, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING user_2fa_attempts.created_at, user_2fa_attempts.updated_at]
[parameters: {'user_id': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'attempt_type': 'totp', 'success': True, 'ip_address': '127.0.0.1', 'user_agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'id': UUID('8c7be9a0-9f60-4b94-ae6a-4577f3a80588')}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-03 15:10:24 - twofa_endpoints - ERROR - 2FA setup verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: (psycopg2.errors.UndefinedColumn) column "updated_at" of relation "user_2fa_attempts" does not exist
LINE 1: ... success, ip_address, user_agent, id, created_at, updated_at...
                                                             ^

[SQL: INSERT INTO user_2fa_attempts (user_id, attempt_type, success, ip_address, user_agent, id, created_at, updated_at) VALUES (%(user_id)s, %(attempt_type)s, %(success)s, %(ip_address)s, %(user_agent)s, %(id)s::UUID, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING user_2fa_attempts.created_at, user_2fa_attempts.updated_at]
[parameters: {'user_id': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'attempt_type': 'totp', 'success': True, 'ip_address': '127.0.0.1', 'user_agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'id': UUID('f2228638-1aba-40aa-b748-16aa680617bc')}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-03 15:10:38 - twofa_endpoints - ERROR - 2FA setup verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: (psycopg2.errors.UndefinedColumn) column "updated_at" of relation "user_2fa_attempts" does not exist
LINE 1: ... success, ip_address, user_agent, id, created_at, updated_at...
                                                             ^

[SQL: INSERT INTO user_2fa_attempts (user_id, attempt_type, success, ip_address, user_agent, id, created_at, updated_at) VALUES (%(user_id)s, %(attempt_type)s, %(success)s, %(ip_address)s, %(user_agent)s, %(id)s::UUID, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING user_2fa_attempts.created_at, user_2fa_attempts.updated_at]
[parameters: {'user_id': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'attempt_type': 'totp', 'success': True, 'ip_address': '127.0.0.1', 'user_agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'id': UUID('42e32d13-38f0-4af8-a445-f28eedc202c4')}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-03 15:11:21 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:11:54 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:14:47 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:14:50 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:15:01 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:15:01 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:15:01 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:15:01 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmum9oS_ZXI43AObAyYSFe6tmltg43pDBNr05i-ObSGKP9-N05ucvT0Bm_whtQu1qq1qlT1fXWvw6aAZVh2q29d04dfV30bNqtv31fQ98O2vXdVFparb6sJAvYN4ludlGh1qrjJfqRNdcpljNbO9EVkoGXLeMNj-DbYXOZQsUA-xM-rIUwSk2kMzC09pmJKvAMeyu1pmFnMww1h5ETliDcsZn8UUTfYD_GQmsV13DXnhMmix9WU4shMSYUmSXHHXtYm_kEyhvNgcgtAN9_DnQkO51xhIsBmtnTe8BH_2MEt3EfOcQtHfXuVdUGTxBtQknD9aNna9HkGF7jYSPf803C3OMEwq6-r8FknTdjeIfKCYKg1ADS5pv7EE-QDSbGbr6sk-O1LOB1iT_STc3LQzVkm1ERu5aKr3b1My8U1Uw1lVAx5VEU3VWwNOMYuU9M4VedodgyFcIBCOTM_OqlMuIZQqCKfnPYHPLxtF8yjRWjJQ3tDNLVPKkuoCqTr6M_VcAJC6gCW8MrrfCqCwQNB6-pU6gF8gYjDcoGQnwpnzmcjGpWUn1VOWZ9uWxyWLlC5oFFA0DmklbpLiQVOwJuzdkCMK2Iw-nZMnAph9CWldwE7uOCZBzc19wt1QJy5V2o94u_kZEycm5XJaZUoxpZQ5mytcIh31ubznkDSaxCkGglntfRsFUk2J4VzO9XOwVlUq4Dblb4kVIFOxb60-6PlZs3u7YD0ULhrU_hp4dWRvSXCSJC9KY84-FFNI0I1HOpsZM8zJ1NIL6HslzZYnWPn7VIX0pR7hYtqF6bAiLcuIGJoj7_rd-3l-_kICmuCtlu7tpacy-sU2CbCEfAbiGMfRIv_tI4TvGltO5-PDQ_PY59wVYPzcacIygXLK1iEay65dXizZM1QdTU3nyivV-e88nhtrb_qo2LPfuWlULR6WfxV30vjrnbIK-EX5n_0_FkpE1V6gC090SJ8YE1IQx-g_4P9q_eDo7M7DfhrD6iKY7ONQaquhT91PSE-tPQgOCZ10QHL27yQGoXZWdYh90z56YsEb-FuqxQCaQi5EWY8688ZONnKMk8lvLm5lyNtNpH_9vQ17i7Skbeh9efNRT46twOx-AFtAUexpzqbuJLKkzprJMLLQwnNZ8qTqqFNSuqg2QzYN6cMbfN4jK8qOzjKvfTYScq8kQcFj_GWchRv-KlNu3acwH1v3LxNcy-Ms9VChrzsj81GVyjfNNSe-7C3enLYpUCaLlChnZbfVy2tyOWHzQ2uyAxjwjM6hgaZMT4a02JYs7tXqlc4D27DjvN1ysRbcPVybrhXA6bkWeoIENtZUZIR3NV0g8cBj-rMDvfSoMN9UNMxscuuwIBdl4oa5VjPVIzauCTP26YEXqpgXfmh1Z0cHpLzVYg9i7j3F_cwxERBirhdeTKa8jtbZhDJHXZorZ0OxKm_5Brpk0Tp5AGnqwcCJ8YPg8NTGtaRejxKQDC5IasPWD6yVpymaBa45kzllaSKUnrEUl9D2631qzpECyvuurr99v4-juNbVFVRHsI6ad_8qniHfRe_L_s_KR_VW1jAJP_yP6fXTfVI8vALYimTABG-NuS9m16suxA26K78PC9L_uvEdPcYtjF6no8Kp12wWtIrGbaWcmLWXhShdNgH6JnAKZLd4IAg1-QGq9fpMKyZjIwKv_dDgNMFlQwbP-5QPz7i_g3Wdfur2IXOr8oOHbil5gVxrv_PiC-jEKaPNu4jbGDTb_6Oltjn9_uAdD-SMPj3zqKr8unMMF9XD1gk-XQvYbEY9hMI_R0lA7LxV3ShQLHkz4kCzPJv0rafWotOd9WX3b8V_yrjE8SX3-hlVfpLNJl6aUteaZNorZJh45zbSOi5Tvyubz6PTR6T_92Id_i-3Uebyj_BKju3jn26HrB0h669ej5W3G3rqyFmXsNiR9QFZws5gOPJ0eftXy1LY_4yob23dIYgCZzeUBTNsiyxASxOUfjqx4-fo3NPlnkgaTrAH-waw8OHh62ZEMcgG66xkGE8n6YoMiTZ1Y9_AN8y8-0.aI9SxA.B7M3Uae_JQkisheba0UubxVy_5k'}
2025-08-03 15:15:01 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:15:01 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:15:01 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06D6FA68>
2025-08-03 15:15:01 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:01 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:01 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:15:01 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:01 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:15:01 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:15:01 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:15:01 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:15:01 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:15:01 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:15:01 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:15:01 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:15:01 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:15:01 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:15:01 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:15:01 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:15:02 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:15:02 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:15:02 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:15:02 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmum9oS_ZXI43AObAyYSFe6tmltg43pDBNr05i-ObSGKP9-N05ucvT0Bm_whtQu1qq1qlT1fXWvw6aAZVh2q29d04dfV30bNqtv31fQ98O2vXdVFparb6sJAvYN4ludlGh1qrjJfqRNdcpljNbO9EVkoGXLeMNj-DbYXOZQsUA-xM-rIUwSk2kMzC09pmJKvAMeyu1pmFnMww1h5ETliDcsZn8UUTfYD_GQmsV13DXnhMmix9WU4shMSYUmSXHHXtYm_kEyhvNgcgtAN9_DnQkO51xhIsBmtnTe8BH_2MEt3EfOcQtHfXuVdUGTxBtQknD9aNna9HkGF7jYSPf803C3OMEwq6-r8FknTdjeIfKCYKg1ADS5pv7EE-QDSbGbr6sk-O1LOB1iT_STc3LQzVkm1ERu5aKr3b1My8U1Uw1lVAx5VEU3VWwNOMYuU9M4VedodgyFcIBCOTM_OqlMuIZQqCKfnPYHPLxtF8yjRWjJQ3tDNLVPKkuoCqTr6M_VcAJC6gCW8MrrfCqCwQNB6-pU6gF8gYjDcoGQnwpnzmcjGpWUn1VOWZ9uWxyWLlC5oFFA0DmklbpLiQVOwJuzdkCMK2Iw-nZMnAph9CWldwE7uOCZBzc19wt1QJy5V2o94u_kZEycm5XJaZUoxpZQ5mytcIh31ubznkDSaxCkGglntfRsFUk2J4VzO9XOwVlUq4Dblb4kVIFOxb60-6PlZs3u7YD0ULhrU_hp4dWRvSXCSJC9KY84-FFNI0I1HOpsZM8zJ1NIL6HslzZYnWPn7VIX0pR7hYtqF6bAiLcuIGJoj7_rd-3l-_kICmuCtlu7tpacy-sU2CbCEfAbiGMfRIv_tI4TvGltO5-PDQ_PY59wVYPzcacIygXLK1iEay65dXizZM1QdTU3nyivV-e88nhtrb_qo2LPfuWlULR6WfxV30vjrnbIK-EX5n_0_FkpE1V6gC090SJ8YE1IQx-g_4P9q_eDo7M7DfhrD6iKY7ONQaquhT91PSE-tPQgOCZ10QHL27yQGoXZWdYh90z56YsEb-FuqxQCaQi5EWY8688ZONnKMk8lvLm5lyNtNpH_9vQ17i7Skbeh9efNRT46twOx-AFtAUexpzqbuJLKkzprJMLLQwnNZ8qTqqFNSuqg2QzYN6cMbfN4jK8qOzjKvfTYScq8kQcFj_GWchRv-KlNu3acwH1v3LxNcy-Ms9VChrzsj81GVyjfNNSe-7C3enLYpUCaLlChnZbfVy2tyOWHzQ2uyAxjwjM6hgaZMT4a02JYs7tXqlc4D27DjvN1ysRbcPVybrhXA6bkWeoIENtZUZIR3NV0g8cBj-rMDvfSoMN9UNMxscuuwIBdl4oa5VjPVIzauCTP26YEXqpgXfmh1Z0cHpLzVYg9i7j3F_cwxERBirhdeTKa8jtbZhDJHXZorZ0OxKm_5Brpk0Tp5AGnqwcCJ8YPg8NTGtaRejxKQDC5IasPWD6yVpymaBa45kzllaSKUnrEUl9D2631qzpECyvuurr99v4-juNbVFVRHsI6ad_8qniHfRe_L_s_KR_VW1jAJP_yP6fXTfVI8vALYimTABG-NuS9m16suxA26K78PC9L_uvEdPcYtjF6no8Kp12wWtIrGbaWcmLWXhShdNgH6JnAKZLd4IAg1-QGq9fpMKyZjIwKv_dDgNMFlQwbP-5QPz7i_g3Wdfur2IXOr8oOHbil5gVxrv_PiC-jEKaPNu4jbGDTb_6Oltjn9_uAdD-SMPj3zqKr8unMMF9XD1gk-XQvYbEY9hMI_R0lA7LxV3ShQLHkz4kCzPJv0rafWotOd9WX3b8V_yrjE8SX3-hlVfpLNJl6aUteaZNorZJh45zbSOi5Tvyubz6PTR6T_92Id_i-3Uebyj_BKju3jn26HrB0h669ej5W3G3rqyFmXsNiR9QFZws5gOPJ0eftXy1LY_4yob23dIYgCZzeUBTNsiyxASxOUfjqx4-fo3NPlnkgaTrAH-waw8OHh62ZEMcgG66xkGE8n6YoMiTZ1Y9_AN8y8-0.aI9SxQ.otF0D4X3C-AlGmCrxTpn_PVuEa8'}
2025-08-03 15:15:02 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:15:02 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:15:02 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06D64EE8>
2025-08-03 15:15:02 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:02 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:02 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:15:02 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:02 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:15:02 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:15:02 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:15:02 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:15:02 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:15:02 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:15:02 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:15:02 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:15:02 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:15:02 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:15:02 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:15:02 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:15:02 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:02 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:15:02 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:15:02 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:15:02 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:15:02 - managers.commands_server - DEBUG - Request completed in 0.17s with status 200
2025-08-03 15:15:02 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 4.5299530029296875e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:15:03.192879'}, 'success': True}
2025-08-03 15:15:02 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:15:02 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:15:03 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 15:15:03 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0011141300201416016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:15:03.357097"
  },
  "success": false
}

2025-08-03 15:15:03 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0011141300201416016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:15:03.357097"
  },
  "success": false
}

2025-08-03 15:15:03 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0011141300201416016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:15:03.357097"
  },
  "success": false
}

2025-08-03 15:15:03 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:15:03 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:15:12 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:15:12 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:15:12 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:15:12 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmym0oS_RWH1uZeRl3hiI5oIQECMQgxs1EU8wxiFi_876-49rMdHb3oRS_Jqjx5zsmk8q_do426CtRRPey-Dd0Yfd2NfdTtvv21A0EQ9f1jaIqo3n3bvQBOvwH0qBOXvTJHCSmqJJM0NuKMT5aZCyxl8RNYbgt7c7y72EoIeN6kR-Zfl2fTcsmHH07sy5Q5yUAOqX9eVjRb98cpLnzl4tkl41EJtq44J6h-6Z50RXumk3giqeua3rFJLfyjx1uFw7nuwtQjwfM2APKhXwj5OUo9eedK6flgmNIM4xo5XjRwStzr0XT1413QOe3CO7ickS9yVFO0sV6D251qkJOAVRMU-_jYfd1FS5t1Uf8A0AvsgyJxfE-jh9_xDPpAUDSMZOEvX6KXmPp8kKmZqJurgCmZ0AvV0HonYS9U90Ix5Fk2hFnhvVy2Ndw1mELJ01xZk9U1ZMzFZcpd2dnNBcwzuErh2Uw6iWjkHDfMq4VpWay9wTJtQMhbqAkv9zlYm0nCudzFacyv76tUhZOPh72nU7mPoxtEGtUbhLDIZ3NVjWSWc3ZVzjIpOUcU1B6unMNOxsPBJazc2yhWKAYcl3TxFJX5cA7sFJMqbg4u8ujh9OThSxk6ShlUygRrln6tjbD-IGRz5jpWIeRNJhtHTF4LUj7Duqu2qicMSm_xMNcIsCq1bytQsvmSz96g2CWu8koTnpk6uHBNqFNpcGF-a3Gs1XNEqIdCPZtCpa2uDu2tIUYG7c1ZWIOdlTzBFMOlVKNY1LNAQb2YfNraYA2uXfYbL6ip9CsPcudeoZEePRxLgT3_4u_Z2_cSh5X1ArbXeraWqfX9FdomxOFQB0_TAE82_4e77a1KwZkWSknhOcRD3EV1XpQlM7xvWH5FQ1xzu5tHFc3Z5lC7Zgks1Eo9tCQMp0Hvr40flfr2j3uAt0aB_8nvUyPTusQdCyrzP3q-NPKLqn2crn3ewgLcekENYwjzw9Nn7ydXpxkND0gfV2TXpjuDUDwLXXQ9w55aLnKuSd10nGZtlsuNyhwsSyx9U1gCHmMt1OvliiMMrjSigqWDtcAlW97mqQaOV_ol1GZj5S9PP8fdgzrKPrJ-n3nQR9cRsc0PYHMojC3KaqJyLqxbzyBeGV3gfOYsoRjaS85dSjYY-k0Xe-NAOf1zKS9VUydKMc4ic348QFSZFy1CCw8cK7dysK7cP-lwZW6TgZ31EGHS8M5NVEItyPpoY9uW4X9thNxwHcH0onkj1QCtCsdLUl-DPXtaUtVK8GbvgUMOWmG5xqGYo6tK-wY65WYihTHfOo_q4p65U0sHlOjak-hiyJ3itfFlXwgTGeh4uTtJvJZHSdUL2u1Y8jbEwvPGZTTF3moldUk6IRCrEwpWPwPNzo4Pv6NzxGm1NJkcJstUM90_LljnmDdd0kuaW4Xq-gyU58VGpNqPbGnSbxXX3a1GCX3k1uHmHsNH00XpzD_5lwOtt0YZOc1D5PKXGBz4KT9oiFE9k7g1nLSLNPi69UHTRvDBSoeh7b-9v8_z_JY0TVJGoM36t6Cp3sE4pO_b-5_VcfMWVSArv8CkOgu__M9ZbdfEWRnBgp8v5GN4fVZlItDBvfJjvWwXP1fM8EhBn8Ljio37_dGwlevwMc0xefElhN9YgzGExxhKEfQBxTGCJA5IS-bTRH4URFIFYxDh6L6isukQpAOatM90fANt2_9kuZULmnqAC24juyGu7f8Z8dMoiBnAFzeOOtCNh38nW-zP88cEdcdZFP6zZ-FW-b1mMPTrLgZVVr4eNag2w34Awewkm6CNP6NbCRjLfq8ogthys77_o7VwdTdjPfzD-CeNPyC-_EKvmzr4jK4N614TIHg2CxJhlleSh8dtFgxj9-fYlCnx3414B-_HU3JoAgk0hdq7tnQXkZzBWaCo1-bsHAMlQsx7VDFYW51trsTBLLn6evxXT--RYJvQ0d86g0FF-wNF7Wmaxg44jVIUuvv-_cfoPLJtHoj9PkRjmkTQKPYR8iNCEUBHJBJ9fPjBnqKIiKB33_8G2XX34A.aI9S0A.g2Fz1TLD86yOZnzYz8rUthZIlxU'}
2025-08-03 15:15:12 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:15:12 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:15:12 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06D90A68>
2025-08-03 15:15:12 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:12 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:12 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:15:12 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:12 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:15:12 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:15:12 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:15:13 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:15:13 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:15:13 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:15:13 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:15:13 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:15:13 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:15:13 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:15:13 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:15:13 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:15:13 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:13 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:15:13 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:15:13 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 15:15:13 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.003229379653930664,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:15:14.012209"
  },
  "success": false
}

2025-08-03 15:15:13 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.003229379653930664,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:15:14.012209"
  },
  "success": false
}

2025-08-03 15:15:13 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.003229379653930664,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:15:14.012209"
  },
  "success": false
}

2025-08-03 15:15:13 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:15:13 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:15:14 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:14 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:15:14 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:15:15 - twofa_endpoints - INFO - 2FA setup started for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:15:17 - managers.commands_server - DEBUG - Request completed in 2.41s with status 200
2025-08-03 15:15:17 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 2.258246660232544, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:15:17.567744'}, 'success': True}
2025-08-03 15:15:17 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:15:17 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:15:17 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:15:17 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:15:17 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:15:17 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:15:17 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:15:59 - twofa_endpoints - ERROR - 2FA setup verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: (psycopg2.errors.UndefinedColumn) column "updated_at" of relation "user_2fa_attempts" does not exist
LINE 1: ... success, ip_address, user_agent, id, created_at, updated_at...
                                                             ^

[SQL: INSERT INTO user_2fa_attempts (user_id, attempt_type, success, ip_address, user_agent, id, created_at, updated_at) VALUES (%(user_id)s, %(attempt_type)s, %(success)s, %(ip_address)s, %(user_agent)s, %(id)s::UUID, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING user_2fa_attempts.created_at, user_2fa_attempts.updated_at]
[parameters: {'user_id': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'attempt_type': 'totp', 'success': True, 'ip_address': '127.0.0.1', 'user_agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'id': UUID('c43d18a0-b79e-4ad1-9a0c-8b2d4d18df88')}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-03 15:16:59 - twofa_endpoints - ERROR - 2FA setup verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: (psycopg2.errors.UndefinedColumn) column "updated_at" of relation "user_2fa_attempts" does not exist
LINE 1: ... success, ip_address, user_agent, id, created_at, updated_at...
                                                             ^

[SQL: INSERT INTO user_2fa_attempts (user_id, attempt_type, success, ip_address, user_agent, id, created_at, updated_at) VALUES (%(user_id)s, %(attempt_type)s, %(success)s, %(ip_address)s, %(user_agent)s, %(id)s::UUID, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING user_2fa_attempts.created_at, user_2fa_attempts.updated_at]
[parameters: {'user_id': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'attempt_type': 'totp', 'success': True, 'ip_address': '127.0.0.1', 'user_agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'id': UUID('36166f45-c71e-4086-95e7-13bd14036fd6')}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-03 15:17:06 - twofa_endpoints - ERROR - 2FA setup verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: (psycopg2.errors.UndefinedColumn) column "updated_at" of relation "user_2fa_attempts" does not exist
LINE 1: ... success, ip_address, user_agent, id, created_at, updated_at...
                                                             ^

[SQL: INSERT INTO user_2fa_attempts (user_id, attempt_type, success, ip_address, user_agent, id, created_at, updated_at) VALUES (%(user_id)s, %(attempt_type)s, %(success)s, %(ip_address)s, %(user_agent)s, %(id)s::UUID, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING user_2fa_attempts.created_at, user_2fa_attempts.updated_at]
[parameters: {'user_id': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'attempt_type': 'totp', 'success': True, 'ip_address': '127.0.0.1', 'user_agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'id': UUID('97238190-e541-40fb-8db9-bc4d95cf468b')}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-03 15:24:27 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:24:30 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:24:45 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:24:45 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:24:45 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:24:45 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcuOo8gS_ZWW1-0qSF6mpZEGbLBxGSge5rWxIMG8E2zAYFr975NU93SXru7iLq68IjLznDgnwhHfV5c2udchSlC_-tbfh-TrauiS--rb91UIYdJ1l74pE7T6tnqGgH8JCcGiDqz2fDPGGoZx7xtNSXHVwVMQdyUD6XlKnluvyi_89M51jcjALUzImTXITr9tHEOQWFqhyO6OGjLt-UbyQ5gjZm1khzhVs4F19KIsmVsjpufUKx_r6lkLBKo2ts8eQttylXsSEYl-ZGV36gpxf1szYraJndlCUr7PbjDgL1YxsLkRblP_TbDwz1Qs2TjsPaDmfnZWoNmoFnmpKS4Qk1o0zgJBctzq6yqZ2vyedJcQe0FyDA0AR2-IP_Ec-0Ax_ObrKo9_-5I8j1m0h7meH63zrJBarnRK3bfBVmGV2iw1Wx1VWxm1fVCorgF8Wyy1Iiu0OZ19WyV9oDL-LI1-oZCBLdfaXspP2yOReMKC-eaQRn41XjBNCyl1CTXxwRzh3DxOQC58wJMRMudTHT8iEHeBxRQRIBaILEELhDKpu_Os2-moFtKs7VT65AlEiAKg7eK7CnARKacIlhRrggw9n_ZBRqj7eIRuRp5qeYQHdQgA_wjAVMWeVsFae2DOKkLGgPl7JR9z33NKpWhy1RZIdS5pdYd5Z2PWtySW3oK4MKhw1lDkaljy-anugl5zK6DvtSbeiQge5Ca2mAwexD9aPGcOvCPWwxCByxCnhdfC9iKMkWN7CwlzSKNWpKRm-4xul5O-Uxisl1S3Sxmc3nerbskLa6qiOsC5y8_YzoQAkFnojr_zD9zle7rGtfMM3aANXCPXkfmM3TPGkQkPZBkE6eI_bVbVqIHJipCjavU0aRKvmJXpaqgVF6yo5jHuebl7VwkZnZ2qVw_aZDmyEUtmFZdyCRcdNZNF7se9Itw7g7L_ld-HRrH1KZOE9fk_aj416pNBEeBRtHdICJwn1jDE-H28_aj9w7d40QCQjoCm-i5_tyktcIjJsnLyZhRH2T8z7xbgJVeSC7s-945zrKKzMsE9KTlE0Km1TNlyZSelxMO5BCdXXfoJhV5QRRXW5pLVb08_2j3AOqoucf6cBdhH3zuSix-hKxM4NmnzmVALZdZ36YzxquSA-7OQKM02nmoBCX2n8S_eZtjvEHkQpwOAzbW7n-h0PbPX09Tjfy1CFeVteM_M1uRj3xiSqFJFxWT5MT9GN9g_3i4AndlURyzYCZeLnnhvexceNZNtB_t2gtdgPV7mIeaM69a0Lx3ILm7CnWp9pEib8Dwa1fu3UNTUnVSW7yAw_XtBDO-84jOpk-sCek43S-q2aFrnOfOYqENTNZvUEYYT5w36jms5I99WlvXGtCmqdmvGE4DYXRm9vRjVkx61A9p37XpzAAkbqSfpndjdLPtyuPuaZocWpGyPZimTHrzBJ0_7N99BojPdhrx6agmjc_6VW4ttuOHWlCLzs2D29QOPom4k0vDW1d6WqYTNCK8TA3dX0hDu8FZaBp5uHWzaBA-srO_b7tvr6ziOL2nTpFUStnn3Apv6NRz67HWZ_zm6Ni9JHebVl__5entvrnmVfMEsKI8x4ceEvPTPD1YxCe94r_xcL8v9jxXTX7Kwy_DxJPstV5loOLHVjdYPsu2ws4Cvh0OMj0mCofgNAUiKpjbrli4eD5orqbSGA0wAwdZM_tjArCfS9pYNL2Hbdr-SXehgg3q84JacF8S5_T8jfhiFMSGeuNfkHt6Hzd_pEvt8fnlg3dc8if_ds3irfFoz1NfVNaxxkS8orBfDfgLh12n-wDb-ii4UOJb_WVHUZnmbd92n0uLV3Qyo_zfjX2l8gvjyGx01CC7RkhJSw6-J7qYY7_0ueQjxDR-3OeyH--e2qTLqvxvxGr4K23TTwFPYlHrnuyfzuC5EIIWa_tbsPAFqyfps4o1LtvXOlSsQjiffmoW_Op5dw6VDh2ipDEmRBLthGJbneXIDeIJhiNWPHz9b55Iv_UCxbExceXpNJNdoTXMJsQ75hF4nHBdBlmGohOJXP_4BWZP3Eg.aI9VDQ.RJS0wClXQaqO7qcGZPt9DrM_qrg'}
2025-08-03 15:24:45 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:24:45 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:24:45 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06C68138>
2025-08-03 15:24:45 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:24:45 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:24:45 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:24:45 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:24:45 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:24:45 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:24:45 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:24:45 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:24:45 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:24:45 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:24:45 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:24:45 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:24:45 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:24:45 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:24:45 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:24:45 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:24:46 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:24:46 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:24:46 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:24:46 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:24:46 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:24:46 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.5762786865234375e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:24:46.653029'}, 'success': True}
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.147125244140625e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:24:46.730516'}, 'success': True}
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 15:24:46 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009794235229492188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:24:46.803335"
  },
  "success": false
}

2025-08-03 15:24:46 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009794235229492188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:24:46.803335"
  },
  "success": false
}

2025-08-03 15:24:46 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009794235229492188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:24:46.803335"
  },
  "success": false
}

2025-08-03 15:24:46 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:24:46 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:24:46 - managers.commands_server - DEBUG - Request completed in 0.17s with status 400
2025-08-03 15:24:46 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0011234283447265625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:24:46.895564"
  },
  "success": false
}

2025-08-03 15:24:46 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0011234283447265625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:24:46.895564"
  },
  "success": false
}

2025-08-03 15:24:46 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0011234283447265625,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:24:46.895564"
  },
  "success": false
}

2025-08-03 15:24:46 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:24:46 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:24:47 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:24:47 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:24:47 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:24:47 - twofa_endpoints - INFO - 2FA setup started for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:24:49 - managers.commands_server - DEBUG - Request completed in 2.52s with status 200
2025-08-03 15:24:49 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 2.250119924545288, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:24:50.072380'}, 'success': True}
2025-08-03 15:24:49 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:24:49 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:24:49 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:24:50 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:24:50 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:24:50 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:24:50 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:26:42 - twofa_endpoints - INFO - 2FA setup completed successfully for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:26:53 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using totp
2025-08-03 15:27:18 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:27:18 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:27:18 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:27:18 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmym0oS_RWH1ta9UEzCER3RGgCBBBJiZqOAosQ8XAYheOF_f8W1n-3o6EUveklm1Tl5TiaVf63uDWrLoEJVv_rWtwP6uho61K6-_bUKIERdd-_rHFWrb6spAPxbQGwN6shqU0trd2r8eILtsZL7qKoJ6jbyUpmH-1qGl108cvTOPErW4G2NrDAuD9u9ssekdYX6ae_oE50JJuCeAnPuch0mA_sgqDVTjLK3f8YNKwn7wVCgLFm2bZ2IS6_1fmun7Dq7X472cUZP9Sxs3OvARhvp8NLJwcsSibM4wbsQWxfyuzjYx95pq1vG9iYbon6UXKCmd5S0XkLurfw49WP-EV5m-rQlSI5bfV2hV5O2qLsH2AuSY2gAOJaif8dT7APF8JuvqzT65QualCSUYHpJFcOaZVJL5U4u-8bfy6xc3nLNVEfVlEdN8jPV0YFn7nItSzJtjmfPVEkPqIw3C6OXyaRviqUmCel5rxDI3S6YJ5vU04f-hmkaSKlLqI6OtxHO9fMMxMwDPBlWt_lcRs8QRJ1vMFkIiAUiQdUCIb_UgzVfzHhUM2HWDip9drdEUPlAO0StCqLeo-zMX0osCTJwPdoDCaFK0QidhDyX4giP6uAD_umDVxG5WgFL7Yk5i7DSB8zfy-mYeq6dy1mdquaWVOecVg-Yd9bny57E0hsQZToVzFoVOhqWbE3qwe81pwAXSaujw66CR7GODCaBx91vLa49-66C9TCE7zDEeeE1sL0VxkixvZmAOYRRy2JSMz3mYuavy0FmsF5S3S9tsHvPKbqlLqypCEsf1y5OkZlsfUAmgTP-qt93lu_XIyrtKXD8xnf09FLdpsixMI5IuCBJIIgX_0eU-Y4vkWfoRoMBNMspbRAdokATFWrBCkse41qL95RjJ4HlNjoStLNeJZkl2hq0GtL5HBMmCZ3lnJIFkj3I0s_6PjXuGo-6kbC0_qPnr1qdmCoEfBVKNgmBPWENQ4TvR_vP3j89g9_pANIh0FTP4VuT0nybeBlGSn7omSJ6FnM1AC84gpiZpdXbtlKElvyCEinYhN-ppUiZYmGiXODhnIOzoy7zVAWuX4QF1uaQxS9PP3X4WEfRIft3zsc-eq5CLn4Ejkjg2EubLULNZEI9qADjFeiI5zMTKM3UJzWDQJ19_u34zDz3pnC-7TV9PhdAF64RH3lTmVjr6yO2bPWUGXvSuO3MjOD8ROvr19pOkzN1m5Uh24rZetpumYczVAN8UeT2Ie3xrJvo1Gjhvvioq4GcKgiOD0bfXc_UoPD3lgN-Vt2UNQphVivANMzkA3DjUS0OGwN19ocotZYzMEp_rZHuo1bbbVB5YA9XvYWSdhbJiJ1O15g5-cEUFhJYY-PSZGYuhue6wAsiA3dh2EwwJYXba325WpFP72c2yFiJevZHtJE5Of-Y0lZXzEPx1I7KI6bDUmPa3t0Fejypbavti5jLr6InNrfbcKPXmbFWqvNaMWAujhfdjgfrHMntab0bre2tS-S6z5N0zmP8unWwbhB-sJK-b7pv7-_jOL7FdR0XKGjS7g3W5Xsw9Mn78v6n1aN-Q2WQFl_-5-NNWz_SAn3BLFUaYcLPF_LeT5-sOxS0eK_8WC_L-c8V09-ToEtwuplZOypPH2N1gqaPnj3n07cRHw-GCKdJgqH4DQFIiqY264bOnk-ay6m4hANEgGBLJn1uYNITcfORDG9B03Q_i13oYF31eMEtNS-Ic_N_Rvw0CmNC_OI-UBu0w-bf8RL7M39_Yt2PFEX_7Fm8Vf5YM-zX1SMo02K6V0G5GPYDCN-O0ye28Wd0ocCx9PeKoonlbtp1f7QWr-56qPp_Kv5Zxh8QX36hV3UFlyjnub4-X1_70-4Fr5b6oQw-Tjcp7If2z7EpEuq_G_EevG_38aaG56DOL53nnPH_lO2AEGiXU31wt1BDa-uGyh3ZlAdHLEAwnj1j3v6r49k1XCZ0CJfOkBRJsBuGYXmeJzeAJxiGWH3__mN07ukyDxTLRsSDp9cEeoRrmkPEOuARvUYcF0KWYShE8avvfwNXNvdS.aI9Vpg.TpClk2FejNMVC03QjtwNSThT--Y'}
2025-08-03 15:27:18 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:27:18 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:27:18 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x073C6120>
2025-08-03 15:27:18 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:18 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:18 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:27:18 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:18 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:27:18 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:27:18 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:27:18 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:27:18 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:27:18 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:27:18 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:27:18 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:27:18 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:27:18 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:27:18 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:27:18 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:27:18 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:18 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:27:18 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:27:18 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:27:18 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:27:19 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:19 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:27:19 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Request completed in 0.23s with status 200
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.0004773139953613281, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:27:19.389778'}, 'success': True}
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Request completed in 0.18s with status 200
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.00011038780212402344, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:27:19.421420'}, 'success': True}
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Request completed in 0.15s with status 400
2025-08-03 15:27:19 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0061419010162353516,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:19.565538"
  },
  "success": false
}

2025-08-03 15:27:19 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0061419010162353516,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:19.565538"
  },
  "success": false
}

2025-08-03 15:27:19 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0061419010162353516,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:19.565538"
  },
  "success": false
}

2025-08-03 15:27:19 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:27:19 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:27:19 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-03 15:27:19 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000896453857421875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:19.577169"
  },
  "success": false
}

2025-08-03 15:27:19 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000896453857421875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:19.577169"
  },
  "success": false
}

2025-08-03 15:27:19 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000896453857421875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:19.577169"
  },
  "success": false
}

2025-08-03 15:27:19 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:27:19 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:27:20 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:20 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:27:20 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:27:22 - managers.commands_server - DEBUG - Request completed in 1.92s with status 200
2025-08-03 15:27:22 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7631330490112305, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:27:22.370496'}, 'success': True}
2025-08-03 15:27:22 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:27:22 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:27:22 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:27:22 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:27:22 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:27:22 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:27:22 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:27:36 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using totp
2025-08-03 15:27:55 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:27:55 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:27:55 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:27:55 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuo0oS_ZUnr8v3QgLGlNRS28bY2AbMPGysZDAk82Uww1P9-0tujWr1ohe9sURE5jlxToQz_l496qgpYBmV3epr1_TRl1XfRs3q698rGARR2z66KovK1dfVBAH3BomdTp038lwN7FlD2ypnqbNKQUZh98W2n8GQmVPeHlvCjIoxvBMHR6Xr6bFjbdp6XGHxIkVed4ziNF6SJp1qyrbr68z7SW4o9fW5ExyRlfZrPt8YLst5YyZ7aqvwnVuI8pqubo1iahvyQp9oFNFjmpknTlbo5rIW2gOIL2uQwzVVNyL5EcND7F53ZqzvNFEX1PPJARLifXKqYsvTeu76kdVWdrery0CQLLv6sorGGjVR-4DYC5JlaADYDUv8jiPsA8Vw7JcVCn_5Ek2XxD8FSEEX3ZxFUkZiKxZd7R3EjVhomWxIg2SIg3zyUslWgWvsMzlNUnmOZ9eQSBdIjDsfBzcVSc8QCvl0RLfDhYic3YJ5tUgVPdU3TFMHlLSEqvCsDcFcvW5ASF3AkX6pzbcifPkgbD2dSX1ALBBJVC4Q4ijx5qwY8SClx1nmJfrm7AhYekDmw0YCYedSVuotJRYECR2XdkFCSKdwCOyEvBXCEJyl3gPcywNjHjpyHhTyC3Pmfqn2mL8T0YBcx8rEtEKSsSOlOaMlHvPO6qwcSCy9BmGKx2SWS9-WsWRzknivk-0cKCe5Cvl9GZyFKtSZJDjvf2txrNlzLlgPQ3g2Q9wWXh3bW2IMhO1Nj5jjOMhpTMqGyyhGNiq8yGC9pHRY2mB1rp23S11YU-4XHq5dmEIj2XmATKA9_Krfs5fv8RkW1gRtr_ZsFSmlNoW2iXEEwgFJEoB48b8MT7kW2l0Z8tZFEeTetetNdN4RruXtFyy_4DCuuZw1gyyBsJA1j-Ak5cQd9Vm7QkNwws8xYRLf_jyXwpPVi6cf9X1q3NcupZFBYf5Hz8dKmpjSB1zpnywyANaENfQhvh8ePnv_cnVur4KA9oEsuTbXGJTsWcSo64j8UNOL4JrMXQfc0T4KqVGYnWVdct8Ux-BEHi3Ca6VCoAwhN6LsyAVzBm62tMxTCR0v93OszSbzX55-6vCwjryNrN85D_voOhdy8QPaAoFjozybhJSKhMQHBMbLsWdISY-UbKiTlAZAnjX8xLTDaG6n8XhuZv1qerXu6bt88hKUl0g35OMgsbXkwvVN6PNGOFm3w4PVtc5TeyeypiyJzwHrHD3mw-YJ44GmM-NQ-hyGN-iGt9d0GfrwGk7KneSqkiKau-s4M0HXpb9BH-3jye56Q0j23jW8euM929xTb9Omx_WxsJ3DLnQeUmCaqY9G_wmCKo21CzfwlrWxZ21Wt_U8qKN8Q7zqGSYaPhJyzhsHfOw3l-190gIoHF-Jz1BNUowttvKe58xaK85Q5p8texcb_jo_oJHFgR0VWfC4UwSBaCjeTfn8MR4YFZyNPROyu9f6laVW2xf4H-8K58vaI8HtNZyfBzOb7w_vtp9qgs3XuV5YSaHi160NqjrCDxb-LVH4V9J1dfv1_X0Yhre4quI8gjVq34KqeId9l7wvawCVz-qtbqonyqP__UJUQJRjws8X8tFNn6z7CDZ4r3xfL8uxzxXTPRLYJjgdd0jts7hjxK1ewnQeaxpaO3wc9iFOkwRDcVsCkBRNbdc1nb5eNJtRcRH0QQSITcGg1zZIOiKuP5L-DdZ1-6PGhS6oyg4vuKXUBXGu_8-I3wV_XQX4xX1GDWz67b_jJfZn_vHCup8oCn_uWbxV_lgz9JfVExYonx4lLBbDvgPh2zF6YRt_RBcKHEO_VxRNLHdR2-Lszxbh1V31Zfez4h9l_AHx1y_0siqDJWo0Zy8N1Fi5bSv-Sl8Qab9wukZB1zfRH9h5Qv13I97h--4Qb6vgBqtMaV37pl3W6R4coaxcK97ZBXK0NrWo2JN1wdtCDuBwc_V596-W26yDZUJ7f-kMSZHEZsswG47jyC3gCIYhVt--fR-dB1rmgdpsQuLJ0Wsievprmo2INeQieh2xrB9sGIaKKG717R_vI_mw.aI9Vyw.KWuTXtly292VG022oRLvti74wMs'}
2025-08-03 15:27:55 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:27:55 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:27:55 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x073C6ED0>
2025-08-03 15:27:55 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:55 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:55 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:27:55 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:55 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:27:55 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:27:55 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:27:55 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:27:55 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:27:55 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:27:55 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:27:55 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:27:55 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:27:55 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:27:55 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:27:55 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:27:56 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:56 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:27:56 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:27:56 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:56 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:27:56 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 4.076957702636719e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:27:56.754025'}, 'success': True}
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Request completed in 0.15s with status 200
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.6702880859375e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:27:56.800026'}, 'success': True}
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-03 15:27:56 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010862350463867188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:56.895132"
  },
  "success": false
}

2025-08-03 15:27:56 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010862350463867188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:56.895132"
  },
  "success": false
}

2025-08-03 15:27:56 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010862350463867188,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:56.895132"
  },
  "success": false
}

2025-08-03 15:27:56 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:27:56 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:27:56 - managers.commands_server - DEBUG - Request completed in 0.17s with status 400
2025-08-03 15:27:56 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009009838104248047,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:56.968033"
  },
  "success": false
}

2025-08-03 15:27:56 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009009838104248047,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:56.968033"
  },
  "success": false
}

2025-08-03 15:27:56 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009009838104248047,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:27:56.968033"
  },
  "success": false
}

2025-08-03 15:27:56 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:27:56 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:27:57 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:27:57 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:27:57 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:27:59 - managers.commands_server - DEBUG - Request completed in 1.87s with status 200
2025-08-03 15:27:59 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7115089893341064, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:27:59.621723'}, 'success': True}
2025-08-03 15:27:59 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:27:59 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:27:59 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:27:59 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:27:59 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:27:59 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:27:59 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:28:31 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:28:31 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:28:31 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:28:31 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVUmvm0oW_iuR1_G9UIBtIrXUgJlsgy_zsEFQgAEzmdHmKf_9FTd5SdTqRS966VPFN53jOn9tgjbpqrBO6mHzbejG5Otm7JNu8-2vTQhh0vfB0NyTevNt8woB_RZijEFIO3U-JDcJd8GZc7HzXOOYoOe-2AnP6f6h0pLqvCztY7sMgUjKz9ZzCa7V5tE8UvG07Rxx73OqMlltaqdp6kc7SdFPhvkIbPt6wwXdHUaDfTKXlCOt50MTHjnL7gMsvjuDKrPnFKqYhjP5rgv67SOe3b17DIJlrIiiNqaQzTm2urBzyN28MxNhBqPLhqBJoguU3JaCl9cmF3KbXuDtRh9IeK4YDN_vN183ybPNu6QPQpQFvqdIAPZ77PC7nqMcCIpGlTz-lUvyOmWRCPNrfjKsRcbVXO7lamh9Tt7JlX5XTWVWTHlWRb9QHA14JntXi6xQl9vimQruAYXyFn72Chn3TaFSRT6_cCcscZkV82zjWp5qb4imhYSylppY0me4NNMFCIUHaDyq9eVSxVME4t43qCIC2AqRJfUKIT-Vo7VczdusFPyiHhXy4jJYWPtAPcadAuLBI-zCXyVWGB66HumBDFPEeIZOhl8qYYaSMvqAnnzwLGNXLWGlToizjGptRPyDnM-559p3uWhyxWRwZbmTyhHxLtpy5XBkvQVxoRHhotaRoyLL1ks5-oPqlOAqqk18ZGsoCU1sUBmU2N9eXHvx3RPyQ2G-Q2GXlddA8dYII0fxFjzi4Ge1uOGq6VFX8_68HmUK-cUVbm2DPXhO2a-6kKcyqnykXXjFZsb4AM9CZ_6l33fW3880ruxX6Pit72j5tdZfsWMhHAFzQZZBcFvz182j6kIXaT76nGO3nsHTo1KfNB2o-ooVVTTCtda7kmaeJqeUMQgORFS1kuNmk7GcVv0Il8oi5_NeEYr2KIs_9X16ZFuP0HFYWf_R82ejvKg6AnQdiTYOgf1CHsYYfR9zn72fPINmNQDJCKiK59CdSai-jT0NI8cfWnESPIv6MADNO7xQmJU12PapjCz5CUWctzG_VyqBMIXSTO48DZc7uDjKOk916PplVCJvDl7-yvTTh498lH1i_z7zUY6ee8LXPEJHwFDtqS4WphQyppj8jPDKRELzWfCEamovpUDTbbL0WzOPgTmw53zCU8ha893XBC_a7hk6KYtec5-2mmB0zT2Ei35i0qL0pmKMSRbfc0XtWWpp-y9BSvhTVWEPU2jq5SM2vJzUHtToJML9Qt6LJiw4zRIi1AwlBZUBVZIfer4LU4kJBlmvx6AwrZpV8pcLtV55SorauIlXFKnDl7jXyoDZOczV8-wuiEDLXAOzvvgaT-HPwTwYuE5fBi59NZJ82Hc7idrP58eHSCe1wMC51x-aF1SW2Teie_yIXyy_VNwYzSSrlRnGuLRG1d0dv029RJzNbnExhd-6p-quLyKJaKbgscuD_QQm_8pyy5HVb8-gyNhudwzErK9rmo9Y02AXioqw5Ki1lIZetx42bYIerGwY2v7b-_s8z2-3prmVSdjm_RtsqvdwHLL39f3P67R5S6owL7_8z9fbrknzMvmCWOo8RoSfL2QwvD5Z2STs0F75sV7W-58rZgiysM_QsXYhnEd7a3es57vStQbdhwhX1eEYo2Mcowj6gAGcIInDtiWLaSL3d-JWwREmANtVVD4dYDZgt_aRjW9h2_Y_xa50sKkHtOBWzSvi0v6fET-DQpgQvbhp0oXdePj3ba39eR5MyHeaJ_E_exZtld9rBse-btKwystXUIfVGtgPIPT1LZ9QjD-rKwWq5b9XFImv3-Z9_0dr0epuxnr4R_FPGX9AfPmFXjc1XKsiAxpfJ_tmXxei92zOYIzQcZvDYez-HJsyI_57EO_hO8PdDg28hM392nsO-n9uCxbwoXo9N0eXgWqytfSkYvG2OjpCCcL54hkL86-e3m3hOqGIEnUGJ3Bsd6CoHU3T-AHQGEVhm-_ff4xOkK_zQOx2MZbS5BZL0mhL7hNsG9IJuU32-wjuKIpICHrz_W_dAvch.aI9V7w.j0qIE_qeFztNmUgFZ5EIzR8C8i8'}
2025-08-03 15:28:31 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:28:31 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:28:31 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x073C64E0>
2025-08-03 15:28:31 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:28:31 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:28:31 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:28:31 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:28:31 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:28:31 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:28:31 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:28:32 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:28:32 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:28:32 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:28:32 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:28:32 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:28:32 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:28:32 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:28:32 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:28:32 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:28:32 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:28:32 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:28:32 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:28:32 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:28:32 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:28:32 - managers.commands_server - DEBUG - Request completed in 0.17s with status 200
2025-08-03 15:28:32 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 4.744529724121094e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:28:32.946811'}, 'success': True}
2025-08-03 15:28:32 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:28:32 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:28:32 - managers.commands_server - DEBUG - Request completed in 0.18s with status 400
2025-08-03 15:28:32 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009119510650634766,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:28:33.115673"
  },
  "success": false
}

2025-08-03 15:28:32 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009119510650634766,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:28:33.115673"
  },
  "success": false
}

2025-08-03 15:28:32 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009119510650634766,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:28:33.115673"
  },
  "success": false
}

2025-08-03 15:28:32 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:28:32 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:28:33 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:28:33 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:28:33 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:28:35 - managers.commands_server - DEBUG - Request completed in 1.90s with status 200
2025-08-03 15:28:35 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.762721300125122, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:28:35.871646'}, 'success': True}
2025-08-03 15:28:35 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:28:35 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:28:35 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:28:35 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:28:35 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:28:35 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:28:35 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:30:31 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:30:41 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:30:48 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:31:04 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:31:20 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:31:46 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:34:26 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:34:26 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:34:26 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:34:26 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:34:26 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:34:26 - managers.commands_server - DEBUG - Request completed in 0.15s with status 200
2025-08-03 15:34:26 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.6702880859375e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:34:26.838485'}, 'success': True}
2025-08-03 15:34:26 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:34:26 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:34:29 - managers.commands_server - DEBUG - Request completed in 2.43s with status 200
2025-08-03 15:34:29 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 2.280982255935669, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:34:29.272661'}, 'success': True}
2025-08-03 15:34:29 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:34:29 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:34:29 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:34:29 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:34:29 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:34:29 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:34:29 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:34:58 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:35:19 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:36:22 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:36:22 - 2fa_service - WARNING - Generated new TOTP encryption key: X6jau1R_wtJVwKCoXFiTBKeY1jikDLgAJiZjwGucgO0=
2025-08-03 15:36:22 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:36:25 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:36:25 - 2fa_service - WARNING - Generated new TOTP encryption key: QlEdrq_S3Z8yrEY5YrtzwaaBiNQveCmuMb3LbiEEx0A=
2025-08-03 15:36:25 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:36:44 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:36:44 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:36:44 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:36:44 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVmuPqsgW_SsTkzlf5tANBah00rnXF4gKKKAIX0xZlFC85SHK5Pz3KTx9-pzcTCb3wyR2tHftvfZeqyq16s_BqcBlCjOc1YO3umzw18GpqmGNTzqutyTJ69N8FlW7vLnjyOSudQiS8V6V2VsFlvhmKIO3Pwc-rGH_neUZwoO3gaojw-M3asiWR87dJN0RZYOvgxL7pMSoPjUloVlhXRdvr69JjmAS5lX9JrIs-wqbOsxL0mFa0JTJR15FEyFCeZPV1UuQ50GCX1CevuaveV8AXm_gWfmfEldFnlX4VD8K_I5yH39BCaHsTsR_51iRl8Ys4HiBHzOFEN1uwijmgxQ1CAN2mIrkNkZhzQbFNWxeYFH8aNZUuER5VlOgvu-XX6m89wP-zk9-BzL9fNKhkZ4QDX1S-lKhnE5F_zLi_4FTSJI_ijK_kIQu9aK__7PWX54Cv_-tvN--DvC9GLxxI1EAYMyOxRfKkv6mC_30_f5QBXFVneo8xhkV9gGB9ALZicUvh3o3N6a34oaRrkRGKHBOVXXO2kgA3GYXN54y5RVs_Q3ejXczLh1m29FxvVSA0QkKd-VXx9TImNEB8ePtmrXVFe4s295y02ghtDfTulZaGY_QKFAFcsUEjsF0BuPOn3vC3LlllWXH12G48ZngfpxsHmGntTXZ77OOE6ccPFT2YlaiCZwF7nria9bEVC15t1SOQCMnAS9G59nqHMzvewE7s3wxcQKWG40GT0noPlUnWH8qw0nSzzihOvCiNP46IP6nLvixCs8KIgZZWftO5XSiVmpaF95MHaqpGeu21mq22uqKF2nODrj2NNajMNK7oHNtjXOBJrrdonUjlfNsOdWVBdnMViw-TnrM9YHbkcvuhbYpEK_1odxfmi3q8tsGyJELJO6cmd0m9W9n4FeeJUZnwPYQIc56CPWuzfedYQetFi06fa4Jm-OEhZkH9LlfasCvXf4Qef2IKcvBoyu4IGQ1xW-RE3KbVG7RUms8IN08cE_8o56gVL_Rnsk52zW0f62SlrjHQ6xGOdHsCad1saDNad9u1xkzjlIvgB_teNjp2dnRKeX9Q5t7te4kwFD03J9PM7SUc98SQ7Sc_uRyPHTecUX5iKzniOym72tReTOKQai80YL2WLR6FHC67YqGHd-NuSpSvpw267fhULtOUvVzUU7JOfXo7PLDt8OJB7gQOu3n_J7T_3-_-OnhAR2v8JwdMTLz4Tt7iiOzRxCGCAS9_pp1WNV-F-ZWLGc2J1fmUj5CNrRsfsr3WOdUorj7PrcyKT-r81MYyTPE7QDl2WoHv4PP-cTw7DzzIqgcGlX5mO_JcVq4vMmhdP8_e37PtYeYnYGUnZUDh8DhQTk0Pq33Z8-9v7mWNKWdhDPQNdeRSpvXvQN7tyzCXXfRSnb34tYC0sJZyJGd7uvDYZWc9-odKdziwHqVlsq8LSc2jhcS6mKwcbT-PGXw6CXnhHJzuORT0-dx9yiPpMKHn2se1dE9rrheD-jILI3d9W7PapHK6tHkTvESvKTnM1rwur17aFFAz4RMr5jFqT4OM2XOwm0t7EpVmal84y-Zx33FKDdz-YgytWxxKm6CjlmDfYY2UsCSQqPTqmZ0II5-atoVEcZzaI9GM0Fwg2U6honXDrtbrKzQfcjYSTuXV6fWWI0v1mJubuMgAsxsWqyZpeQI1-U23ETO1ki0ERD39MJYMkW8dqeI9TiFWXuLquOSciZ4p5Ekji_O3d_F0JVzMxXHxOMvq6g4Dq1WXibAPxn760UMrmyhjgSm0URRqXTdc6OiK5eTUIsYPT2wiWm39-HexlgR2jK3J_H-ysdrc-MeLG-34XfZrLrq90toC1tDVe7McKpeH3OzDZNmxzjjR3ruCvNxL3WSWGJNzjxRS1aqSKPGxoTebk87-cUh27b98CtYkOppkL33vPb3P8ku-cuH2fz2fxc8Peq374ZFGz5vyKe10q5TDEvqK9_tpc9-Wkx9CmEV0uWNaqbtOFxNAmOXzK9OvDSNoqXpsPHp8r_mxT1iV_zLiE_eFBPRG_eCS1g24_8GfezX9dON8r4Q7P94Of1qwIDlvg4uMCXJ45TBtBfsOxCtDsiNyvgR7VvQGPlpUcKwryVV9c-PH1r0C8Rvn-g_XmHJHIXr0SXippU9LK4FtfSQLhcE1U3567FJQv7vhXiFr5NZMM7RBuaxUbnOxlwx0RQsoG6s8_lxgnTM7E2cTrkinTsyfSy0G9fqJu-VNGRQf0Kbc78zHM-xw7EoDiVJ4sZAYkWRHXz7eJnQlxnN4YdDn71IAsPiy5kRRphloIQFBo9GZzQURR7z0uDbXyN1lOY.aI9X3A.T6tv8pkDdPU7F3ccYmvIg7CiQF8'}
2025-08-03 15:36:44 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:36:44 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:36:44 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06CFC390>
2025-08-03 15:36:44 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:36:44 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:36:44 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:36:44 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:36:44 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:36:44 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:36:44 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:36:44 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:36:44 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:36:44 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:36:44 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:36:44 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:36:44 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:36:44 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:36:44 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:36:44 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:36:45 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:36:45 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:36:45 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:36:45 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:36:45 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:36:45 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Request completed in 0.18s with status 200
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.00035834312438964844, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:36:45.707009'}, 'success': True}
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.7894973754882812e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:36:45.781177'}, 'success': True}
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Request completed in 0.17s with status 400
2025-08-03 15:36:45 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.002760648727416992,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:36:45.886780"
  },
  "success": false
}

2025-08-03 15:36:45 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.002760648727416992,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:36:45.886780"
  },
  "success": false
}

2025-08-03 15:36:45 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.002760648727416992,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:36:45.886780"
  },
  "success": false
}

2025-08-03 15:36:45 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:36:45 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:36:45 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 15:36:45 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010242462158203125,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:36:45.932263"
  },
  "success": false
}

2025-08-03 15:36:45 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010242462158203125,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:36:45.932263"
  },
  "success": false
}

2025-08-03 15:36:45 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010242462158203125,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:36:45.932263"
  },
  "success": false
}

2025-08-03 15:36:45 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:36:45 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:36:46 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:36:46 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:36:46 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:36:48 - managers.commands_server - DEBUG - Request completed in 2.00s with status 200
2025-08-03 15:36:48 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.8326032161712646, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:36:48.770078'}, 'success': True}
2025-08-03 15:36:48 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:36:48 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:36:48 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:36:48 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:36:48 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:36:48 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:36:48 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:36:56 - twofa_endpoints - ERROR - 2FA verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: 
2025-08-03 15:37:19 - twofa_endpoints - ERROR - 2FA verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: 
2025-08-03 15:46:06 - 2fa_service - WARNING - Generated new TOTP encryption key: 8ElEhle2g8zp1zs0jptKSBuktr9JpUooeGO0FBDSCG4=
2025-08-03 15:46:06 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:46:53 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:46:53 - 2fa_service - WARNING - Generated new TOTP encryption key: 3ztHuLBYI0IX0P2Qn5s6jkR2YH8DcSK3t9QCA2TebWc=
2025-08-03 15:46:53 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:46:56 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:46:56 - 2fa_service - WARNING - Generated new TOTP encryption key: jB2FOKCQ4RcoLpH9Qlv-f78ioSPS3qWLg5zgbGwSKcQ=
2025-08-03 15:46:56 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:46:59 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:46:59 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:46:59 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:46:59 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVmuPqsgW_SsTkzlf5tANBah00rnXF4gKKKAIX0xZlFC85SHK5Pz3KTx9-pzcTCb3wyR2tHftvfZeqyq16s_BqcBlCjOc1YO3umzw18GpqmGNTzqutyTJ69N8FlW7vLnjyOSudQiS8V6V2VsFlvhmKIO3Pwc-rGH_neUZwoO3gaojw-M3asiWR87dJN0RZYOvgxL7pMSoPjUloVlhXRdvr69JjmAS5lX9JrIs-wqbOsxL0mFa0JTJR15FEyFCeZPV1UuQ50GCX1CevuaveV8AXm_gWfmfEldFnlX4VD8K_I5yH39BCaHsTsR_51iRl8Ys4HiBHzOFEN1uwijmgxQ1CAN2mIrkNkZhzQbFNWxeYFH8aNZUuER5VlOgvu-XX6m89wP-zk9-BzL9fNKhkZ4QDX1S-lKhnE5F_zLi_4FTSJI_ijK_kIQu9aK__7PWX54Cv_-tvN--DvC9GLxxI1EAYMyOxRfKkv6mC_30_f5QBXFVneo8xhkV9gGB9ALZicUvh3o3N6a34oaRrkRGKHBOVXXO2kgA3GYXN54y5RVs_Q3ejXczLh1m29FxvVSA0QkKd-VXx9TImNEB8ePtmrXVFe4s295y02ghtDfTulZaGY_QKFAFcsUEjsF0BuPOn3vC3LlllWXH12G48ZngfpxsHmGntTXZ77OOE6ccPFT2YlaiCZwF7nria9bEVC15t1SOQCMnAS9G59nqHMzvewE7s3wxcQKWG40GT0noPlUnWH8qw0nSzzihOvCiNP46IP6nLvixCs8KIgZZWftO5XSiVmpaF95MHaqpGeu21mq22uqKF2nODrj2NNajMNK7oHNtjXOBJrrdonUjlfNsOdWVBdnMViw-TnrM9YHbkcvuhbYpEK_1odxfmi3q8tsGyJELJO6cmd0m9W9n4FeeJUZnwPYQIc56CPWuzfedYQetFi06fa4Jm-OEhZkH9LlfasCvXf4Qef2IKcvBoyu4IGQ1xW-RE3KbVG7RUms8IN08cE_8o56gVL_Rnsk52zW0f62SlrjHQ6xGOdHsCad1saDNad9u1xkzjlIvgB_teNjp2dnRKeX9Q5t7te4kwFD03J9PM7SUc98SQ7Sc_uRyPHTecUX5iKzniOym72tReTOKQai80YL2WLR6FHC67YqGHd-NuSpSvpw267fhULtOUvVzUU7JOfXo7PLDt8OJB7gQOu3n_J7T_3-_-OnhAR2v8JwdMTLz4Tt7iiOzRxCGCAS9_pp1WNV-F-ZWLGc2J1fmUj5CNrRsfsr3WOdUorj7PrcyKT-r81MYyTPE7QDl2WoHv4PP-cTw7DzzIqgcGlX5mO_JcVq4vMmhdP8_e37PtYeYnYGUnZUDh8DhQTk0Pq33Z8-9v7mWNKWdhDPQNdeRSpvXvQN7tyzCXXfRSnb34tYC0sJZyJGd7uvDYZWc9-odKdziwHqVlsq8LSc2jhcS6mKwcbT-PGXw6CXnhHJzuORT0-dx9yiPpMKHn2se1dE9rrheD-jILI3d9W7PapHK6tHkTvESvKTnM1rwur17aFFAz4RMr5jFqT4OM2XOwm0t7EpVmal84y-Zx33FKDdz-YgytWxxKm6CjlmDfYY2UsCSQqPTqmZ0II5-atoVEcZzaI9GM0Fwg2U6honXDrtbrKzQfcjYSTuXV6fWWI0v1mJubuMgAsxsWqyZpeQI1-U23ETO1ki0ERD39MJYMkW8dqeI9TiFWXuLquOSciZ4p5Ekji_O3d_F0JVzMxXHxOMvq6g4Dq1WXibAPxn760UMrmyhjgSm0URRqXTdc6OiK5eTUIsYPT2wiWm39-HexlgR2jK3J_H-ysdrc-MeLG-34XfZrLrq90toC1tDVe7McKpeH3OzDZNmxzjjR3ruCvNxL3WSWGJNzjxRS1aqSKPGxoTebk87-cUh27b98CtYkOppkL33vPb3P8ku-cuH2fz2fxc8Peq374ZFGz5vyKe10q5TDEvqK9_tpc9-Wkx9CmEV0uWNaqbtOFxNAmOXzK9OvDSNoqXpsPHp8r_mxT1iV_zLiE_eFBPRG_eCS1g24_8GfezX9dON8r4Q7P94Of1qwIDlvg4uMCXJ45TBtBfsOxCtDsiNyvgR7VvQGPlpUcKwryVV9c-PH1r0C8Rvn-g_XmHJHIXr0SXippU9LK4FtfSQLhcE1U3567FJQv7vhXiFr5NZMM7RBuaxUbnOxlwx0RQsoG6s8_lxgnTM7E2cTrkinTsyfSy0G9fqJu-VNGRQf0Kbc78zHM-xw7EoDiVJ4sZAYkWRHXz7eJnQlxnN4YdDn71IAsPiy5kRRphloIQFBo9GZzQURR7z0uDbXyN1lOY.aI9aQg.zp_pd-BcGLCWgWUkAP1ygjcdyas'}
2025-08-03 15:46:59 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:46:59 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:46:59 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06D6FAC8>
2025-08-03 15:46:59 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:46:59 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:46:59 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:46:59 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:46:59 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:46:59 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:46:59 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:46:59 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:46:59 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:46:59 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:46:59 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:46:59 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:46:59 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:46:59 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:46:59 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:46:59 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:47:00 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:47:00 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:47:00 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:47:00 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVmuPqsgW_SsTkzlf5tANBah00rnXF4gKKKAIX0xZlFC85SHK5Pz3KTx9-pzcTCb3wyR2tHftvfZeqyq16s_BqcBlCjOc1YO3umzw18GpqmGNTzqutyTJ69N8FlW7vLnjyOSudQiS8V6V2VsFlvhmKIO3Pwc-rGH_neUZwoO3gaojw-M3asiWR87dJN0RZYOvgxL7pMSoPjUloVlhXRdvr69JjmAS5lX9JrIs-wqbOsxL0mFa0JTJR15FEyFCeZPV1UuQ50GCX1CevuaveV8AXm_gWfmfEldFnlX4VD8K_I5yH39BCaHsTsR_51iRl8Ys4HiBHzOFEN1uwijmgxQ1CAN2mIrkNkZhzQbFNWxeYFH8aNZUuER5VlOgvu-XX6m89wP-zk9-BzL9fNKhkZ4QDX1S-lKhnE5F_zLi_4FTSJI_ijK_kIQu9aK__7PWX54Cv_-tvN--DvC9GLxxI1EAYMyOxRfKkv6mC_30_f5QBXFVneo8xhkV9gGB9ALZicUvh3o3N6a34oaRrkRGKHBOVXXO2kgA3GYXN54y5RVs_Q3ejXczLh1m29FxvVSA0QkKd-VXx9TImNEB8ePtmrXVFe4s295y02ghtDfTulZaGY_QKFAFcsUEjsF0BuPOn3vC3LlllWXH12G48ZngfpxsHmGntTXZ77OOE6ccPFT2YlaiCZwF7nria9bEVC15t1SOQCMnAS9G59nqHMzvewE7s3wxcQKWG40GT0noPlUnWH8qw0nSzzihOvCiNP46IP6nLvixCs8KIgZZWftO5XSiVmpaF95MHaqpGeu21mq22uqKF2nODrj2NNajMNK7oHNtjXOBJrrdonUjlfNsOdWVBdnMViw-TnrM9YHbkcvuhbYpEK_1odxfmi3q8tsGyJELJO6cmd0m9W9n4FeeJUZnwPYQIc56CPWuzfedYQetFi06fa4Jm-OEhZkH9LlfasCvXf4Qef2IKcvBoyu4IGQ1xW-RE3KbVG7RUms8IN08cE_8o56gVL_Rnsk52zW0f62SlrjHQ6xGOdHsCad1saDNad9u1xkzjlIvgB_teNjp2dnRKeX9Q5t7te4kwFD03J9PM7SUc98SQ7Sc_uRyPHTecUX5iKzniOym72tReTOKQai80YL2WLR6FHC67YqGHd-NuSpSvpw267fhULtOUvVzUU7JOfXo7PLDt8OJB7gQOu3n_J7T_3-_-OnhAR2v8JwdMTLz4Tt7iiOzRxCGCAS9_pp1WNV-F-ZWLGc2J1fmUj5CNrRsfsr3WOdUorj7PrcyKT-r81MYyTPE7QDl2WoHv4PP-cTw7DzzIqgcGlX5mO_JcVq4vMmhdP8_e37PtYeYnYGUnZUDh8DhQTk0Pq33Z8-9v7mWNKWdhDPQNdeRSpvXvQN7tyzCXXfRSnb34tYC0sJZyJGd7uvDYZWc9-odKdziwHqVlsq8LSc2jhcS6mKwcbT-PGXw6CXnhHJzuORT0-dx9yiPpMKHn2se1dE9rrheD-jILI3d9W7PapHK6tHkTvESvKTnM1rwur17aFFAz4RMr5jFqT4OM2XOwm0t7EpVmal84y-Zx33FKDdz-YgytWxxKm6CjlmDfYY2UsCSQqPTqmZ0II5-atoVEcZzaI9GM0Fwg2U6honXDrtbrKzQfcjYSTuXV6fWWI0v1mJubuMgAsxsWqyZpeQI1-U23ETO1ki0ERD39MJYMkW8dqeI9TiFWXuLquOSciZ4p5Ekji_O3d_F0JVzMxXHxOMvq6g4Dq1WXibAPxn760UMrmyhjgSm0URRqXTdc6OiK5eTUIsYPT2wiWm39-HexlgR2jK3J_H-ysdrc-MeLG-34XfZrLrq90toC1tDVe7McKpeH3OzDZNmxzjjR3ruCvNxL3WSWGJNzjxRS1aqSKPGxoTebk87-cUh27b98CtYkOppkL33vPb3P8ku-cuH2fz2fxc8Peq374ZFGz5vyKe10q5TDEvqK9_tpc9-Wkx9CmEV0uWNaqbtOFxNAmOXzK9OvDSNoqXpsPHp8r_mxT1iV_zLiE_eFBPRG_eCS1g24_8GfezX9dON8r4Q7P94Of1qwIDlvg4uMCXJ45TBtBfsOxCtDsiNyvgR7VvQGPlpUcKwryVV9c-PH1r0C8Rvn-g_XmHJHIXr0SXippU9LK4FtfSQLhcE1U3567FJQv7vhXiFr5NZMM7RBuaxUbnOxlwx0RQsoG6s8_lxgnTM7E2cTrkinTsyfSy0G9fqJu-VNGRQf0Kbc78zHM-xw7EoDiVJ4sZAYkWRHXz7eJnQlxnN4YdDn71IAsPiy5kRRphloIQFBo9GZzQURR7z0uDbXyN1lOY.aI9aQw.ijqiuThSotAay3cQFblKRYdr650'}
2025-08-03 15:47:00 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:47:00 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:47:00 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06D6F408>
2025-08-03 15:47:00 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:00 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:00 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:47:00 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:00 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:47:00 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:47:00 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:47:00 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:47:00 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:47:00 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:47:00 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:47:00 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:47:00 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:47:00 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:47:00 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:47:00 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:47:00 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:00 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:47:00 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:47:00 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:47:00 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:47:00 - managers.commands_server - DEBUG - Request completed in 0.20s with status 200
2025-08-03 15:47:00 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.00026798248291015625, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:47:00.856631'}, 'success': True}
2025-08-03 15:47:00 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:47:00 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:47:00 - managers.commands_server - DEBUG - Request completed in 0.17s with status 400
2025-08-03 15:47:00 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0036063194274902344,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:47:01.033590"
  },
  "success": false
}

2025-08-03 15:47:00 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0036063194274902344,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:47:01.033590"
  },
  "success": false
}

2025-08-03 15:47:00 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0036063194274902344,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:47:01.033590"
  },
  "success": false
}

2025-08-03 15:47:00 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:47:00 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:47:02 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:02 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:47:02 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:47:04 - managers.commands_server - DEBUG - Request completed in 2.61s with status 200
2025-08-03 15:47:04 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 2.437669515609741, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:47:04.970280'}, 'success': True}
2025-08-03 15:47:04 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:47:04 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:47:04 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:47:05 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:47:05 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:47:05 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:47:05 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:47:13 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:47:13 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:47:13 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:47:13 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuo8gS_ZWW18W9ZAK2KamlBhsMtsHGzGwsJjOYycxQqn_v5NZwS09v8RZvg0RE5Ik4J0N5vq3uVVjnbhEW7eprW3fhl1XXhPXq67eV6_th09zb8hkWq6-ryYX0m4szKiGs5cHBlbWA98OpWgt0XPbdji5cgmZAtL5vZH_t3D2fZGR9onDMXAtSRLEHFasPiiqEG8nTTCzhqYTErtawVh-TQu89ElyLjD2dYfKirT2ZHi5DoOAcU52Il2nW7cvGJihfyrx7WVy7PnnGa7rOD7eUvLNWycchi0k-2e40PkgZABl3F9knxvNV5iaqvCIcLCglFcncSPHWcP1tN-LSWWLvjKfgYLNZfVmFY5XUYXN3kRZgQ5EQbreQ_ownSAeCordfVknwW5dwOsbewU8uyVHVZxHIidiIeVs5O3Et5renrEmDpImDfHBSyVSgrbFPOY1TeY5mW5OADSXKnrnBTkXgaHwuH7jkvDviocUsmCcDKMlDeUNtKp-QllAZCLfBn8v-DPnUhjTwitt8zoPeg0HjqFTqQXyBiMNigRBHaa_PFy0apJSb5b1Eni0GdwsHyvuglmDQ2oSROsuIOQ5cyyZtGOPSIRh8MwbnnB98QeocSPcOHLPAkjM_l3vUM_MKpUP9WzEZEtsynmJaJpLGAGl-ktIe9Z2V-bIDiHoFg1Qh3FkuPFNGlPVJ2jutbGbwcpDLYM8WvsCXgUrFvsB-crGM2bGOiA-FOyaFn5e-KpK3QBgJkjflUA9ukNMIyJpNXbTneNmLFOILpN1yDUZrm1mzzIU4ZV7uoNn5KdBixoEgds3h9_yOufyPjyA3Jtd0KsdUkktxmwJTRzg8bsE49mG06K-5eJx6lrwPLUf0DvzoaA7pcO1O5ejbguXlNMLVl9rZPcSVts9iLY9HVYhrXQsk3eJ36sIjp2LP_KhL3YPRiYef831wZCubuAE_1__jzsdSmqjCg3ThHQzgQ2NCHLoAnQ92H3ff2yrNKtAnPShLtknXGiE7Bj6qagJeSnrkbZ26qpDmTI5PtVxvDeOYebo4-gfAGbjTSDlPaHymhU-O9ucnPJvSsk-FazmZlyFuJsh-a_qx7g7ikTWh8ZlzkI62dQSLHq7J4yg2yrOOS2jNpVQaEV4WCmg_U46QNWWS0oiUZp5-e05gK2IVU_n0dJ9bo6M1JS4EUucCat3KbXwmH2M20xvwMhp4gCZG6hcjnnaxLoSKzevO5IUeRRjH4r5vTMdsjtBhj1Q_aNpViAdnl2XqTEdSZ2KBMngSTHL10tsZI891BIzweX5d1DqKbIoCm1k_CLqudGxO4RXALg_82JRkOZG9gRtSz173k3gdTWjfXibpjFmUKby3GQ3ruc3h7nofG0p0NLyCbD0y1it_Yg1gHYtKNd19eetciE7pkWOBfWKvkdley6jhxHNwo1z5rjVHu8jEAuj3Q8ufqtvTDsUtrJhNail71e6Gi0Or2zuZYXVjcce7z5kGH1TR0SeFmo57OnYV7fHYhd6AXrfGL6sQPVjoWyTBX3HbVs3X9_dhGN6isoyy0K2S5s0v83e3a-P3xQaS4lG-hbmbZP97eVWXjyQLUcOPF_LeTh9d2dCtka_8sJel8MNi2nvsNjFKq0_Bz5vd1AuZ-wrXY3BihYuCyt0uQGmAUwS9xSEgSGKLVWTa9-TmSUS53_khxNc5lfRbP27xqHrF3ZtbVc3PKZd2flm0yOCWYRfEufo_I34ohDB99OI-wtqtu-0_0RL7M3_vEe9HEga_fBa5yqfNEODL6uHmSTbdCzdfBPsBhE5HSY9k_BldWqBY8mlRFFzOJk2Dsr8uCVl32RXtr4l_jvEHxF-_0Yuy8JdoE8fJmXbl-CWMT2VzVl6siNJV4rddHf6BncXEfxfi3X1ndtG29M9u-bw0tnm-HbGUhZwrX07l3mJ8OcT0W5izoMr3Jp9Bdzjb6sz83dBrzF82tPOWmwEEwNdbilrTNA2QAeMUha--f_-xOvdk2QdivQ7wB01iePjwMHIT4phLhyQWbjaev6YoIiTo1fd_AZGP9UA.aI9aUQ.TH-51rUNsawtDcvYlViZwK_pir4'}
2025-08-03 15:47:13 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:47:13 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:47:13 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06D8F060>
2025-08-03 15:47:13 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:13 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:13 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:47:13 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:13 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:47:13 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:47:13 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:47:13 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:47:13 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:47:13 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:47:13 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:47:13 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:47:13 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:47:13 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:47:13 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:47:13 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:47:14 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:14 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:47:14 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:47:14 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 15:47:14 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007941722869873047,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:47:14.494699"
  },
  "success": false
}

2025-08-03 15:47:14 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007941722869873047,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:47:14.494699"
  },
  "success": false
}

2025-08-03 15:47:14 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007941722869873047,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:47:14.494699"
  },
  "success": false
}

2025-08-03 15:47:14 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:47:14 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:47:15 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:47:15 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:47:15 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:47:17 - managers.commands_server - DEBUG - Request completed in 1.99s with status 200
2025-08-03 15:47:17 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.8040001392364502, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:47:17.366632'}, 'success': True}
2025-08-03 15:47:17 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:47:17 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:47:17 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:47:17 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:47:17 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:47:17 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:47:17 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:47:25 - twofa_endpoints - ERROR - 2FA verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: 
2025-08-03 15:47:39 - twofa_endpoints - ERROR - 2FA verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: 
2025-08-03 15:49:11 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:49:11 - 2fa_service - WARNING - Generated new TOTP encryption key: 1GPItttC4yZ7UDasu9jSjbRcxdsqMQKXwndtlmnRtb0=
2025-08-03 15:49:11 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:49:49 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:49:49 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:49:49 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:49:49 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:49:49 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:49:49 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-03 15:49:49 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.075599670410156e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:49:49.846540'}, 'success': True}
2025-08-03 15:49:49 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:49:49 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:49:51 - managers.commands_server - DEBUG - Request completed in 1.88s with status 200
2025-08-03 15:49:51 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7072553634643555, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:49:51.720031'}, 'success': True}
2025-08-03 15:49:51 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:49:51 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:49:51 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:49:51 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:49:52 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:49:52 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:49:52 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:50:11 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:50:11 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:50:11 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:50:13 - managers.commands_server - DEBUG - Request completed in 1.94s with status 200
2025-08-03 15:50:13 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7999045848846436, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:50:13.977682'}, 'success': True}
2025-08-03 15:50:13 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:50:13 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:50:13 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:50:14 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:50:14 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:50:14 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:50:14 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:52:12 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:52:12 - 2fa_service - WARNING - Generated new TOTP encryption key: aOHMLKpPwejbUiK3bZM30dVVgcavl1UKBEqibcxwKGU=
2025-08-03 15:52:12 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:52:27 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:52:27 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:52:27 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:52:27 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVVuvqkwS_StffD7uDY2gnGSSQQQFBTZy58U0Dcod5Cp8Of_9a_a5ZjIP8zAvJlR1r1prVdn19-pWR00By6jsVl-7po--rPo2alZf_15BhKK2vXVVFpWrr6sJAvYNEpxBnRh15M_0tc3Sk9M-EtVo9AJxMA2b-Fglkhxu65lCrr4j-BbVO5PfyFM1nEqWSAmua_JsfQip7U2Z6xS2e38_R-fLE8WJcKuFy53ZGsp4NKFn6JAS6ouYnm9AAGGh5hQEztTTmqirFSN93EMjbPjX8Tjsy8v8Osv8K9s-E0MOYc1wkH94Zy4cDe4qGaJ-OrpASaoSGBriz88SECV90HbSh0U-CHK7XX1ZRa86aaL2BrEX5JbeAMCSG_J3PME-UDS7-7JKwl--RJMcB0eUaIlsWLNEqonUSkVX-7zESMU1U01lVExpVI9-qjg68Mx9pqZxqs6P2TMV0gMK7c3C6KUS6ZtioR6F5MLLRORyC-bZJvXkrr_hMjWilCVUhafriOZquAAx9TDHoLzOlyIcAhC2vkGnASAWiDgqFwjppRysWTMfo5IKs3pQNheXI2DpA_UQNgoIO4-yU3-hWBAkdL2NB2JCOYYjcmLyUogjOim9D9jBB688dNUcFeqAa-ZBqfe4ficlY-K5dialVaKYHKnM2UY54LqzPms8iaXXIEx1Cs5qGTgqlmxNysHvVCcH2lGtwsO-RCexCg06Rqf9by2uPfuujPXQhO_QxGWpa2B7S4yRYHtTAdcQRjV9kKrp0ZqZvbSDRGO9pMIvbbA7z8nbhRfWlAeFj7mLU2jGnA_IGDrjL_6-s3y_7mFhT9Dxa9_RE628TqFjYRyRcEEcI_BY_JfNk_o0HNIK7N2sWXbrl9cPxckHM6-vC1ZQsBjXWrwHisiR5sFvnbL-uBKd5LtX2qLij08dBR0HznJOTuHR7qXjD36fGve1R11JVFj_0fNXpUx0GQC2DI42iYA9YQ19iO-H_GfvB89g9zpAmwCoiuewjUmpvk28DCMhn3oqi55FfxiAFRxBTM3C6mxbzgNLeqEjKdiE3yqFSJlibkaZwKI5AxdHWeaphK6fBznW5pD5L08_x93HOvI2sn_nfOyj58rk4gd0RALHXupsEQoec9XUZ4yXRyc8n6lA4e9JSbOXelDZt3s_Plgn1Whuw2ZiN4zqYZjTK_MsRmRniW34xzaqoinhSe301Krm7tDFZQcPnC6rebl5FfZ5MjdJfJ5bm33KVgZc6XU8QcqfjWtQtbf7LKz7J3EyQouxWoG7GXYtTYoWuYkhSjvT66jhUdEcsO0pvAWxedTwn2F3GcU9lTqZE-g8Fco-z-giL5ty0KsztQFdNt3MwXEYWQC0erRF3W-Dp8ZmD1ed-FCRt_HwdGs2Wu-zTt0VL9wuvjbYdI7C2HJuTCnxJE1fKepDDouLRx8C_9r4dbDLodrWhdQTN7MZgoZxZ__K9WTpoENfWciBI_fskQsEJCd0_sxqr5gPGXQm-dbfTXhFE6_j161FVR3hBwv_lkn4V9x1dfv1_X0cx7dHVT3yCNZJ-4aq4h32Xfy-rIGkvFdvUQGT_H8_XjfVPckjXPDzhbx102fVfQQbvFe-r5fl4OeK6W4xbGOcli5tKhVmcaNYIb93GplUqr-whn2I0yRBU-yOACS1oXbrepMOw2abUY8C9SgCBFPQybBDcUc86mfcv8G6bn-wXMqhquzwglvILohz_X9G_HQIYyL84t6jBjb97t-PJfZn_jZg3fckCn_uWbxV_lgz1JfVHRZJPt1KWCyGfQfCtx_JgG38EV1K4Fjye0XR9HI3aVuc_dkkvLqrvux-Mv5B4w-Iv36hl1WJlihDfNAXJvdn7Xg-Rd1kvLTlTp2grm-iP7DzmPrvRrzDd45_7Cp0gVWmtZ5zucrrdA8EqGrn6uBySI3W1jUq9mRdHBwxB3C8eMbM_atlmTVaJrQPls6QFEkwO5pmWJYld4AlaJpYffv2fXRuyTIPFMOExJ3drInoHqw324hYQzbarKPtNkAMTVMRxa6-_QOmNvot.aI9big.kMMFP-A94kJ8etc98pNfMQzHV9g'}
2025-08-03 15:52:27 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:52:27 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:52:27 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x069F22B8>
2025-08-03 15:52:27 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:52:27 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:52:27 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:52:27 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:52:27 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:52:27 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:52:27 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:52:27 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:52:27 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:52:27 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:52:27 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:52:27 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:52:27 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:52:27 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:52:27 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:52:27 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:52:28 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:52:28 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:52:28 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:52:28 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:52:28 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:52:28 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Request completed in 0.18s with status 200
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.075599670410156e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:52:28.430476'}, 'success': True}
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.1696090698242188e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:52:28.461272'}, 'success': True}
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 15:52:28 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000743865966796875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:52:28.595542"
  },
  "success": false
}

2025-08-03 15:52:28 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000743865966796875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:52:28.595542"
  },
  "success": false
}

2025-08-03 15:52:28 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.000743865966796875,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:52:28.595542"
  },
  "success": false
}

2025-08-03 15:52:28 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:52:28 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:52:28 - managers.commands_server - DEBUG - Request completed in 0.17s with status 400
2025-08-03 15:52:28 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007407665252685547,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:52:28.627550"
  },
  "success": false
}

2025-08-03 15:52:28 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007407665252685547,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:52:28.627550"
  },
  "success": false
}

2025-08-03 15:52:28 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007407665252685547,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:52:28.627550"
  },
  "success": false
}

2025-08-03 15:52:28 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:52:28 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:52:29 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:52:29 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:52:29 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:52:30 - twofa_endpoints - INFO - 2FA reset for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:52:31 - managers.commands_server - DEBUG - Request completed in 1.90s with status 200
2025-08-03 15:52:31 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.740541934967041, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:52:31.374210'}, 'success': True}
2025-08-03 15:52:31 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:52:31 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:52:31 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:52:31 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:52:31 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:52:31 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:52:31 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:52:34 - twofa_endpoints - INFO - 2FA setup started for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:00 - twofa_endpoints - INFO - 2FA setup completed successfully for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:09 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using TOTP
2025-08-03 15:53:29 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 15:53:29 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:53:29 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 15:53:29 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuo8gW_JWS1-V7IRlsSmqpsQ022GAzDxsEyWwmMxhDqf69k1vVVVdPb_EWb8nJJOJEnFCe7yuvidrSr6KqX33r2yH6uhq6qF19-77yIYy6zuvre1Stvq0mHzBvPsZqxImW500o4kfl7DiHsrP3PQOo8MZm3P41jpy0Xd-u8_lyx-reP_Lt42XPTZyOFdQ44lI5m_EYiHa0dQp8ivk4CuL79Djr7QbuWH72hMK4-Qe7A-JU4yqJO0lyVj1qwxisfDoNZPbY6qwz2YSOjTm3LZPjyzlDP485ZricH0cziJmiMlh_nzhnFnYaqwoar5yONpAyS05Z_pHfaMPfTtdGZp_5XI4Yvtmsvq6iV5O1Uef5yAt8Q5EAMACj_tQz5ANBMduvqyz87Us0iWlwhNk1EzVjFnA5Ezqh7Bt3L9BCqd5lXRolXRjlo5tLlgIcfXeX8zSX52R2dAl3gEQ5Mzc6uYC7Ol_KRy677EUsstkF82ziShYrb4imgYS0lOrwpI5wrp8XwOcOYPCgUudLGT4DEHauRuUBwBaINKoWCOElHYz5qiejlHOzfJDIi81ifuUC-RC2Egh7hzBzd2mxxHDfdkgHpJh0DEdopfil5Ed4kgYXME8XvIrQlgtYyk_EWQSVMiD-XsjGzLHNu5DXmaSzuDTfSemAeGdlvu5xJL0BYa4Q_ixXgSUjycYkHdxetgpwPcp1eNhV8MTXoUal8LT7o8U2Z9cWkR4Kcy0Kuyy8GrK3QhgZsjfnEAc3ynmCy7pDXfX763oQKKQXl_bLGMzesYpu6QtpKoLSRb3zU6inrAvw1LfG3_271vL9isPSnHzLbVxLya6VOoWWgXB4zAZpCkGy-N_oBkVrJaXr1kuISrm52OIcWuJBq0xiwQpKBuEay90s4lxVLVP3eqRqE2sKQ-f3IS7v_UVHSaWB9XEv94_mIBx_9fehcdc4hIrD0viPmb9qaaKqADBVcDRxCMwJaRhC9H-4_5j909GYnQIgGQBZciym1QnZNbGXpmX4Q8lF3jGomwYYzuL4XC-N3jTFIjCEFzzinIm5nVTyhM4XenTnGDjfwcWSljxVvu0WQYG0WXjx29OPuLtIR9FF5p8zF_no2CK--OFbPIZqL3k2MAnFXM5ZAuEV0QnlM-cIWVcmKb-jTITMmyVvw1MN-_2a4zQhc1ON0MG840RpPsX1tIHKsc49UK3JEAO50Ht-qG6vvhhS8dV98GRwDsLNFW4TDLzYtnl0p749N1v9cqDx9DkWupYPkbi2SH8IIZ2Inq53YdmSRrlRS6I9K7VK7-Z9NDIcrlAgzPZLipnCX-Pe6xQ-e2FKRlEpqr1h0iXnQanJBarUn1l9k0RexYJUL8Nbb3ouUVkPLZZyUWCcm0cSVOfwtU4Ju-729HjQHBqBhkg0SNqoAL4cpkqwc9Rz2V-Dpmyu1932cU74XiXks7DZESPF6rZhuL0exmFMO-2BmVXuURdjy7jtTSWeL6ptpeLWkMqDAfQkrxMvozdMmaDXrYN1E6EHK-37pvv2_j6O41tS10kR-U3WvcG6fPeHPn1f3v-siuu3qPSz4sv_fL1p6zgroi-IpcpCRPjxQnr99MG6i_wW7ZWf62W5_7Fiei_1uxQdZ5I8i5UmFacZZuu2G4K9OIzoOpoSOsYximC2GMAJktiuGzJ_PsnNnUhKOMAIYHRJZc8tTHssaR7p8OY3Tfer2YUO1lWPFtzS84I4N_9nxA-jECZEL24ctX47bP9Oltrnc--JdMdZFP67Z9FW-bRmNl9XsV9mxeRVfrkY9hMI_Z1kT2Tjr-pCgWrZnxVF0cu_Wdd9Gi1a3fVQ9f92_KuNTxBffqNXdQWXavDiFT51tlVqiZGC70Ztl6HjJoP90H6OTZES_92Id_-d3SfbGl78-n7tHOuiiut8Bzhfvp7rg81COVobalTu8KY8WDxK_HhxtJn9q2PoNVwSOgTLZHACx-gtRdEMw-BbwGAUha1-_PgZHS9b8kDQdIjFDLnGojhYk5sIW_tMRK6jzSaANEUREcGsfvwD0xX4OQ.aI9byQ.NuliIyZmcU1nIxSlgXX1VR-ukFA'}
2025-08-03 15:53:29 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 15:53:29 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 15:53:29 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06CD0948>
2025-08-03 15:53:29 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:29 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:29 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 15:53:29 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:29 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 15:53:29 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 15:53:29 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 15:53:29 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:53:29 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 15:53:29 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:53:29 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 15:53:29 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 15:53:29 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 15:53:29 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 15:53:29 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 15:53:29 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 15:53:30 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:30 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:53:30 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 15:53:30 - managers.commands_server - INFO - Checking commands server health
2025-08-03 15:53:30 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 15:53:30 - managers.commands_server - DEBUG - Request completed in 0.18s with status 200
2025-08-03 15:53:30 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.123283386230469e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T12:53:30.309861'}, 'success': True}
2025-08-03 15:53:30 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 15:53:30 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 15:53:30 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-03 15:53:30 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010821819305419922,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:53:30.462632"
  },
  "success": false
}

2025-08-03 15:53:30 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010821819305419922,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:53:30.462632"
  },
  "success": false
}

2025-08-03 15:53:30 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0010821819305419922,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T12:53:30.462632"
  },
  "success": false
}

2025-08-03 15:53:30 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 15:53:30 - services.base - INFO - Service operation completed: start_session
2025-08-03 15:53:31 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:31 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:53:31 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 15:53:33 - managers.commands_server - DEBUG - Request completed in 1.96s with status 200
2025-08-03 15:53:33 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.8163244724273682, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:53:33.274869'}, 'success': True}
2025-08-03 15:53:33 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 15:53:33 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 15:53:33 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 15:53:33 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 15:53:33 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 15:53:33 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 15:53:33 - services.base - INFO - Service operation completed: scan_network
2025-08-03 15:53:47 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using TOTP
2025-08-03 15:53:52 - endpoints.settings - INFO - === Starting get_wifi_name endpoint ===
2025-08-03 15:53:52 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:53:52 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/wifi-name?routerId=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:53:52 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:52 - endpoints.settings - INFO - Using router ID: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:53:52 - endpoints.settings - INFO - Using session_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:52 - endpoints.settings - INFO - Calling get_wifi_name service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:52 - services.base - INFO - Service operation completed: get_wifi_name
2025-08-03 15:53:52 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/wifi/ssid
2025-08-03 15:53:52 - managers.commands_server - DEBUG - Request completed in 0.32s with status 200
2025-08-03 15:53:52 - managers.commands_server - DEBUG - Received response: {'data': {'ssid': 'OpenWrt'}, 'error': None, 'metadata': {'executionTime': 0.14134716987609863, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:53:52.944884'}, 'success': True}
2025-08-03 15:53:52 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/wifi/ssid'
2025-08-03 15:53:52 - services.commands_server_operations.settings_execute - INFO - Retrieved SSID 'OpenWrt' for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:53:52 - services.base - INFO - Service operation completed: get_wifi_name
2025-08-03 15:53:52 - endpoints.settings - INFO - Service call completed - result: OpenWrt, error: None
2025-08-03 15:53:52 - endpoints.settings - INFO - Service call successful, returning result: {'wifi_name': 'OpenWrt', 'ssid': 'OpenWrt'}
2025-08-03 15:53:52 - endpoints.settings - INFO - === get_wifi_name endpoint completed successfully ===
2025-08-03 15:53:53 - endpoints.settings - INFO - === Starting get_wifi_name endpoint ===
2025-08-03 15:53:53 - endpoints.settings - INFO - Request method: GET
2025-08-03 15:53:53 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/wifi-name?routerId=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:53:53 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:53 - endpoints.settings - INFO - Using router ID: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:53:53 - endpoints.settings - INFO - Using session_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:53 - endpoints.settings - INFO - Calling get_wifi_name service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 15:53:53 - services.base - INFO - Service operation completed: get_wifi_name
2025-08-03 15:53:53 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/wifi/ssid
2025-08-03 15:53:53 - managers.commands_server - DEBUG - Request completed in 0.30s with status 200
2025-08-03 15:53:53 - managers.commands_server - DEBUG - Received response: {'data': {'ssid': 'OpenWrt'}, 'error': None, 'metadata': {'executionTime': 0.13883113861083984, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T12:53:53.570047'}, 'success': True}
2025-08-03 15:53:53 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/wifi/ssid'
2025-08-03 15:53:53 - services.commands_server_operations.settings_execute - INFO - Retrieved SSID 'OpenWrt' for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 15:53:53 - services.base - INFO - Service operation completed: get_wifi_name
2025-08-03 15:53:53 - endpoints.settings - INFO - Service call completed - result: OpenWrt, error: None
2025-08-03 15:53:53 - endpoints.settings - INFO - Service call successful, returning result: {'wifi_name': 'OpenWrt', 'ssid': 'OpenWrt'}
2025-08-03 15:53:53 - endpoints.settings - INFO - === get_wifi_name endpoint completed successfully ===
2025-08-03 15:55:37 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:55:37 - 2fa_service - WARNING - Generated new TOTP encryption key: nfGgDp4QWzVww94j2JfYuss84G1UmcVQYhSWyXzaTNE=
2025-08-03 15:55:37 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:55:43 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:55:43 - 2fa_service - WARNING - Generated new TOTP encryption key: eOiP7BhlVRa8401-Hh9XHDNlyvt-xAEGMYJJwF_iSl4=
2025-08-03 15:55:43 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:55:56 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:55:56 - 2fa_service - WARNING - Generated new TOTP encryption key: 1xA0fL-YKXonD6tRK_7hX6LziR66S54gNS1S66NEvow=
2025-08-03 15:55:56 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:56:05 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:56:05 - 2fa_service - WARNING - Generated new TOTP encryption key: G1auCtLYXu33kSEq27nqqoXFq3fmB8TZyl0Sq6ogIdk=
2025-08-03 15:56:05 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:56:11 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:56:11 - 2fa_service - WARNING - Generated new TOTP encryption key: WPkz4Ab5b8g8WVmQjksNxdtwvq24JQzO0wmyEA4zKsU=
2025-08-03 15:56:11 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:56:18 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:56:18 - 2fa_service - WARNING - Generated new TOTP encryption key: X67MAQ2ILGx3PDtp7ehI3VRRSvr_Dm74IAk1h8E8irQ=
2025-08-03 15:56:18 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:56:29 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:56:29 - 2fa_service - WARNING - Generated new TOTP encryption key: XHqKCRCKqLI_br8D7ohBr4XvmhYRsJfQvwPQyUpAmAw=
2025-08-03 15:56:29 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 15:58:02 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 15:58:02 - 2fa_service - WARNING - Generated new TOTP encryption key: iXJJZdTP2LwzR5_7Hi1NRkb8gAJSciltkRVsBbCO3qM=
2025-08-03 15:58:02 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:00:05 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:00:05 - 2fa_service - WARNING - Generated new TOTP encryption key: ZfCv6cJBdLSfxBkFY36498Yf8c0EX3O8qATXA8Gn6zQ=
2025-08-03 16:00:05 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:00:29 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:00:29 - 2fa_service - WARNING - Generated new TOTP encryption key: nZ_9VeRmDPHZ1jQ0esk1THTg8c3WEESQZWbsenMm96s=
2025-08-03 16:00:29 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:00:45 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:00:45 - 2fa_service - WARNING - Generated new TOTP encryption key: oXCI8CZmmtLX0bRbSKhPkOkTQOiFrMW7KLLvbPoYNw8=
2025-08-03 16:00:45 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:01:13 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:01:13 - 2fa_service - WARNING - Generated new TOTP encryption key: kD2rqLS4TZx8UEP7j-yRaWVz_vcD4EgPN3OD7FMLZJA=
2025-08-03 16:01:13 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:01:21 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:01:21 - 2fa_service - WARNING - Generated new TOTP encryption key: gCOBsqX-HzNh8kzQ02T_Pu-BIHi7uOF4nibHyswX5Q4=
2025-08-03 16:01:21 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:01:38 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:01:38 - 2fa_service - WARNING - Generated new TOTP encryption key: Q2kkK0uzGnmiP29zMGjHXbIIN8-zGE_C1GGmjK-4734=
2025-08-03 16:01:38 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:02:15 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:02:15 - 2fa_service - WARNING - Generated new TOTP encryption key: OzwAHAALlrLbQcSpxlK5yO0zoV6iQG2tsEXX9AElVbY=
2025-08-03 16:02:15 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:02:37 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 16:02:37 - endpoints.settings - INFO - Request method: GET
2025-08-03 16:02:37 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 16:02:37 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmOo8oS_ZWW1-0qSCbT0pUuHrChDC7mYWMlCWYebCZDq__9JtV9u0tPb_EWb2URkXlOnJPhiO-raxM9SlhFVbf61j366Ouqb6PH6tv3FUQoattrV-dRtfq2miDgXyAhGNSJVcfdmNuD-NDKoD65PqELkgGOOT9EeZgV9ya4Zvdsfuc8MXbLTfVObdZe-x5RpBgrGuwc8hHqdcrQULep8rrxjwPtco5r2BcPMRTI9x5Itq5xYDRuYBtCU2jRsJ705S3fMGdTTa-MWazfr1xH7CvFOj3tQG5RF4ySvDbHO0e6dCfAXey9CaZgCLpkiNrp6AIl9exi-6YTDojoG_E49Tl_ypOYIDlu9XUVPZv0EbVXiL0gOYYGgOcY6k88xT5QDL_5ukrD375Ek5wER5ReUtmwZolUU6mVyq7xdxIrlXqumsqomNKoHv1McTTgmdtczZJMnePZMxXSAwrjzYfRyyTSN8VSPR7S804mIldYMN9sUktv2gumaRClLKE6POkjmuvhDMTMAzwZVPp8LsMhAGHrG0wWAGKBSKJqgZCeyt6aL2Y8KtlhVvcKfXYFAlY-UPfhQwFh51F25i8llgQJXY_G5hPKMRyRk5DnUhzRSel9wA8-eBahqxaoVAfMWQSV1mP-TkrH1HPtXMrqVDEFUplzWtlj3lmbLzsSS29AmGkUnNUqcFQs2ZqUvd-pTgEuR7UO99sKncQ6NJgEnbZ_tLj27Lsy1sMQvsMQ54XXwPZWGCPF9mYHzHEY1SwmVdNjLmb-vOwlBuslld3yDHbnOUW71IU1FUHp49rFKTQTwQdkAp3xd_2-s3w_b2FpT9DxG9_R0kulT6FjYRyRcEGSIBAv_gNo-oqyD03loM7BcaRD3PRGJsoeaKoFKyh5jGstZ_ehqJ41NyyRpYwqhSjPkUirFItw0VEySeB8nMvg0e6l46_6PjRuG4_SSVRa__Hmz1qZmCoAfBUcbRIBe8Ia-hDfD3cfbz94Br_VAKIDoCqewz9MSvVt4mkYKXnXMln0LObdAPzBOYiZWVqdbctFYElPdCQPNuG3SilSpliYUX7g0ZyDs6Ms_VRB1y-CAmtzyOK3px_t7mMdRRvZf3I-9tFzZXLxAzoigWNPdbYIJZOAYlokxiuiE-7P7ECppjYpWY5_bf6l1OfbPW8vxjt3zuRaNDquT9AU01JUvA9rXgm5e2ZAMczWFz5QhFANbOPOnarnrPm8zobiaFen2316lhcb9KRMp-_khk1El-0coUEWS9NDM0nmlo_msn60u-PZQicz3Ih878uHPrLMrSCbss0XWbeF4_mi2V3MTDFVP05ux1dQfsxXnppMSk9L5Xzksz7Tn1Rx3xrD-y5p48PVopkess4hLZxpPyE25ygkEf7-NpC-LVhOdSD77t5Yl6azZETcOBYN91BL1x00VOAUzDiTF3NyrZsz21rF5e5QOQl3Sku_27l3eQfCOGJ0-px33NugvLH58cgW21ynPP6AR2AHG9idxaq496FMNaKAp1uL6ibCAyvpuqb99vo6juNLXNdxEcEmbV9QXb7Cvktel_mfVrf6pXnUt7SIvvzPF6ISpsUXzFKlISb8mJDXbvpg3UbwgffKz_WynP5YMd01gW2C00PKngnOIHZtUWyGI8KNg7IYH4d9iNMkwVD8hgAkReNV0tDZMNBcTsUl6lEECLZk0mGDko6Im3vSv8CmaX-VutChuurwglsqXhDn5v-M-KEbYyI8cW_RAz76zd_xEvucvw5Y9y2Nwn_3LN4qn9YM83V1g2VaTNcKlothP4Hw7TgdsI2_ogsFjqV_VhRLLnfTtv30tHh1133V_VvxrzI-QXz5jV7VFVqiu854E8bbfUdwIwcDRofRkm5S1PWPz21TJNR_N-IVvgq7eFOjM6zzS-s5Z11eZ1twgOrlrd67AlKjtaVH5ZZsyr0jFgD_tzxjFv5qeXaNlg7tg-VlSIok2A3DsDzPkxvAEwxDrH78-Nk613TpB4plQ-LG02siugVrmouINeQjeh1xXIBYhqEiil_9-AdQfPY3.aI9d7Q.XfdMYIirmH-HNAauPAQQM3ectqQ'}
2025-08-03 16:02:37 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 16:02:37 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 16:02:37 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x07339210>
2025-08-03 16:02:37 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:02:37 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:02:37 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 16:02:37 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:02:37 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 16:02:37 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 16:02:37 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 16:02:38 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:02:38 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 16:02:38 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 16:02:38 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 16:02:38 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 16:02:38 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 16:02:38 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 16:02:38 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:02:38 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 16:02:38 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:02:38 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:02:38 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 16:02:38 - managers.commands_server - INFO - Checking commands server health
2025-08-03 16:02:38 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 16:02:38 - managers.commands_server - DEBUG - Request completed in 0.18s with status 200
2025-08-03 16:02:38 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 0.00041103363037109375, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T13:02:38.742512'}, 'success': True}
2025-08-03 16:02:38 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 16:02:38 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:02:38 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:02:38 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:02:38 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:02:38 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 16:02:38 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0029489994049072266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:02:38.900879"
  },
  "success": false
}

2025-08-03 16:02:38 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0029489994049072266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:02:38.900879"
  },
  "success": false
}

2025-08-03 16:02:38 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0029489994049072266,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:02:38.900879"
  },
  "success": false
}

2025-08-03 16:02:38 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:02:38 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:02:39 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 16:02:39 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008993148803710938,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:02:39.058185"
  },
  "success": false
}

2025-08-03 16:02:39 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008993148803710938,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:02:39.058185"
  },
  "success": false
}

2025-08-03 16:02:39 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008993148803710938,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:02:39.058185"
  },
  "success": false
}

2025-08-03 16:02:39 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:02:39 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:02:40 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:02:40 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:02:40 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 16:02:42 - managers.commands_server - DEBUG - Request completed in 2.43s with status 200
2025-08-03 16:02:42 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 2.2725942134857178, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T13:02:42.538899'}, 'success': True}
2025-08-03 16:02:42 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 16:02:42 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 16:02:42 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 16:02:42 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 16:02:42 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 16:02:42 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 16:02:42 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:02:43 - twofa_endpoints - ERROR - 2FA verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: 
2025-08-03 16:02:45 - twofa_endpoints - ERROR - 2FA verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: 
2025-08-03 16:02:47 - twofa_endpoints - INFO - 2FA reset for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:02:51 - twofa_endpoints - INFO - 2FA setup started for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:03:18 - twofa_endpoints - INFO - 2FA setup completed successfully for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:03:26 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using TOTP
2025-08-03 16:04:38 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:04:38 - 2fa_service - WARNING - Generated new TOTP encryption key: 3qn8K4ZKZBLZylKNFDUDNu_5jEOIu1iSMCXCm8Cb490=
2025-08-03 16:04:38 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:04:41 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:04:41 - 2fa_service - WARNING - Generated new TOTP encryption key: C8WYap6M2PGSV_d6RivLlZEHgnQxiIrmZYcXWcNHuqA=
2025-08-03 16:04:41 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:05:00 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 16:05:00 - endpoints.settings - INFO - Request method: GET
2025-08-03 16:05:00 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 16:05:00 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmOo8oS_ZWW100VJGCblq50GQyGMrjAzBuLIc08mMEGWv3vN6nu2116eou3eMuMyDgR50Qo4vvm2sKuCmpYD5tvQzfCr5uxh93m2_dNEEWw769DU8B6820zB4B5CXD2Qh632mzH9ODmzq03bctq9ixZG9jJOxb8A3Mad-9zoiKJfCYc_WuhWMYElXPLCgOolqrLIl46RL7reBYTKSpIt28NJ4S-Q-3MwpTeKWeUxJ6akov8MOlFtqbJ2yXPkbtjyqQZwvxQdddfnD3ZFKed1xuVGTNuanN7bQYuNtoDTeb1M-AT7411kwtryBdRP0ouULP4HHkawd_AI6WrCWR2WdJBghO73ebrBk5t1sH-GiAtiB1NAcDsGeqPPUM6kDSz_7rJ4t-6wFlJQynKzplysRaZ0DK5l6uh9Xl5K1dGoZnqUzXlpyb5uerowDO5QsvTXFuSxTNVwgMq7S2Hp5fLhG-KlSYdshOv4NBlV8w3m9Czm_6C0rQRqa6mJj4az2hpHicg5h5giLA2llMVP0IQ9_6FzkOArxAprFcIeVIFazmbyVPND4smqNTJZfGg9oEmxJ0K4sEj7dxfS6xwInA9ygMprkrxM3JS4lSJz-iojj5gHj6YytjVyqjSHihnGdb6iPIPcvbMPNcu5LzJVJMl1KWgVAHlXfTlzBOIegviXCeDRatDR0OUrVkV_EFzSnCWtCYWuDo6ik18odPoyP3h4tqL7yqID437Do2f1rwXJG-NMDIkb35AOQ5PLU8IzfTos1lMZ0GmEV9C5dc22IPnlP1aF-JUhpWPahfn2ExZHxBp4Dx_1-8763u6xZU9B47f-o6enWtjjh0L4Yi4C9I0Asmqv-mUqe1ZJQiXUtYd42SZ3GweRTIQY27FCisG4Vrr30KvYhsWjGSAwwIl7d0X0othEaK18qjoNHQ-_uWBZI-y9Ku-D45c65EGEVXWf_R8atSZrkPA1KFkExGwZ8RhjFF8zH_0_uFdGE4HERUCTfUcpjNJzbfx6XLJiLueK6Jn0e8XwBycg5iblTXYtlKGljxFEnGwcb9XK5E0xdKExYGJlgKcHHWdpzpw_TIsETeHKH9r-jHuPuJR9tD-4_ORjp6rEKsegSPiyDZpi4WruQzUHGHySgmPaD7zA6mZ-oxs1Nn0mZeh40wwT3MpxAVVEFbPXK_tLT6e9_RRs8gFh622lRJgYp6bXcPg2BWXiqD607LPVVHxpnuj6GbPqM5u108DfjGhOVl4nxq5lmskzueYTlJcH5OLzMTHBtOrluYlmXymd-54cobWnbGbTLn4eBlu-7RYyKUWTGF3vb5zgM9chTm0WMYfxbQr2uDgh1xnhDfOgr4OWZDdlZE6VxXbyLOmTbWTle9Uk5JKLSqsEbHTBOKrFXmnxHaX4V2IygFLgr0Ki-5w9NIcxphRCnprEhC7D-c7NhsC3ylNmqvu_Nbbplkz9-7Wd5nOP-nddm_jBFtTHm_XYVsvGD7qxZSaxVF8r3gm3Z0wpr3sErTd-qhpIVpY6TC0_bfX1-fz-ZI0TVLCoM36l6ipXoNxSF_X_Z_Vt-YFVkFWfkFBdRZ_-Z-j2q65ZSVECT825HWYP7JyMOjQXfl5XtaPHydmuKZBnyL3xXetQH40zJGN33S8O92fqcOi78EYIzeB0ySzxwFBUuQea6n88aB2BZlU0RhBgG8rOnvso3TAk_aeji9B2_a_qlzTRU09oAO3FrsiLu3_GfFDKIQZoY17g13Qjfu_k9X22X99IN63DMb_3ll0VT6dme3XzS2osnK-1kG1CvYTCEUn2QPJ-Mu6pkC27M-J2oI1Nuv7T61Fp7sZ6-Hfin-V8Qniy2_0uqmj1RpzCToSohSQU3SO98ZBPejI3WbRMHafx6ZMyf8uxGvwyvLJvolOQVOce885GQqWc-AQaOe3RnDZSIOYZcCKI9pKcMQSBM-Td1nYv3pmi0XrhI7h2hmCJPDtnqa3DMMQe8DgNI1vfvz4OTrXbJ0HcruN8RtDYTi8hRi1gzgWMJDC4G4XRluaJiHJbH78A8WQ9tY.aI9efA.GG1y8oAEKcGmHavbftSOKA9-9lo'}
2025-08-03 16:05:00 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 16:05:00 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 16:05:00 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06F61420>
2025-08-03 16:05:00 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:00 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:00 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 16:05:00 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:00 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 16:05:00 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 16:05:00 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 16:05:00 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:05:00 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 16:05:00 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 16:05:00 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 16:05:00 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 16:05:00 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 16:05:00 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 16:05:00 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:05:00 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 16:05:01 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:01 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 16:05:01 - managers.commands_server - INFO - Checking commands server health
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 16:05:01 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:01 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 16:05:01 - managers.commands_server - INFO - Checking commands server health
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 3.314018249511719e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T13:05:01.351260'}, 'success': True}
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.9087066650390625e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T13:05:01.436062'}, 'success': True}
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Request completed in 0.17s with status 400
2025-08-03 16:05:01 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012259483337402344,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:05:01.515045"
  },
  "success": false
}

2025-08-03 16:05:01 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012259483337402344,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:05:01.515045"
  },
  "success": false
}

2025-08-03 16:05:01 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0012259483337402344,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:05:01.515045"
  },
  "success": false
}

2025-08-03 16:05:01 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:05:01 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:05:01 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 16:05:01 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009570121765136719,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:05:01.586789"
  },
  "success": false
}

2025-08-03 16:05:01 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009570121765136719,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:05:01.586789"
  },
  "success": false
}

2025-08-03 16:05:01 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009570121765136719,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:05:01.586789"
  },
  "success": false
}

2025-08-03 16:05:01 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:05:01 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:05:02 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:02 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:05:02 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 16:05:04 - managers.commands_server - DEBUG - Request completed in 1.97s with status 200
2025-08-03 16:05:04 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.8131487369537354, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T13:05:04.375562'}, 'success': True}
2025-08-03 16:05:04 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 16:05:04 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 16:05:04 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 16:05:04 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 16:05:04 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 16:05:04 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 16:05:04 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:05:07 - twofa_endpoints - ERROR - 2FA verification failed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39: 
2025-08-03 16:05:12 - twofa_endpoints - INFO - 2FA reset for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:17 - twofa_endpoints - INFO - 2FA setup started for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:30 - twofa_endpoints - INFO - 2FA setup completed successfully for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:05:36 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using TOTP
2025-08-03 16:06:54 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 16:06:54 - endpoints.settings - INFO - Request method: GET
2025-08-03 16:06:54 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 16:06:54 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuo0oS_ZUnr8v3kslgU1JLDQZsbAZjMBg2FiSYebhmNE_17y-5NarVi170xhIRmefEORHO-Ht1b6Jn6VdR1a2-ds8--rLq2-i5-vr3ykcoatt7V-dRtfq6evmQffMJziQPjDZvnbI6XtBHbpzgAz2RKJthS24zm3fyvWuOclO_tohwwFERGqO8d_eJe2yFoQKxv7-HENihYkJLyu3riR3QaSAHfk1WlBBoab7bSuTI3-lzExenqD-DmCVBkJxV2mpK83wZwu5uHVvu4SnuIHKq5_OgKul2ekFGP4oTZCARx_4udk-cz5ncRTYl47C_QTV91Spxp49JvPNP0Tkps33BBgYBNpvVl1U0Nekzau8-9gJsaAqSBAGI3_EU-0DS7PbLKg1_-RK9jkmwR6meHs3rLAMtlVu57BpvJzNyeck1Sx1VSx61vZepjgFdi8-1LMm0OZ5dSwUuVGl3Fkc3k4FnSaW2F1NldySiG7dgnmxgpA_jDdM0iFSXUB0eLiOa60GBUuZCFgTVZVbKcAhg2HomnQWQWCCSqFog5EkVrrNuxaOaibMmqJRy4wi_8qAmhE8Vhp1L2pm3lFgSwL-5lAsTQt2HI3ISoJTSiA5q70F28OBUhDetQKU2YM4iqIwe83dyOqbuzc7lrE5ViwPqnFOqgHlnY9Z3AEtvYJgZpD9rVeBoWPL1pQpepzkF1PdaHQp8hQ5SHZp0gg78by03e_ZuR6yHJjyHJpSF18T2VhgjxfZmIuYQRy2LgWa5tG7lky7INNYL1N3SBrtznaJd6sKaiqD0cO3SK7QSzoMg8Z3xV_2es3xPj7C0X77jNZ5jpHp1eYXOFeNIxA0mCYLx4r-BLI-_CjyDQNNdRPZ5zbzOccZJsbVqwQpKFuNel7OJXU60SciEdTgeDQKRoVXIIcR1f44JnQTO57nM39u9vP9R36dGvnHJC0Dl9T96PtXqi64CyFbB3gYI2i-soQ_x_XD32fvBNVnegIgKoKa6Dvu0SM2zick0U_BhZEfJvdJnE7KiI0qZVV472z4WwVWe0B6INuG1aimRllRYUS6yaM6h4qjLPFX-zSuCAmtzQPHL008dHtZRtJH9O-dhH93bESx--I5E4NikzVdCzWQ8d-IL4xXRAc9nJpKaZbzUmcN_kyP7FjY30WI083l2A_TxCMqWcXa6cXvMAxAsBt5agzqgnREpH6JCimOwcTXpMIzF64w8gj1525FQeoK6bI95en12TG5s0esD9GuK36jBzhsV4kDOjcCHIT2zZgTUcB3WpqkT-YF0XO7WOMne8_ZRVUhyeVZrI6wu-kebTHle3nbYgG2-1bLnfaNk6dodttY51GR-uqXTaKdUEJtKxQudxGrOmftYZyUM-enCTy91nVPHkA10p6o4bVeWgBKzc9H7aJ_nYshMaRqNmUN2_qBblg3S0GGMMnbzg3649XrJhfS1OiUda510cW1xGiXpMtOue6HP8_xZR6oVbY4nS1qTwpPPJI7WgJCSdlWwBn7dWlQ3EX6w8G-Vhn8lXde0X9_fx3F8i-s6LiK_Sds3VJfvft8l78saSKtH_dY860daRP_7haj00wITfr6Q9-71ycpH_hPvle_rZTn2uWK6e-K3CU6fPxjuTMytVwp6fmFKtwBrM8bH_T7EaUDQJLslICApcrtuqGwYqE1OxiXqUQQJpqTTYYuSjoibj6R_85um_VHjQofqqsMLbil1QZyb_zPid8FfVwi_uI_o6T_77b_jJfZn_j5g3Y80Cn_uWbxV_lgz8Mvq4Zdp8bpXfrkY9h0I347TAdv4I7pQ4Fj6a0VBhlrupm2Lsz9bhFd33Vfdz4p_lPEHxF-_0Ku6QkvUt4vXiaeUp7zbb3r2MPoA4nSToq5_Rn9gFwn5341499-5XbytkeLXud66jnI5rjMeir6mn2rhxiEtWl8vUcmDphQcqYD-qLjmzP2rZZk1Wia0D5bOABIQzJamGZZlwRayBE0Tq2_fvo_OPV3mgWSYkHiw1JqIHsGa2kTE2mcjah1tNgFiaJqMSHb17R-64PQS.aI9e7g.QAsf278QCYLJHNl4nG-u1xC7xH4'}
2025-08-03 16:06:54 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 16:06:54 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 16:06:54 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06FFC780>
2025-08-03 16:06:54 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:06:54 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:06:54 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 16:06:54 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:06:54 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 16:06:54 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 16:06:54 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 16:06:54 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:06:54 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 16:06:54 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 16:06:54 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 16:06:54 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 16:06:54 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 16:06:54 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 16:06:54 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:06:54 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 16:06:55 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:06:55 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:06:55 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 16:06:55 - managers.commands_server - INFO - Checking commands server health
2025-08-03 16:06:55 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 16:06:55 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-03 16:06:55 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 6.747245788574219e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T13:06:55.274723'}, 'success': True}
2025-08-03 16:06:55 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 16:06:55 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:06:55 - managers.commands_server - DEBUG - Request completed in 0.15s with status 400
2025-08-03 16:06:55 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0017583370208740234,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:06:55.425553"
  },
  "success": false
}

2025-08-03 16:06:55 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0017583370208740234,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:06:55.425553"
  },
  "success": false
}

2025-08-03 16:06:55 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0017583370208740234,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:06:55.425553"
  },
  "success": false
}

2025-08-03 16:06:55 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:06:55 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:06:56 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:06:56 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:06:56 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 16:06:58 - managers.commands_server - DEBUG - Request completed in 1.90s with status 200
2025-08-03 16:06:58 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.725445032119751, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T13:06:58.172940'}, 'success': True}
2025-08-03 16:06:58 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 16:06:58 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 16:06:58 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 16:06:58 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 16:06:58 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 16:06:58 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 16:06:58 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:07:00 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using TOTP
2025-08-03 16:07:09 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 16:07:09 - endpoints.settings - INFO - Request method: GET
2025-08-03 16:07:09 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 16:07:09 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmOo1oS_ZWS1-VMuIBtSmqpDRiME3AyDxsEF8xgJjOY4an-_V2y6mWlWr3oRS-JS5w450Qo4q-N38RtGVRx1W9-9O0Qf98MXdxufvy1CSCMu87v63tcbX5s5gDQLwF21InzTpmWVLqD960XD9cAZ_aBfmHYOlYm4B2X_gqZeyKWfWFJFy6UqiLhGs6KCv1pRqntl6I-3RJWnp7dzOnNFAn1rjvHu3OayO1Tq24p00h0nWWPG0ymS6mxgXxWZtZnD53KWK5LNh1e8hj5ftHyaFEs92n6D6lookTFK_pcsyCu-GPAJu7bMZT1oybqvHoWHCBnM0zakjDpRXUFNXs3Q5Us-wTD9_vN9008NVkbd36AvMD3FAkIDAO7P_EM-UBQ9OH7Jos-fYnnSxoKMLtmF91cRFzJxA5pbzxW3ImldlcMeZQNcVQEL5dtFbgGc1fyNFeWZHENGXeBTLnLaXRzEfcMvlSEUyaxFyx2jivmm4Wr2U19QWUaSMhrqI7O2giX-ikBPncBjYeVtkhl9AxB1Hk6lYcAWyHSuFohxEnmzOVqJKOcnxaFk0nJOWJB5QGFi1oZRL1LWLm3UiwxPHBc0gUpJgvRCO0Ul0p-hGd58AD99MBURI5SwFJ5oppFWKkDqt-L2Zi5jnUX8zqTjSMuL3dS5lDdRV2uLI6kNyDKVSJYlCq0FSTZnGXO6xW7AFdBqSOOqeCZryOdSuGZ-aPFsRbPuSA9FObZFCatdXVkb4UwMmRvfkI1TqOSJ7hiuNTVuE9XTqSQXlxm1zZYvWsX3coLaSrC0kPc-Tky0qMH8DSwx0_-nr1-T7eotObA9hrPVrNrpc2RbSIcHnNAmkKQrH4uppH2dsXPcLHuV_7yiM7Mw7xTblBdmBUrLGmEa669IjShKExMJRSD4aIFtdNqSFuwXO-DH5WG9sd_eSBYgyj85vehkWlcQsNhaf5Hz6danqkqBHQVChYOgTUjDUOE8iP2o_dPV6cZFUAyBIrs2nRrEIpnYZOuZ_hDzS-8a1LvOqBP9onPjdLsLetShKY4QQE_WZjXySVPGHxhxPcTDZc7kGx5nacqcLwiLJA2Gy8-Pf0Ydw_pKLrY-vPmIR9d54KvfgQ2j6HYpCwmJucimjuRRHhFfEbzmZ-QN-osL0c0nyn9AjVJWYCtD-Nx25aHqtq32SIouCKPC-h3p7kEJFWDPnecd2FnPZyz6R_Mm0nedMpXRZ89c7QSeiSrePwjJxSrnRROV8kHdxsk45030oM-XvReZ_cLyI_erEfvixhceFHQCMI82jhBgMe-1Npb0Ze8IDasgWH3ITyOkOIeMa4Xy9bMy3YwGHy7f7SqvpTCVmNCIZqApbBkJktti0NcjmZ4IHe1_WbTZ2zxHXJ2mIgVeKgBWX28nQv__uiBQyaXbB6DwU95_02CByVRp5tLJuPeeX9Id6EWZHMc5HAnJvf3N56uC6FSg8dOyS44R5l-453CQZ8t8xphEVE4arAlLQ3Wvc3qdDnc1TA5ou3WwbqJ0cJK-77pfry-juP4ktR1UsRBk3UvsC5fg6FPX9f9n1W3-iUug6z4hpKqLPr2P2c1bX3LihgV_NiQfj9_VGXioEV35dd5WX_8ODG9nwZdip4J9VB6j7ajooOW902uKU7erqyDIULPOEYR9AEDOEESh21D5s8nub8TSQkHGANsV1LZ8wDTHkuaRzq8BE3T_Wa5loN11aMDt5JdEZfm_4z4YRTChGjj3uI2aIfDv5M19vXdfyLdtyyO_rmz6Kp8OTPoqNyCMitmvwrK1bBfQCg7yZ7Ixt_RtQSKZZ8nCuzINTfrui-tRae7Hqr-H8a_aXyB-PaJXtUVXKMjl8U6t6cwdgQX05uc2InQc5PBfmi_jk2REv_diNfg9cgmhxpKQX2_dq4taZdtzoBToFzfas45QiXemlpcMnhTcjZfgGCUXH05_qujd1u4TugQrp3BCRzbHShqR9M0fgA0RlHY5ufPX6PjZ-s8ELtdhN1ocovFt3BL7mNsG9AxuY33-xDuKIqICXrz82-sDPhE.aI9e_Q.cdHa-UXgGtV8A3W6bTd5Zk9MRqM'}
2025-08-03 16:07:09 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 16:07:09 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 16:07:09 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06FFCDF8>
2025-08-03 16:07:09 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:07:09 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:07:09 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 16:07:09 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:07:09 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 16:07:09 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 16:07:09 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 16:07:09 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:07:09 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 16:07:09 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 16:07:09 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 16:07:09 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 16:07:09 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 16:07:09 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 16:07:09 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:07:09 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 16:07:10 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:07:10 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:07:10 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:07:10 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 16:07:10 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008759498596191406,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:07:10.473174"
  },
  "success": false
}

2025-08-03 16:07:10 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008759498596191406,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:07:10.473174"
  },
  "success": false
}

2025-08-03 16:07:10 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0008759498596191406,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:07:10.473174"
  },
  "success": false
}

2025-08-03 16:07:10 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:07:10 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:07:11 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:07:11 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:07:11 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 16:07:13 - managers.commands_server - DEBUG - Request completed in 1.94s with status 200
2025-08-03 16:07:13 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7755191326141357, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T13:07:13.270456'}, 'success': True}
2025-08-03 16:07:13 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 16:07:13 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 16:07:13 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 16:07:13 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 16:07:13 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 16:07:13 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 16:07:13 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:10:26 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:10:26 - 2fa_service - WARNING - Generated new TOTP encryption key: VZRNv3nnAr8LTqvBisygkHWOdsBQ9vyUToTDPaNn-OU=
2025-08-03 16:10:26 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:11:54 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:11:54 - 2fa_service - WARNING - Generated new TOTP encryption key: snk-efDNHetjU0_S_hDBeiy9qox08oyuNHDp0kiVFuA=
2025-08-03 16:11:54 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:11:57 - managers.commands_server - INFO - Commands server manager initialized with URL: http://34.38.207.87:5000
2025-08-03 16:11:58 - 2fa_service - WARNING - Generated new TOTP encryption key: IxIN0tADtylfbKuOp2sr7N91_djy7Xf1q7qcy3fJe7Q=
2025-08-03 16:11:58 - 2fa_service - WARNING - Store this key securely in your environment variables!
2025-08-03 16:12:18 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 16:12:18 - endpoints.settings - INFO - Request method: GET
2025-08-03 16:12:18 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 16:12:18 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuo0oS_ZUnr8v3QjLYlNRSYxsw2IAZzLSxIMHMgxmM4an-_SWuUa1e9KI3SEREnhPnZCjj79WtidrSr6KqX33t2yH6shq6qF19_XvlQxh13a2v86hafV1NPmA-fIw1iCOtTH2MX-hNdHB66nqUC8kVAjx1sk3e7U9KrBIuNB7YALhczznJKybcpEQYFmkhZdSL9dY7MyQTSsYyMQcaTToXcAod0Q4LwtXbyp-py1FW4OX-VDVOmL3gQkD_see25s0Kylp1MkahDtvtrBbNZMdr2fQI9dHPQJLDE_PsMXIT-_vYPbFabrC6aPDaUXCAnCpAO2gtGME581N4MbtAUnMWwzeb1ZdV9GrSNupuPvIC31AkIDCCIH_HU-QDQTHbL6s0_OVLNElJIMBUTSXjOou4koqdWPaNtxdpsdRzxZRH2RRHRfAy2daAa-5yJUsyZY5n15RxF8iUO3Ojm4m4Z_KlInDpeS9hkcMumCcL19K79oFoGkjIS6gOj_oI5_p5BnzmAgYPKn0-l-EzAGHnGVQWAGyBSKJqgRBf8uE6q2Y8yhk3KweZPDss5lceUA5hK4Owdwkr85YWSwz3HZd0QYLJQjhCO8HPJT_Cozx4gHl64FWEjlLAUnkiziKotAHx92I6pq5j5WJWp7LJ4vKck_IB8c7arO5xJL0BYaYR_qxUga0gyddJPni9YhdAFZQ6POwqeOTr0KASeNz91uJYs-dISA-FeTaFnRdeA9lbIYwU2ZtxiIMblSzGFdOlVDN_qQeRQnpxeb9cg9W7dtEtfSFNRVB6qHd-Cs2E9QCe-Pb4q3_PXv5f97C0Jt_2Gs_WUrXSp9C-Ihwec0CSQBAv_mvBNdGDwjte3_WMrVniy7b78VrtqgUrKBmEe11qH7DwCp2wUq8ocuiEuM-J4IrvdOs9JlQS2O-6zBesQRR-9PfWuGtcQsdhef2PO3_V8kRVAWCqQLBwCKwJaRhCdD7cv-_-6RrMTgOQDIAiuzbTmoTiWdjLMFL8oWUS716piwEYzub4zCyvvWVJRXAVX1DAOQvzOrnkCZMvzCjnGDjn4GzLyzxVvuMVQYG02Xjxy9O3Dg_pKLrI-p3zkI-uI-GLH77NYyj2UuYrJmciUGYZILwiOqL5zDhCMbVJntlZnj3m41FLL1rBW9nrX0SeYKVt8tEuvBBBQCg27-8NTAp7jVjTnf7kMfIibTd8WZ75C3cny-A4q6yzKV-akJW38VBj8MnZh6e-N4Z98KKummbQ6ihb-THlW5bpZzrLG4GOQTrYktIx7hqb2YYS78V25rJScnBz4iV_2675GkJ2dkxTGConv8iZKrTR-aysdW4a_IM43rs1sdupmSdErHMKD6MyjLDepSO3NyNqc1TOJVF1R-Ph2N4WGBzgtyR-HmqnZwlD34qnO6FuH-fDbX2qsMkZGCPBySFuk5PEUyLFxKQG7vVmkNe18HhMgEg2a6Lfqu5OYdkjHMXLxPmMEJEYTr9EPZgoOWwwhbJusYZetw7WTYQeLPSt0vCvpO-b7uvn5ziOH3Fdx0XkN2n3Aevy0x_65HNZA2l1rz-i0k-L_728aet7WkSI8P1C3vrpzbqL_Bbtle_rZSl8r5j-lvhdgtKX8qhVlqAVt2dtsTru5o3exKjcH0KUxjGKYLYYwAmS2K4bMns-yU1OxCUcYAQwuqTS5xYmPRY3j2T48Jum-9HlQgfrqkcLbml2QZyb_zPi2yGECdGLe49avx22_46X2J_52xPpvqdR-HPPoq3yx5qhv6zufpkW063yy8Ww70DodJw-kY0_ogsFiqW_VhSgN8vZtOtQ9uclodVdD1X_s-MfbfwB8dcv9Kqu4BLNWisShuDuho9xSHa0cdEslG5S2A9t9Ad2kRD_3YhP_5Pdx9sanv06VzvXPuvSOtsBzlfUU31wWKhE66selTu8KQ82XwB_PLvGzP6rY-g1XCZ0CJabwQkco7cURTMMg28Bg1EUtvr27fvo3NJlHgiaDrE7Q66x6B6syU2ErX0mItfRZhNAmqKIiGBW3_4BrJrzog.aI9gMg.sIi3c5l1__FlkITEx-r0Zyu9-Bc'}
2025-08-03 16:12:18 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 16:12:18 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 16:12:18 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x06B622B8>
2025-08-03 16:12:18 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:18 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:18 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 16:12:18 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:18 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 16:12:18 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 16:12:18 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 16:12:18 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:12:18 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 16:12:18 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 16:12:18 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 16:12:18 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 16:12:18 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 16:12:18 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 16:12:18 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:12:18 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 16:12:19 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:19 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 16:12:19 - managers.commands_server - INFO - Checking commands server health
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 16:12:19 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:19 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 16:12:19 - managers.commands_server - INFO - Checking commands server health
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.765655517578125e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T13:12:19.615927'}, 'success': True}
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Request completed in 0.13s with status 200
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 2.0742416381835938e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T13:12:19.709561'}, 'success': True}
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-03 16:12:19 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007410049438476562,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:12:19.754979"
  },
  "success": false
}

2025-08-03 16:12:19 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007410049438476562,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:12:19.754979"
  },
  "success": false
}

2025-08-03 16:12:19 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007410049438476562,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:12:19.754979"
  },
  "success": false
}

2025-08-03 16:12:19 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:12:19 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:12:19 - managers.commands_server - DEBUG - Request completed in 0.15s with status 400
2025-08-03 16:12:19 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007951259613037109,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:12:19.853647"
  },
  "success": false
}

2025-08-03 16:12:19 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007951259613037109,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:12:19.853647"
  },
  "success": false
}

2025-08-03 16:12:19 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007951259613037109,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:12:19.853647"
  },
  "success": false
}

2025-08-03 16:12:19 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:12:19 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:12:20 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:20 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:12:20 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 16:12:23 - managers.commands_server - DEBUG - Request completed in 2.44s with status 200
2025-08-03 16:12:23 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 2.270829200744629, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T13:12:23.067406'}, 'success': True}
2025-08-03 16:12:23 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 16:12:23 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 16:12:23 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 16:12:23 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 16:12:23 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 16:12:23 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 16:12:23 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:12:26 - twofa_endpoints - INFO - 2FA reset for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:28 - twofa_endpoints - INFO - 2FA setup started for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:47 - twofa_endpoints - INFO - 2FA setup completed successfully for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:12:53 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using TOTP
2025-08-03 16:13:26 - endpoints.settings - INFO - === Starting get_router_id endpoint ===
2025-08-03 16:13:26 - endpoints.settings - INFO - Request method: GET
2025-08-03 16:13:26 - endpoints.settings - INFO - Request URL: http://localhost:5000/api/settings/router-id
2025-08-03 16:13:26 - endpoints.settings - INFO - Request headers: {'Host': 'localhost:5000', 'Connection': 'keep-alive', 'Sec-Ch-Ua-Platform': '"Windows"', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'Sec-Ch-Ua': '"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"', 'Sec-Ch-Ua-Mobile': '?0', 'Accept': '*/*', 'Origin': 'http://localhost:5173', 'Sec-Fetch-Site': 'same-site', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Dest': 'empty', 'Referer': 'http://localhost:5173/', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept-Language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7', 'Cookie': 'session=.eJytVcmuo0oS_ZUnr8v3QjLYlNRSg8E2viQ2BpthYyXzDDYzT_XvL7k1qtWLXvTGkiMzT5xzIoj4e_Wog1eByqBsV1_bVxd8WXVN8Fp9_XuFPC9omkdbZUG5-rqaEODeEMHr1JFV52gKT9ecPF6qKETZ9Cqg8Jz1B5ESgf0A2tG2GI-3BNY4VRJjKM81hDH6cFny2ApmIcnjbIK1yduZwUIInwPazU8hZInBLoWwvzDCKCmuQKGumlyJjfnIa33BG7mskmMiHC7WxbWrNadRUyYoKjwP7NWu9UPPFGWS1FamqhHaRfYHH_A6f5X1vXY8WAAmw_NIjycxmfOBPmzEw-YpVxZPkJvN6ssqGOvkFTQPhL0gNwwNKIImwO94gn2gGG77ZZX4v3wJplPsHrzknJz02yyTaiI3ctHWzk5m5eKaqQYcoCEP6sFJoakB2xAyNY1T7OFsG5C0AWTsWRrsVCYdY1-oBylRdicisPgF8-NOakmoveE0tUfBJVT5x-vgzVWvgH1qA450y-usFH7vAr9xdCZ1AbFAxEG5QMgjFG_z2YgGmEqzKkJawYpR6QBV9F8Q-K1N3VNnoVgQJLJs2gYxAQ_-4JkxqRT7wTvCzgFc74Ax9y019wq1xzlzt9Q6nL-VkyGxrXsmp1UCDZ6Ec0ZDEeedtfm8I7H0GvipRqFZLV1TxZJvExSdVjVzcD6olS8KpXfcV77OxN5R-K3Fus-OdcJ6GMIxGUJZ8urY3hJjJNjeVMI5pEFNI1I1bOZsZONZlBmsl4S7pQz31jbzZuGFNeVu4WDu-8k3Yt4BZIzM4Rd_x1z-j6Ff3CdkOrVjasm5vE6-ecM4e8ICceyBaPG_1ywPBMf4CKV4Z5TC3ivzuzr77VUnqQXLLTiMe1vunnVxX15v48Ev_TjITpV64zoH83M-24SJXfPzXooO904-_OD3qVGobepKesXtP2o-VnBiShdwpXu4kx64T1hD5-P3_u6z9r2tc4IGPNoFKrRN7mVQqnMnRl1PyKeWnvb2jbnogJNMaZ8axa2930-5e5NH70BKd8JpYLGnjH1uBJnEeXMGFBMu_VQiy8ndHGszyfyXp586HKwjb4L77zMH-2hbJ3LxA5l7AsdGdb4RMJXBWeQJjJcHR9yfqUSphjbBmSegeOXestPa3Cp5SIpPL6TB0MvrrQa3fhKSnOReGPcjY67ps9J2Ch5CiBEOJLvOJiqc70U_527fWmUERq2ezFe-3eQIjeuY9kiPtZtjjjrfVqW6GYTD0fHzOops09NFMdriMTDxJVDu-Burz-JWWXdNl-3PCjFrl_pV7a3LxVd4avZ1cT6uRe1BFA3KWeu0Dft9eKvOvfnkRvvDgMQJaiaip0f71GnwFLbJ0HERz1pW787y6-KS3M58HoUBPiNryEeq_2i4R9leYLaudTq_nz3d3A1zlckZrc6GhKelOd1isyH8jtDSTNrdzikrXKVGE2fjWo6TZhKb6-7elIaVXB_SaFoMkmsJ2q-YnaLzgKdb41V1gAcW_i0T_6-4bevm6_v7MAxvUVVFeYDqpHnzquIddW38vqyBpAyrt6BASf6_X8dWhUke4ISfE_LRTp9ZhQC98F75vl6Wi58rpn3EqIkXUvzAjuOBOApqLb2m22ZTSOuFNS4YPiYJhuK2BCApmtquazrte3qTUVHhdV4ACLZgkn7rxS0R1c-4e0N13fxguaTzqrLFC24huyDO9f8Z8dMhjOnhiRsGL_Tqtv-Oltif548e6w6TwP-5Z_FW-WPN0F9WISqSfHqUqFgM-w6EX0dJj238EV1S4Fjya0UBdru8TZoGn_4sEl7dVVe2Pxn_oPEHxF-_0Muq9JaoeiQjSdn3A5qFmDmXPsOE-LhOvLZ7BX9g5zH13414R-_8Dn9HnoKq7NzYpnI9rVMBSEg9f1SixXtqsL5dg0Ig60I09zlAg2LrM_-vhmPX3tKhnbtUhqRIgt0yDMtxHLkFHMEwxOrbt--t80iWfqBY1idCjl4TQeiu6U1ArBEX0Otgs3E9lmGogOJW3_4Bpbb5NQ.aI9gdg.6vQHxsAYJkDnrTvzY2kyEVImZrk'}
2025-08-03 16:13:26 - endpoints.settings - INFO - Remote address: 127.0.0.1
2025-08-03 16:13:26 - endpoints.settings - INFO - User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-08-03 16:13:26 - endpoints.settings - INFO - Database session obtained: <sqlalchemy.orm.session.Session object at 0x072BDD98>
2025-08-03 16:13:26 - endpoints.settings - INFO - User ID from session: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:13:26 - endpoints.settings - INFO - Calling get_router_id_setting service with user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:13:26 - services.settings_service - INFO - === Starting get_router_id_setting ===
2025-08-03 16:13:26 - services.settings_service - INFO - Input parameter - user_id: 366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:13:26 - services.settings_service - INFO - User ID type: <class 'str'>
2025-08-03 16:13:26 - services.settings_service - INFO - Querying UserSetting for routerId...
2025-08-03 16:13:26 - services.settings_service - INFO - Query: session.query(UserSetting).filter_by(user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, setting_key='routerId')
2025-08-03 16:13:26 - services.settings_service - INFO - Found UserSetting record: id=b6353585-7296-4029-a252-eea7b8d89177, setting_value={'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:13:26 - services.settings_service - INFO - Setting value type: <class 'dict'>
2025-08-03 16:13:26 - services.settings_service - INFO - Router ID found: e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f
2025-08-03 16:13:26 - services.settings_service - INFO - Router ID type: <class 'str'>
2025-08-03 16:13:26 - services.settings_service - INFO - Router ID is valid and non-empty
2025-08-03 16:13:26 - services.settings_service - INFO - === get_router_id_setting completed successfully ===
2025-08-03 16:13:26 - endpoints.settings - INFO - Service call completed - result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}, error: None
2025-08-03 16:13:26 - endpoints.settings - INFO - Service call successful, returning result: {'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f'}
2025-08-03 16:13:26 - endpoints.settings - INFO - === get_router_id endpoint completed successfully ===
2025-08-03 16:13:27 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:13:27 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 16:13:27 - managers.commands_server - INFO - Checking commands server health
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 16:13:27 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:13:27 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Performing health check...
2025-08-03 16:13:27 - managers.commands_server - INFO - Checking commands server health
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/health
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Request completed in 0.16s with status 200
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 4.887580871582031e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T13:13:27.424254'}, 'success': True}
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Request completed in 0.14s with status 200
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Received response: {'data': {'message': 'Server is healthy'}, 'error': None, 'metadata': {'executionTime': 4.1484832763671875e-05, 'routerId': None, 'sessionId': None, 'timestamp': '2025-08-03T13:13:27.517916'}, 'success': True}
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Commands server health check successful
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Making POST request to http://34.38.207.87:5000/api/session/start
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Request completed in 0.16s with status 400
2025-08-03 16:13:27 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009412765502929688,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:13:27.595666"
  },
  "success": false
}

2025-08-03 16:13:27 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009412765502929688,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:13:27.595666"
  },
  "success": false
}

2025-08-03 16:13:27 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0009412765502929688,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:13:27.595666"
  },
  "success": false
}

2025-08-03 16:13:27 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:13:27 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:13:27 - managers.commands_server - DEBUG - Request completed in 0.14s with status 400
2025-08-03 16:13:27 - managers.commands_server - ERROR - Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007784366607666016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:13:27.654035"
  },
  "success": false
}

2025-08-03 16:13:27 - managers.commands_server - ERROR - Failed to execute command via direct endpoint '/api/session/start': Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007784366607666016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:13:27.654035"
  },
  "success": false
}

2025-08-03 16:13:27 - services.commands_server_operations.session_execute - DEBUG - Commands server response - data: None, error: Commands server returned 400: {
  "data": null,
  "error": {
    "code": "SESSION_ALREADY_ACTIVE",
    "details": null,
    "message": "Session is already active"
  },
  "metadata": {
    "executionTime": 0.0007784366607666016,
    "routerId": "e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f",
    "sessionId": "366d0f94-0efb-47e0-a9e4-e77bc6553e39",
    "timestamp": "2025-08-03T13:13:27.654035"
  },
  "success": false
}

2025-08-03 16:13:27 - services.commands_server_operations.session_execute - INFO - Session already active for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with session ID 366d0f94-0efb-47e0-a9e4-e77bc6553e39 - treating as success
2025-08-03 16:13:27 - services.base - INFO - Service operation completed: start_session
2025-08-03 16:13:28 - middleware - DEBUG - Router context established: user_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39, router_id=e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, session_id=366d0f94-0efb-47e0-a9e4-e77bc6553e39
2025-08-03 16:13:28 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:13:28 - managers.commands_server - DEBUG - Making GET request to http://34.38.207.87:5000/api/network/scan
2025-08-03 16:13:30 - managers.commands_server - DEBUG - Request completed in 1.90s with status 200
2025-08-03 16:13:30 - managers.commands_server - DEBUG - Received response: {'data': [{'hostname': 'NetflixBlock_D8BBC1473A43', 'ip': '192.168.1.122', 'mac': 'd8:bb:c1:47:3a:43', 'vendor': 'Micro-Star INTL CO., LTD.'}, {'hostname': 'Tom-s-phone', 'ip': '192.168.1.141', 'mac': '36:2a:54:88:88:f5', 'vendor': 'Unknown Vendor'}], 'error': None, 'metadata': {'executionTime': 1.7398426532745361, 'routerId': 'e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f', 'sessionId': '366d0f94-0efb-47e0-a9e4-e77bc6553e39', 'timestamp': '2025-08-03T13:13:30.373057'}, 'success': True}
2025-08-03 16:13:30 - managers.commands_server - INFO - Successfully executed command via direct endpoint '/api/network/scan'
2025-08-03 16:13:30 - services.commands_server_operations.network_execute - INFO - Network scan completed successfully for router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f, found 2 devices
2025-08-03 16:13:30 - services.db_operations.network_db - INFO - Saving network scan result for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f with 2 devices
2025-08-03 16:13:30 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.122 (d8:bb:c1:47:3a:43)
2025-08-03 16:13:30 - services.db_operations.network_db - DEBUG - Updated existing device: 192.168.1.141 (36:2a:54:88:88:f5)
2025-08-03 16:13:30 - services.db_operations.network_db - INFO - Network scan save completed for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39, router e4fbea8e8f1c372c919be32613793c6c1e8313dd8a9b38bef9a9b45114ad1c1f: created 0, updated 2 devices
2025-08-03 16:13:30 - services.base - INFO - Service operation completed: scan_network
2025-08-03 16:13:41 - twofa_endpoints - INFO - 2FA verification successful for user 366d0f94-0efb-47e0-a9e4-e77bc6553e39 using TOTP
